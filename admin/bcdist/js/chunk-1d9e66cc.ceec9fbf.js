(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d9e66cc"],{"5b74":function(a,t,e){"use strict";e("7a65")},"7a65":function(a,t,e){},8958:function(a,t,e){"use strict";e.r(t);var i=function(){var a=this,t=a._self._c;return t("div",{staticClass:"about",staticStyle:{padding:"15px"}},[t("q-card",{staticClass:"my-card",attrs:{bordered:""}},[t("q-card-section",{staticClass:"main2 text-white"},[t("div",{staticClass:"row"},[t("div",{staticClass:"col-12 col-md-6"},[t("div",{staticClass:"text-h6 h_titleHead"},[a._v("Reaksi Transfusi")]),t("div",{staticClass:"text-h8"},[a._v("Manajemen Darah")])]),t("div",{staticClass:"col-12 col-md-2"}),t("div",{staticClass:"col-12 col-md-4"},[t("div",{staticClass:"row"},[t("q-input",{staticClass:"bg-white",staticStyle:{width:"90%"},attrs:{outlined:"",square:"",dense:!0},on:{keyup:function(t){return a.cari_data()}},model:{value:a.cari_value,callback:function(t){a.cari_value=t},expression:"cari_value"}}),3==a.tipe?t("q-btn",{staticClass:"main4",staticStyle:{width:"10%"},attrs:{glossy:"",dense:"",flat:"",icon:"add"},on:{click:function(t){a.mdl_add=!0}}},[t("q-tooltip",{attrs:{"content-class":"bg-green-5","content-style":"font-size: 13px"}},[a._v(" Tambah Reaksi ")])],1):a._e()],1)])])])],1),t("hr",{staticClass:"hrpagin2"}),t("div",{staticClass:"tbl_responsive"},[t("table",{attrs:{width:"100%"}},[a._m(0),t("tbody",[a._l(a.list_data,(function(e,i){return t("tr",{key:e.id+"-"+i},[t("td",{staticClass:"text-center"},[a._v(a._s(a.indexing(i+1)))]),t("td",{staticClass:"text-center"},[3===Number(a.tipe)?["draft"===e.status?t("q-btn",{attrs:{color:"primary",dense:"",icon:"send"},on:{click:function(t){return a.openKirimConfirmation(e)}}},[t("q-tooltip",{attrs:{"content-class":"bg-blue-9"}},[a._v("Kirim laporan ini ke UPD (tidak bisa diedit lagi)")])],1):"terkirim"===e.status||"unduh"===e.status||e.status?t("q-btn",{staticClass:"main1x",attrs:{icon:"document_scanner",color:"primary",disable:"unduh"!==e.status},on:{click:function(t){"unduh"===e.status&&a.openLihatDokumen(e)}}}):a._e()]:["terkirim"===e.status?t("q-btn",{staticClass:"main1x",attrs:{color:"light-green-6",icon:"medical_services"},on:{click:function(t){return a.openPemeriksaanModal(e)}}},[t("q-tooltip",{attrs:{"content-class":"bg-green-7"}},[a._v("Lanjut Pemeriksaan Pretransfusi")])],1):"unduh"===e.status?t("q-btn",{staticClass:"main1x",attrs:{color:"primary",icon:"document_scanner",loading:a.loadingPdfId===e.id,disable:a.loadingPdfId===e.id},on:{click:function(t){return a.openLihatDokumen(e)}}},[t("q-tooltip",{attrs:{"content-class":"bg-blue-8"}},[a._v("Unduh / Lihat Dokumen")])],1):t("q-btn",{staticClass:"main1x",attrs:{color:"light-green-6",icon:"medical_services"},on:{click:function(t){return a.openPemeriksaanModal(e)}}},[t("q-tooltip",{attrs:{"content-class":"bg-green-7"}},[a._v("Pemeriksaan Pretransfusi")])],1)]],2),t("td",{staticClass:"text-center"},[t("div",[a._v(" "+a._s(e.nama_pasien)+" ")]),t("div",{staticClass:"text-blue text-bold",staticStyle:{"font-size":"12px"}},[a._v(" "+a._s(e.nama_ruangan)+" ")])]),t("td",{staticClass:"text-center"},[a._v(a._s(a.UMUM.tglConvertx(e.jam_transfusi,!0)))]),t("td",[a._v(a._s(e.jenis_reaksi))]),t("td",{staticClass:"text-center"},[a._v(a._s(a.UMUM.tglConvertx(e.jam_terjadi,!0)))]),t("td",{staticClass:"text-center"},[a._v(a._s(a.UMUM.tglConvertx(e.jam_dilaporkan,!0)))]),t("td",{staticClass:"text-center"},[a._v(a._s(e.petugas_pelapor))]),t("td",{staticClass:"text-center"},[a._v(a._s(e.tindakan))]),t("td",{staticClass:"text-center q-gutter-sm"},[3===Number(a.tipe)?[t("q-btn",{attrs:{dense:"",round:"",color:"warning",icon:"edit",disable:"terkirim"===e.status},on:{click:function(t){return a.openEdit(e)}}},["terkirim"===e.status?t("q-tooltip",{attrs:{"content-class":"bg-yellow-9"}},[a._v("Tidak bisa diedit setelah dikirim")]):t("q-tooltip",{attrs:{"content-class":"bg-yellow-9"}},[a._v("Edit")])],1),t("q-btn",{attrs:{dense:"",round:"",color:"negative",icon:"delete",disable:"terkirim"===e.status},on:{click:function(t){return a.openDelete(e)}}},["terkirim"===e.status?t("q-tooltip",{attrs:{"content-class":"bg-red-8"}},[a._v("Tidak bisa dihapus setelah dikirim")]):t("q-tooltip",{attrs:{"content-class":"bg-red-8"}},[a._v("Hapus")])],1),t("q-btn",{attrs:{dense:"",round:"",color:"primary",icon:"visibility"},on:{click:function(t){return a.openLihat(e)}}},[t("q-tooltip",{attrs:{"content-class":"bg-blue-6"}},[a._v("Lihat")])],1)]:[t("q-btn",{attrs:{disable:"",dense:"",round:"",color:"warning",icon:"edit"},on:{click:function(t){return a.openEdit(e)}}},[t("q-tooltip",{attrs:{"content-class":"bg-yellow-8"}},[a._v("Edit (UPD)")])],1),t("q-btn",{attrs:{disable:"",dense:"",round:"",color:"negative",icon:"delete"},on:{click:function(t){return a.openDelete(e)}}},[t("q-tooltip",{attrs:{"content-class":"bg-red-8"}},[a._v("Hapus (UPD)")])],1),t("q-btn",{attrs:{dense:"",round:"",color:"primary",icon:"visibility",disable:"terkirim"===e.status&&!e.pemeriksaan_id},on:{click:function(t){return a.openLihat(e)}}},["terkirim"!==e.status||e.pemeriksaan_id?t("q-tooltip",{attrs:{"content-class":"bg-blue-6"}},[a._v("Lihat")]):t("q-tooltip",{attrs:{"content-class":"bg-red-8"}},[a._v(" Menunggu data pemeriksaan diinput ")])],1)]],2)])})),0===a.list_data.length?t("tr",[t("td",{staticClass:"text-center text-grey",attrs:{colspan:"8"}},[a._v(" Belum ada data. ")])]):a._e()],2)])]),t("div",{staticClass:"flex flex-center q-mt-md"},[t("q-pagination",{attrs:{max:a.page_last,color:"grey-6","max-pages":4,"direction-links":!0,"boundary-links":!0},on:{input:a.getView},model:{value:a.page_first,callback:function(t){a.page_first=t},expression:"page_first"}})],1),t("q-dialog",{attrs:{persistent:""},model:{value:a.mdl_add,callback:function(t){a.mdl_add=t},expression:"mdl_add"}},[t("q-card",{staticClass:"mdl-md"},[t("q-card-section",{staticClass:"main2 text-white"},[t("div",{staticClass:"text-h6 h_modalhead"},[a._v("Laporan Reaksi Transfusi")])]),t("form",{on:{submit:function(t){return t.preventDefault(),a.addData.apply(null,arguments)}}},[t("q-card-section",{staticClass:"q-pt-none"},[t("span",{staticClass:"h_lable"},[a._v("Pilih Permintaan (Nama Pasien)")]),t("q-select",{ref:"select",staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:!0,options:a.list_permintaan,"option-value":"id","option-label":"nama_pasien","emit-value":"","map-options":"",required:""},scopedSlots:a._u([{key:"option",fn:function(e){return[t("q-item",a._b({attrs:{clickable:""},on:{click:function(t){return a.handleOptionClick(e)}}},"q-item",e.itemProps,!1),[t("q-item-section",[t("q-item-label",{staticClass:"text-dark text-bold"},[a._v(" "+a._s(e.opt.nama_pasien)+" ")]),t("q-item-label",{staticClass:"text-blue text-bold",staticStyle:{"font-size":"12px"}},[a._v(" "+a._s(a.UMUM.tglConvert(e.opt.tanggal_lahir))+" ")])],1)],1)]}}]),model:{value:a.form.permintaan_id,callback:function(t){a.$set(a.form,"permintaan_id",t)},expression:"form.permintaan_id"}}),t("span",{staticClass:"h_lable"},[a._v("Jam Transfusi")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"datetime-local",outlined:"",square:"",dense:!0,required:""},model:{value:a.form.jam_transfusi,callback:function(t){a.$set(a.form,"jam_transfusi",t)},expression:"form.jam_transfusi"}}),t("span",{staticClass:"h_lable"},[a._v("Jenis Reaksi")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:!0,placeholder:"Contoh: Urtikaria, Demam, Sesak, dll",required:""},model:{value:a.form.jenis_reaksi,callback:function(t){a.$set(a.form,"jenis_reaksi",t)},expression:"form.jenis_reaksi"}}),t("span",{staticClass:"h_lable"},[a._v("Jam Terjadinya Reaksi")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"datetime-local",outlined:"",square:"",dense:!0,required:""},model:{value:a.form.jam_terjadi,callback:function(t){a.$set(a.form,"jam_terjadi",t)},expression:"form.jam_terjadi"}}),t("span",{staticClass:"h_lable"},[a._v("Jam Dilaporkan")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"datetime-local",outlined:"",square:"",dense:!0,required:""},model:{value:a.form.jam_dilaporkan,callback:function(t){a.$set(a.form,"jam_dilaporkan",t)},expression:"form.jam_dilaporkan"}}),t("span",{staticClass:"h_lable"},[a._v("Petugas Yang Melaporkan")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:!0,required:""},model:{value:a.form.petugas_pelapor,callback:function(t){a.$set(a.form,"petugas_pelapor",t)},expression:"form.petugas_pelapor"}}),t("span",{staticClass:"h_lable"},[a._v("Tindakan Yang Dilakukan")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"textarea",outlined:"",square:"",dense:!0,required:""},model:{value:a.form.tindakan,callback:function(t){a.$set(a.form,"tindakan",t)},expression:"form.tindakan"}})],1),t("q-card-actions",{staticClass:"bg-grey-4 mdl-footer",attrs:{align:"right"}},[t("q-btn",{attrs:{loading:a.btn_add,color:"primary",type:"submit",label:"Simpan"}}),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Batal",color:"negative"}})],1)],1)],1)],1),t("q-dialog",{attrs:{persistent:""},model:{value:a.mdl_kirim,callback:function(t){a.mdl_kirim=t},expression:"mdl_kirim"}},[t("q-card",{staticClass:"mdl-sm"},[t("q-card-section",{staticClass:"q-pt-none text-center birumudaGrad"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.confirmKirim.apply(null,arguments)}}},[t("br"),t("img",{attrs:{src:"img/alert.png",alt:"",width:"75"}}),a._v(" "),t("br"),t("span",{staticClass:"h_notifikasi"},[a._v(" APAKAH ANDA YAKIN INGIN MENGIRIM LAPORAN INI KE UPD? "),t("br")]),t("input",{staticStyle:{position:"absolute",left:"-9999px"},attrs:{type:"submit"}}),t("br"),t("br"),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Batal",size:"sm",color:"negative"},on:{click:a.cancelKirim}}),a._v("   "),t("q-btn",{attrs:{label:a.loadingKirim?"Mengirim...":"Ya, Kirim",size:"sm",color:"primary",loading:a.loadingKirim,type:"submit"}})],1)])],1)],1),t("q-dialog",{attrs:{persistent:""},model:{value:a.mdl_pemeriksaan,callback:function(t){a.mdl_pemeriksaan=t},expression:"mdl_pemeriksaan"}},[t("q-card",{staticClass:"mdl-md"},[t("q-card-section",{staticClass:"main2 text-white"},[t("div",{staticClass:"text-h6 h_modalhead"},[a._v("Pemeriksaan Pretransfusi (UPD)")])]),t("form",{on:{submit:function(t){return t.preventDefault(),a.submitPemeriksaan.apply(null,arguments)}}},[t("q-card-section",{staticClass:"q-pt-none"},[t("div",{staticClass:"col-12 col-md-12"},[t("span",{staticClass:"h_lable"},[a._v("DPJP Labpratorium")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.dpjp_lab,callback:function(t){a.$set(a.pemeriksaanForm,"dpjp_lab",t)},expression:"pemeriksaanForm.dpjp_lab"}})],1),t("div",{staticClass:"text-subtitle1 q-mt-sm text-bold"},[a._v("Pemeriksaan Pretransfusi")]),t("input",{directives:[{name:"model",rawName:"v-model",value:a.pemeriksaanForm.reaksi_id,expression:"pemeriksaanForm.reaksi_id"}],attrs:{type:"hidden"},domProps:{value:a.pemeriksaanForm.reaksi_id},on:{input:function(t){t.target.composing||a.$set(a.pemeriksaanForm,"reaksi_id",t.target.value)}}}),t("div",{staticClass:"row q-col-gutter-md"},[t("div",{staticClass:"col-12 col-md-6"},[t("span",{staticClass:"h_lable"},[a._v("Asal Darah")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.asal_darah,callback:function(t){a.$set(a.pemeriksaanForm,"asal_darah",t)},expression:"pemeriksaanForm.asal_darah"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("span",{staticClass:"h_lable"},[a._v("No. Kantong")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:"",required:""},model:{value:a.pemeriksaanForm.no_kantong,callback:function(t){a.$set(a.pemeriksaanForm,"no_kantong",t)},expression:"pemeriksaanForm.no_kantong"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("span",{staticClass:"h_lable"},[a._v("Komponen Darah")]),t("q-select",{staticClass:"bg-white margin_btn",attrs:{options:a.list_komponen,"option-value":"id","option-label":"nama_komponen","emit-value":"","map-options":"",outlined:"",dense:"",required:""},model:{value:a.pemeriksaanForm.komponen_darah,callback:function(t){a.$set(a.pemeriksaanForm,"komponen_darah",t)},expression:"pemeriksaanForm.komponen_darah"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("span",{staticClass:"h_lable"},[a._v("Golongan Darah")]),t("q-select",{staticClass:"bg-white margin_btn",attrs:{options:["A","B","O","AB"],outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.golongan_darah,callback:function(t){a.$set(a.pemeriksaanForm,"golongan_darah",t)},expression:"pemeriksaanForm.golongan_darah"}})],1),t("div",{staticClass:"col-12 col-md-12"},[t("span",{staticClass:"h_lable"},[a._v("Uji Silang / Serasi")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.uji_silang_serasi,callback:function(t){a.$set(a.pemeriksaanForm,"uji_silang_serasi",t)},expression:"pemeriksaanForm.uji_silang_serasi"}})],1)]),t("hr",{staticClass:"hrpagin2"}),t("div",{staticClass:"text-subtitle1 q-mt-sm text-bold"},[a._v("Konfirmasi Pasca Transfusi")]),t("div",{staticClass:"row q-col-gutter-md"},[t("div",{staticClass:"col-12 col-md-6"},[t("span",{staticClass:"h_lable"},[a._v("Konfirmasi Gol Pasien")]),t("q-select",{staticClass:"bg-white margin_btn",attrs:{options:["A","B","O","AB"],outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.konfirm_gol_pasien,callback:function(t){a.$set(a.pemeriksaanForm,"konfirm_gol_pasien",t)},expression:"pemeriksaanForm.konfirm_gol_pasien"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("span",{staticClass:"h_lable"},[a._v("Konfirmasi Rhesus Pasien")]),t("q-select",{staticClass:"bg-white margin_btn",attrs:{options:["+","-"],outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.konfirm_rhesus_pasien,callback:function(t){a.$set(a.pemeriksaanForm,"konfirm_rhesus_pasien",t)},expression:"pemeriksaanForm.konfirm_rhesus_pasien"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("span",{staticClass:"h_lable"},[a._v("Konfirmasi Gol Donor")]),t("q-select",{staticClass:"bg-white margin_btn",attrs:{options:["A","B","O","AB"],outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.konfirm_gol_donor,callback:function(t){a.$set(a.pemeriksaanForm,"konfirm_gol_donor",t)},expression:"pemeriksaanForm.konfirm_gol_donor"}})],1),t("div",{staticClass:"col-12 col-md-6"},[t("span",{staticClass:"h_lable"},[a._v("Konfirmasi Rhesus Donor")]),t("q-select",{staticClass:"bg-white margin_btn",attrs:{options:["+","-"],outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.konfirm_rhesus_donor,callback:function(t){a.$set(a.pemeriksaanForm,"konfirm_rhesus_donor",t)},expression:"pemeriksaanForm.konfirm_rhesus_donor"}})],1),t("div",{staticClass:"col-12"},[t("span",{staticClass:"h_lable"},[a._v("Uji Silang — Konfirmasi")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"textarea",outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.uji_silang_konfirmasi,callback:function(t){a.$set(a.pemeriksaanForm,"uji_silang_konfirmasi",t)},expression:"pemeriksaanForm.uji_silang_konfirmasi"}})],1),t("div",{staticClass:"col-12 col-md-12"},[t("span",{staticClass:"h_lable"},[a._v("Waktu Pemeriksaan")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"datetime-local",outlined:"",square:"",dense:""},model:{value:a.pemeriksaanForm.pemeriksaan_at,callback:function(t){a.$set(a.pemeriksaanForm,"pemeriksaan_at",t)},expression:"pemeriksaanForm.pemeriksaan_at"}})],1)])]),t("q-card-actions",{staticClass:"bg-grey-4 mdl-footer",attrs:{align:"right"}},[t("q-btn",{attrs:{loading:a.loadingPemeriksaan,color:"primary",type:"submit",label:"Simpan Pemeriksaan"}}),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Batal",color:"negative"},on:{click:a.cancelPemeriksaan}})],1)],1)],1)],1),t("q-dialog",{attrs:{persistent:""},model:{value:a.mdl_view,callback:function(t){a.mdl_view=t},expression:"mdl_view"}},[t("q-card",{staticClass:"mdl-md"},[t("q-card-section",{staticClass:"main2 text-white"},[t("div",{staticClass:"text-h6 h_modalhead"},[a._v("Detail Pemeriksaan Pretransfusi")])]),t("q-card-section",{staticClass:"q-pt-none"},[a.loadingView?t("div",{staticClass:"row items-center justify-center q-pa-md"},[t("q-spinner-dots")],1):t("div",[a.viewPemeriksaan?t("div",[t("div",{staticClass:"q-mb-md"},[t("div",{staticClass:"text-subtitle1 text-bold"},[a._v("Pemeriksaan Pretransfusi")]),t("div",{staticClass:"detail-table q-mt-sm"},[t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("No. Kantong")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.no_kantong||"-"))])]),t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Komponen")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.komponen_darah||"-")+" ")])]),t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Asal Darah")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.asal_darah||"-"))])]),t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Uji Silang / Serasi")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.uji_silang_serasi||"-")+" ")])]),t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Waktu Pemeriksaan")]),t("div",{staticClass:"col-8 detail-value"},[a._v(" "+a._s(a.viewPemeriksaan.pemeriksaan_at?a.UMUM.tglConvertx(a.viewPemeriksaan.pemeriksaan_at,!0):a.viewPemeriksaan.pemeriksaan_created?a.UMUM.tglConvertx(a.viewPemeriksaan.pemeriksaan_created,!0):"-")+" ")])])])]),t("div",{staticClass:"q-mb-md"},[t("div",{staticClass:"text-subtitle1 text-bold"},[a._v("Konfirmasi Pasca Transfusi")]),t("div",{staticClass:"detail-table q-mt-sm"},[t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Golongan Darah Pasien")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.konfirm_gol_pasien||"-")+" ")])]),t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Rhesus Pasien")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.konfirm_rhesus_pasien||"-"))])]),t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Golongan Darah Donor")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.konfirm_gol_donor||"-")+" ")])]),t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Rhesus Donor")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.konfirm_rhesus_donor||"-"))])]),t("div",{staticClass:"row detail-row"},[t("div",{staticClass:"col-4 detail-label"},[a._v("Uji Silang — Konfirmasi")]),t("div",{staticClass:"col-8 detail-value"},[a._v(a._s(a.viewPemeriksaan.uji_silang_konfirmasi||"-"))])])])]),t("div",[t("div",{staticClass:"text-subtitle1 text-bold"},[a._v("DPJP Laboratorium : "+a._s(a.viewPemeriksaan.dpjp_lab)+" ")])])]):t("div",{staticClass:"text-center text-grey q-pa-md"},[a._v(" Belum ada pemeriksaan. ")])])]),t("q-card-actions",{staticClass:"bg-grey-4 mdl-footer",attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Tutup",color:"negative"},on:{click:function(t){a.mdl_view=!1}}}),!a.viewPemeriksaan||1!==Number(a.tipe)&&2!==Number(a.tipe)?a._e():t("q-btn",{attrs:{label:"Edit Pemeriksaan",color:"primary"},on:{click:function(t){return a.openEditPemeriksaan(a.viewPemeriksaan)}}})],1)],1)],1),t("q-dialog",{attrs:{maximized:""},model:{value:a.mdl_pdf_view,callback:function(t){a.mdl_pdf_view=t},expression:"mdl_pdf_view"}},[t("q-card",{staticClass:"full-height"},[t("q-bar",[t("div",{staticClass:"text-h6"},[a._v("Preview Dokumen Pemeriksaan")]),t("q-space"),t("q-btn",{attrs:{flat:"",round:"",dense:"",icon:"file_download",disable:!a.pdfUrl},on:{click:a.downloadPdf}}),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",round:"",dense:"",icon:"close"},on:{click:a.closePdfModal}})],1),t("q-separator"),t("q-card-section",{staticClass:"q-pa-none",staticStyle:{height:"calc(100% - 56px)"}},[a.loadingPdf?t("div",{staticClass:"row items-center justify-center full-height"},[t("q-spinner-dots",{attrs:{size:"40px"}})],1):a.pdfUrl?t("div",{staticStyle:{height:"100%"}},[t("iframe",{staticStyle:{width:"100%",height:"100%",border:"0"},attrs:{src:a.pdfUrl}})]):t("div",{staticClass:"row items-center justify-center full-height text-grey"},[a._v(" Tidak ada dokumen untuk ditampilkan. ")])])],1)],1),t("q-dialog",{attrs:{persistent:""},model:{value:a.mdl_edit,callback:function(t){a.mdl_edit=t},expression:"mdl_edit"}},[t("q-card",{staticClass:"mdl-md"},[t("q-card-section",{staticClass:"main2 text-white"},[t("div",{staticClass:"text-h6 h_modalhead"},[a._v("Edit Reaksi Transfusi")])]),t("form",{on:{submit:function(t){return t.preventDefault(),a.updateData.apply(null,arguments)}}},[t("q-card-section",{staticClass:"q-pt-none"},[t("span",{staticClass:"h_lable"},[a._v("Pilih Permintaan (Nama Pasien)")]),t("q-select",{ref:"selectEdit",staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:!0,options:a.list_permintaan,"option-value":"id","option-label":"nama_pasien","emit-value":"","map-options":"",required:""},scopedSlots:a._u([{key:"option",fn:function(e){return[t("q-item",a._b({},"q-item",e.itemProps,!1),[t("q-item-section",[t("q-item-label",{staticClass:"text-dark text-bold"},[a._v(" "+a._s(e.opt.nama_pasien)+" ")]),t("q-item-label",{staticClass:"text-blue text-bold",staticStyle:{"font-size":"12px"}},[a._v(" "+a._s(a.UMUM.tglConvert(e.opt.tanggal_lahir))+" ")])],1)],1)]}}]),model:{value:a.form_edit.permintaan_id,callback:function(t){a.$set(a.form_edit,"permintaan_id",t)},expression:"form_edit.permintaan_id"}}),t("span",{staticClass:"h_lable"},[a._v("Jam Transfusi")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"datetime-local",outlined:"",square:"",dense:!0,required:""},model:{value:a.form_edit.jam_transfusi,callback:function(t){a.$set(a.form_edit,"jam_transfusi",t)},expression:"form_edit.jam_transfusi"}}),t("span",{staticClass:"h_lable"},[a._v("Jenis Reaksi")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:!0,required:""},model:{value:a.form_edit.jenis_reaksi,callback:function(t){a.$set(a.form_edit,"jenis_reaksi",t)},expression:"form_edit.jenis_reaksi"}}),t("span",{staticClass:"h_lable"},[a._v("Jam Terjadinya Reaksi")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"datetime-local",outlined:"",square:"",dense:!0,required:""},model:{value:a.form_edit.jam_terjadi,callback:function(t){a.$set(a.form_edit,"jam_terjadi",t)},expression:"form_edit.jam_terjadi"}}),t("span",{staticClass:"h_lable"},[a._v("Jam Dilaporkan")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"datetime-local",outlined:"",square:"",dense:!0,required:""},model:{value:a.form_edit.jam_dilaporkan,callback:function(t){a.$set(a.form_edit,"jam_dilaporkan",t)},expression:"form_edit.jam_dilaporkan"}}),t("span",{staticClass:"h_lable"},[a._v("Petugas Yang Melaporkan")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{outlined:"",square:"",dense:!0,required:""},model:{value:a.form_edit.petugas_pelapor,callback:function(t){a.$set(a.form_edit,"petugas_pelapor",t)},expression:"form_edit.petugas_pelapor"}}),t("span",{staticClass:"h_lable"},[a._v("Tindakan Yang Dilakukan")]),t("q-input",{staticClass:"bg-white margin_btn",attrs:{type:"textarea",outlined:"",square:"",dense:!0,required:""},model:{value:a.form_edit.tindakan,callback:function(t){a.$set(a.form_edit,"tindakan",t)},expression:"form_edit.tindakan"}})],1),t("q-card-actions",{staticClass:"bg-grey-4 mdl-footer",attrs:{align:"right"}},[t("q-btn",{attrs:{loading:a.btn_edit,color:"warning",type:"submit",label:"Simpan Perubahan"}}),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Batal",color:"negative"}})],1)],1)],1)],1),t("q-dialog",{attrs:{persistent:""},model:{value:a.mdl_delete,callback:function(t){a.mdl_delete=t},expression:"mdl_delete"}},[t("q-card",{staticClass:"mdl-sm"},[t("q-card-section",{staticClass:"q-pt-none text-center orageGrad"},[t("form",{on:{submit:function(t){return t.preventDefault(),a.deleteData.apply(null,arguments)}}},[t("br"),t("img",{attrs:{src:"img/alert.png",alt:"",width:"75"}}),a._v(" "),t("br"),t("span",{staticClass:"h_notifikasi"},[a._v(" APAKAH ANDA YAKIN INGIN MENGHAPUS LAPORAN REAKSI TRANSFUSI INI SECARA PERMANEN? "),t("br")]),t("input",{staticStyle:{position:"absolute",left:"-9999px"},attrs:{type:"submit"}}),t("br"),t("br"),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Batal",size:"sm",color:"primary"}}),a._v("   "),t("q-btn",{attrs:{label:a.btn_delete?"Menghapus...":"Ya, Hapus",size:"sm",color:"negative",loading:a.btn_delete,type:"submit"}})],1)])],1)],1)],1)},s=[function(){var a=this,t=a._self._c;return t("thead",{staticClass:"h_table_head main2x text-white"},[t("tr",[t("th",{staticClass:"text-center",attrs:{width:"5%"}},[a._v("No")]),t("th",{staticClass:"text-center",attrs:{width:"5%"}},[a._v("Reaksi Transfusi")]),t("th",{staticClass:"text-center",attrs:{width:"10%"}},[a._v("Nama Pasien ")]),t("th",{staticClass:"text-center",attrs:{width:"10%"}},[a._v("Waktu Transfusi")]),t("th",{attrs:{width:"10%"}},[a._v("Jenis Reaksi")]),t("th",{staticClass:"text-center",attrs:{width:"10%"}},[a._v("Waktu Terjadi Reaksi")]),t("th",{staticClass:"text-center",attrs:{width:"10%"}},[a._v("Waktu dilaporkan")]),t("th",{attrs:{width:"10%"}},[a._v("Petugas Pelapor")]),t("th",{staticClass:"text-center",attrs:{width:"15%"}},[a._v("Tindakan")]),t("th",{staticClass:"text-center",attrs:{width:"15%"}},[a._v("Aksi")])])])}],n=(e("d9e2"),e("7daa")),r=e.n(n),o={data(){return{tipe:0,user:null,UMUM:r.a,list_permintaan:[],mdl_add:!1,mdl_kirim:!1,btn_add:!1,form:{permintaan_id:null,jam_transfusi:null,jenis_reaksi:"",jam_terjadi:null,jam_dilaporkan:null,petugas_pelapor:"",tindakan:""},list_data:[],list_komponen:[],page_first:1,page_last:0,page_limit:10,jml_data:0,total_data:0,cari_value:"",mdl_edit:!1,btn_edit:!1,form_edit:{id:null,permintaan_id:null,jam_transfusi:null,jenis_reaksi:"",jam_terjadi:null,jam_dilaporkan:null,petugas_pelapor:"",tindakan:""},mdl_delete:!1,btn_delete:!1,delete_id:null,hapus_target:null,filter:{komponen_id:"",tipe_transaksi:""},modalPemeriksaanOpen:!1,mdl_pemeriksaan:!1,pemeriksaanForm:{reaksi_id:null,dpjp_lab:"",asal_darah:"",no_kantong:"",komponen_darah:"",golongan_darah:"",uji_silang_serasi:"",konfirm_gol_pasien:"",konfirm_rhesus_pasien:"",konfirm_gol_donor:"",konfirm_rhesus_donor:"",uji_silang_konfirmasi:"",pemeriksaan_at:""},loadingPemeriksaan:!1,pemeriksaanEditMode:!1,pemeriksaanEditId:null,STATUS_DRAFT:"draft",STATUS_TERKIRIM:"terkirim",loadingKirim:!1,mdl_view:!1,loadingView:!1,viewPemeriksaan:null,mdl_pdf_view:!1,loadingPdfId:null,pdfUrl:null,pdfName:null}},methods:{cancelKirim(){this.kirim_target=null,this.mdl_kirim=!1},openPemeriksaanModal(a){this.pemeriksaanForm={reaksi_id:a.id,dpjp_lab:"",asal_darah:"",no_kantong:"",komponen_darah:"",golongan_darah:"",uji_silang_serasi:"",konfirm_gol_pasien:"",konfirm_rhesus_pasien:"",konfirm_gol_donor:"",konfirm_rhesus_donor:"",uji_silang_konfirmasi:"",pemeriksaan_at:""},this.mdl_pemeriksaan=!0,this.pemeriksaanEditMode=!1,this.pemeriksaanEditId=null,this.mdl_pemeriksaan=!0},cancelPemeriksaan(){this.mdl_pemeriksaan=!1},async addPemeriksaan(){var a,t,e,i,s,n;if(!this.pemeriksaanForm.reaksi_id)return void this.$q.notify({type:"negative",message:"Target reaksi tidak ditemukan."});if(!this.pemeriksaanForm.no_kantong||!this.pemeriksaanForm.komponen_darah)return void this.$q.notify({type:"negative",message:"Mohon isi No. Kantong dan Komponen Darah."});this.loadingPemeriksaan=!0;const r=(null===(a=this.$store)||void 0===a||null===(t=a.state)||void 0===t||null===(e=t.url)||void 0===e?void 0:e.REAKSI_TRANSFUSI)||((null===(i=this.$store)||void 0===i||null===(s=i.state)||void 0===s||null===(n=s.url)||void 0===n?void 0:n.BASE)||"")+"api/v1/reaksi_transfusi/",o=r+"pemeriksaan/add";try{const a=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",authorization:"kikensbatara "+(localStorage.token||"")},body:JSON.stringify(this.pemeriksaanForm)}),t=await a.json().catch(()=>({success:!1,message:"Response parse error"}));a.ok&&(t.success||t.status)?(this.$q.notify({type:"positive",message:t.message||"Pemeriksaan berhasil disimpan."}),this.mdl_pemeriksaan=!1,this.getView()):this.$q.notify({type:"negative",message:t.message||`Gagal menyimpan pemeriksaan (${a.status})`})}catch(l){console.error("addPemeriksaan error",l),this.$q.notify({type:"negative",message:"Terjadi kesalahan saat menyimpan pemeriksaan."})}finally{this.loadingPemeriksaan=!1}},openPemeriksaan(a){const t=3===Number(this.tipe);if(t&&a.status===this.STATUS_DRAFT)return void this.openKirimConfirmation(a);const e=1===Number(this.tipe)||2===Number(this.tipe);if(e&&a.status===this.STATUS_TERKIRIM)return this.pemeriksaanForm={reaksi_id:a.id},void(this.modalPemeriksaanOpen=!0);this.pemeriksaanForm={reaksi_id:a.id},this.modalPemeriksaanOpen=!0},openKirimConfirmation(a){this.kirim_target=a,this.mdl_kirim=!0},async confirmKirim(){const a=this.kirim_target.id,t=this.$store.state.url.REAKSI_TRANSFUSI;await fetch(t+a+"/send",{method:"POST",headers:{"content-type":"application/json",authorization:"kikensbatara "+(localStorage.token||"")},body:JSON.stringify({status:"terkirim"})}),this.kirim_target.status="terkirim",this.mdl_kirim=!1,this.getView()},handleOptionClick(a){this.form.permintaan_id=a.opt.id,this.$refs.select.hidePopup()},async getData(){try{const a=this.$store.state.url.REAKSI_TRANSFUSI||(this.$store.state.url.BASE||"")+"api/v1/reaksi_transfusi/",t=this.form.ruangan_id?`${a}?ruangan_id=${this.form.ruangan_id}`:a;console.log("fetch url:",t);const e=await fetch(t,{method:"GET",headers:{"content-type":"application/json",authorization:"kikensbatara "+localStorage.token}}),i=await e.json();console.log("getData json:",i),i.status?(this.list_permintaan=i.permintaan||[],this.table_data=i.reaksi||[],this.list_permintaan.length&&!this.form.permintaan_id&&(this.form.permintaan_id=this.list_permintaan[0].id)):(this.list_permintaan=[],this.table_data=[])}catch(a){console.error("getData error:",a),this.list_permintaan=[],this.table_data=[]}},addData(){console.log("DEBUG addData payload:",this.form),this.btn_add=!0,fetch(this.$store.state.url.REAKSI_TRANSFUSI+"addData",{method:"POST",headers:{"content-type":"application/json",authorization:"kikensbatara "+localStorage.token},body:JSON.stringify(this.form)}).then(a=>a.json()).then(a=>{a.success||a.status?(this.$q.notify({type:"positive",message:a.message||"Laporan Reaksi Transfusi berhasil ditambahkan"}),this.mdl_add=!1,this.resetForm(),this.getView()):this.$q.notify({type:"negative",message:a.message||"Gagal menambah laporan reaksi transfusi"})}).catch(a=>{console.error("Error addData:",a),this.$q.notify({type:"negative",message:"Terjadi kesalahan saat menyimpan data"})}).finally(()=>{this.btn_add=!1})},resetForm(){var a,t;this.form={permintaan_id:null,jam_transfusi:"",jenis_reaksi:"",jam_terjadi:"",jam_dilaporkan:"",petugas_pelapor:"",tindakan:"",ruangan_id:(null===(a=this.form)||void 0===a?void 0:a.ruangan_id)||null,rumah_sakit_id:(null===(t=this.form)||void 0===t?void 0:t.rumah_sakit_id)||null}},getView(){const a=new URLSearchParams({page:this.page_first,limit:this.page_limit,cari_value:this.cari_value||""}).toString();fetch(this.$store.state.url.REAKSI_TRANSFUSI+"view?"+a,{method:"GET",headers:{"content-type":"application/json",authorization:"kikensbatara "+localStorage.token}}).then(a=>a.json()).then(a=>{console.log("getView response:",a),a.success?(this.list_data=a.data||[],this.total_data=a.total_data||0,this.page_last=a.total_pages||1,this.jml_data=this.list_data.length,this.page_first>this.page_last&&(this.page_first=this.page_last||1)):this.$q.notify({type:"negative",message:a.message||"Gagal memuat data reaksi transfusi"})}).catch(a=>{console.error("Error fetching reaksi transfusi:",a),this.$q.notify({type:"negative",message:"Terjadi kesalahan saat memuat data reaksi transfusi"})})},async openLihat(a){var t,e,i,s,n,r;if(!a||!a.id)return void this.$q.notify({type:"negative",message:"Data tidak valid"});this.loadingView=!0,this.viewPemeriksaan=null,this.mdl_view=!0;const o=(null===(t=this.$store)||void 0===t||null===(e=t.state)||void 0===e||null===(i=e.url)||void 0===i?void 0:i.REAKSI_TRANSFUSI)||((null===(s=this.$store)||void 0===s||null===(n=s.state)||void 0===n||null===(r=n.url)||void 0===r?void 0:r.BASE)||"")+"api/v1/reaksi_transfusi/",l=o+"pemeriksaan/view?reaksi_id="+encodeURIComponent(a.id);try{const a=await fetch(l,{method:"GET",headers:{"Content-Type":"application/json",authorization:"kikensbatara "+(localStorage.token||"")}}),t=await a.json().catch(()=>({success:!1,message:"Response parse error"}));a.ok&&(t.success||t.status)?this.viewPemeriksaan=t.data:(this.viewPemeriksaan=null,this.$q.notify({type:"negative",message:t.message||"Gagal memuat data pemeriksaan"}))}catch(d){console.error("openLihat error",d),this.$q.notify({type:"negative",message:"Terjadi kesalahan saat memuat data pemeriksaan"}),this.viewPemeriksaan=null}finally{this.loadingView=!1}},openEditPemeriksaan(a){this.mdl_view=!1,console.log("openEditPemeriksaan payload:",a,"list_komponen:",this.list_komponen);const t=(null===a||void 0===a?void 0:a.id)||(null===a||void 0===a?void 0:a.pemeriksaan_id)||null;if(!t)return void this.$q.notify({type:"negative",message:"ID pemeriksaan tidak ditemukan — tidak bisa edit."});let e=null;if(this.list_komponen&&this.list_komponen.length){const t=Number(a.komponen_darah);if(!isNaN(t)&&t>0){const a=this.list_komponen.find(a=>Number(a.id)===t);a&&(e=a.id)}if(!e){const t=this.list_komponen.find(t=>String(t.nama_komponen).trim()===String(a.komponen_darah).trim());t&&(e=t.id)}}this.pemeriksaanForm={reaksi_id:a.reaksi_id||a.reaksi_id||null,dpjp_lab:a.dpjp_lab||"",asal_darah:a.asal_darah||"",no_kantong:a.no_kantong||"",komponen_darah:null!==e?e:a.komponen_darah||"",golongan_darah:a.golongan_darah||"",uji_silang_serasi:a.uji_silang_serasi||"",konfirm_gol_pasien:a.konfirm_gol_pasien||"",konfirm_rhesus_pasien:a.konfirm_rhesus_pasien||"",konfirm_gol_donor:a.konfirm_gol_donor||"",konfirm_rhesus_donor:a.konfirm_rhesus_donor||"",uji_silang_konfirmasi:a.uji_silang_konfirmasi||"",pemeriksaan_at:this.formatDatetimeLocal(a.pemeriksaan_at||a.pemeriksaan_created||"")},this.pemeriksaanEditMode=!0,this.pemeriksaanEditId=t,this.mdl_pemeriksaan=!0},async submitPemeriksaan(){console.log("submitPemeriksaan: editMode=",this.pemeriksaanEditMode,"editId=",this.pemeriksaanEditId),this.pemeriksaanEditMode?await this.updatePemeriksaan():await this.addPemeriksaan()},async updatePemeriksaan(){if(this.pemeriksaanEditId)if(this.pemeriksaanForm.no_kantong&&this.pemeriksaanForm.komponen_darah){this.loadingPemeriksaan=!0;try{var a,t,e,i,s,n;const r=(null===(a=this.$store)||void 0===a||null===(t=a.state)||void 0===t||null===(e=t.url)||void 0===e?void 0:e.REAKSI_TRANSFUSI)||((null===(i=this.$store)||void 0===i||null===(s=i.state)||void 0===s||null===(n=s.url)||void 0===n?void 0:n.BASE)||"")+"api/v1/reaksi_transfusi/",o=r+"pemeriksaan/edit",l=Object.assign({},this.pemeriksaanForm,{id:this.pemeriksaanEditId});console.log("updatePemeriksaan payload:",l);const d=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json",authorization:"kikensbatara "+(localStorage.token||"")},body:JSON.stringify(l)}),m=await d.json().catch(()=>({success:!1,message:"Response parse error"}));d.ok&&(m.success||m.status)?(this.$q.notify({type:"positive",message:m.message||"Pemeriksaan berhasil diperbarui."}),this.mdl_pemeriksaan=!1,this.pemeriksaanEditMode=!1,this.pemeriksaanEditId=null,this.getView(),m.data&&(this.viewPemeriksaan=m.data)):(console.error("updatePemeriksaan failed:",d.status,m),this.$q.notify({type:"negative",message:m.message||`Gagal memperbarui pemeriksaan (${d.status})`}))}catch(r){console.error("updatePemeriksaan error",r),this.$q.notify({type:"negative",message:"Terjadi kesalahan saat memperbarui pemeriksaan."})}finally{this.loadingPemeriksaan=!1}}else this.$q.notify({type:"negative",message:"Mohon isi No. Kantong dan Komponen Darah."});else this.$q.notify({type:"negative",message:"ID pemeriksaan tidak ditemukan."})},getKomponen(){fetch(this.$store.state.url.KOMPONEN+"view",{method:"POST",headers:{"content-type":"application/json",authorization:"kikensbatara "+localStorage.token},body:JSON.stringify({})}).then(a=>a.json()).then(a=>{this.list_komponen=a.data||[]}).catch(a=>console.error("Error getKomponen:",a))},openLihatDokumen(a){var t,e,i,s,n,r;if(this.loadingPdfId=a.id,!a||!a.id)return void this.$q.notify({type:"negative",message:"Data tidak valid"});const o=localStorage.token||"";if(!o)return void this.$q.notify({type:"negative",message:"Token autentikasi tidak ditemukan. Silakan login ulang."});const l=(null===(t=this.$store)||void 0===t||null===(e=t.state)||void 0===e||null===(i=e.url)||void 0===i?void 0:i.REAKSI_TRANSFUSI)||((null===(s=this.$store)||void 0===s||null===(n=s.state)||void 0===n||null===(r=n.url)||void 0===r?void 0:r.BASE)||"")+"api/v1/reaksi_transfusi/",d=l+"pemeriksaan/pdf?reaksi_id="+encodeURIComponent(a.id);fetch(d,{method:"GET",headers:{Authorization:"kikensbatara "+o,"Content-Type":"application/pdf"}}).then(a=>{if(!a.ok)throw new Error("Gagal memuat PDF: "+a.status);return a.blob()}).then(a=>{const t=URL.createObjectURL(a);window.open(t,"_blank")}).catch(a=>{console.error("Error opening PDF:",a),this.$q.notify({type:"negative",message:"Gagal membuka dokumen. Periksa koneksi atau coba lagi."})}).finally(()=>{this.loadingPdfId=null})},async loadPdfInModal(a){this.loadingPdf=!0,this.pdfUrl=null,this.pdfName="reaksi_transfusi.pdf",this.mdl_pdf_view=!0;try{const t=await fetch(a,{method:"GET",headers:{Authorization:"kikensbatara "+(localStorage.token||""),"Content-Type":"application/pdf"}});if(!t.ok)throw new Error(`Gagal memuat PDF: ${t.status} - ${t.statusText}`);const e=await t.blob();this.pdfUrl=URL.createObjectURL(e)}catch(t){console.error("Error loading PDF in modal:",t),this.$q.notify({type:"negative",message:"Gagal memuat PDF. Periksa koneksi atau data."}),this.closePdfModal()}finally{this.loadingPdf=!1}},downloadPdf(){if(!this.pdfUrl)return void this.$q.notify({type:"negative",message:"Tidak ada PDF untuk didownload."});const a=document.createElement("a");a.href=this.pdfUrl,a.download=this.pdfName||"reaksi_transfusi.pdf",document.body.appendChild(a),a.click(),a.remove()},closePdfModal(){this.pdfUrl&&this.pdfUrl.startsWith("blob:")&&URL.revokeObjectURL(this.pdfUrl),this.pdfUrl=null,this.pdfName=null,this.mdl_pdf_view=!1},formatDatetimeLocal(a){if(!a)return"";const t=new Date(a);if(isNaN(t.getTime()))return"";const e=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),n=String(t.getHours()).padStart(2,"0"),r=String(t.getMinutes()).padStart(2,"0");return`${e}-${i}-${s}T${n}:${r}`},openEdit(a){this.form_edit={id:a.id,permintaan_id:a.permintaan_id,jam_transfusi:this.formatDatetimeLocal(a.jam_transfusi),jenis_reaksi:a.jenis_reaksi,jam_terjadi:this.formatDatetimeLocal(a.jam_terjadi),jam_dilaporkan:this.formatDatetimeLocal(a.jam_dilaporkan),petugas_pelapor:a.petugas_pelapor,tindakan:a.tindakan},this.mdl_edit=!0},updateData(){this.btn_edit=!0;const a=this.$store.state.url.REAKSI_TRANSFUSI||(this.$store.state.url.BASE||"")+"api/v1/reaksi_transfusi/";fetch(a+"editData",{method:"POST",headers:{"content-type":"application/json",authorization:"kikensbatara "+localStorage.token},body:JSON.stringify(this.form_edit)}).then(a=>a.json()).then(a=>{a.success||a.status?(this.$q.notify({type:"positive",message:a.message||"Data berhasil diperbarui"}),this.mdl_edit=!1,this.getView()):this.$q.notify({type:"negative",message:a.message||"Gagal memperbarui data"})}).catch(a=>{console.error("Error updateData:",a),this.$q.notify({type:"negative",message:"Terjadi kesalahan saat menyimpan perubahan"})}).finally(()=>{this.btn_edit=!1})},openDelete(a){this.delete_id=a.id,this.mdl_delete=!0},deleteData(){this.btn_delete=!0;const a=this.$store.state.url.REAKSI_TRANSFUSI||(this.$store.state.url.BASE||"")+"api/v1/reaksi_transfusi/";fetch(a+"delete",{method:"POST",headers:{"content-type":"application/json",authorization:"kikensbatara "+localStorage.token},body:JSON.stringify({id:this.delete_id})}).then(a=>a.json()).then(a=>{a.success||a.status?(this.$q.notify({type:"positive",message:a.message||"Data berhasil dihapus"}),this.mdl_delete=!1,this.getView()):this.$q.notify({type:"negative",message:a.message||"Gagal menghapus data"})}).catch(a=>{console.error("Error deleteData:",a),this.$q.notify({type:"negative",message:"Terjadi kesalahan saat menghapus data"})}).finally(()=>{this.btn_delete=!1,this.delete_id=null})},indexing(a){return(this.page_first-1)*this.page_limit+a},formatTanggal(a){if(!a)return"-";const t=new Date(a);return isNaN(t)?a:t.toLocaleString("id-ID",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},cari_data(){this.page_first=1,this.getView()},applyFilter(){this.page_first=1,this.getView()}},mounted(){try{const a=JSON.parse(localStorage.profile||"{}");a&&a.profile&&(this.tipe=Number(a.profile.stokdarah_konut),this.user=a,a.profile.ruangan_id&&(this.form.ruangan_id=Number(a.profile.ruangan_id)),a.profile.rumah_sakit_id&&(this.form.rumah_sakit_id=Number(a.profile.rumah_sakit_id)))}catch(a){console.warn("Gagal parse localStorage.profile",a)}this.getData(),this.getKomponen(),this.getView()}},l=o,d=(e("5b74"),e("2877")),m=e("fe09"),c=Object(d["a"])(l,i,s,!1,null,"7229ee5f",null);t["default"]=c.exports;c.options.components=Object.assign(Object.create(c.options.components||null),c.options.components||{},{QCard:m["h"],QCardSection:m["j"],QInput:m["w"],QBtn:m["f"],QTooltip:m["O"],QPagination:m["G"],QDialog:m["l"],QSelect:m["H"],QItem:m["x"],QItemSection:m["z"],QItemLabel:m["y"],QCardActions:m["i"],QSpinnerDots:m["K"],QBar:m["e"],QSpace:m["J"],QSeparator:m["I"],QIcon:m["u"]}),c.options.directives=Object.assign(Object.create(c.options.directives||null),c.options.directives||{},{ClosePopup:m["a"]})}}]);
//# sourceMappingURL=chunk-1d9e66cc.ceec9fbf.js.map