{"remainingRequest":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/simplephi/Documents/riswan/stock_darah/admin/src/views/1kegiatancsr/kegiatan_csr.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/src/views/1kegiatancsr/kegiatan_csr.vue","mtime":1757285456778},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/cache-loader/dist/cjs.js","mtime":1758930418112},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/babel-loader/lib/index.js","mtime":1758930419036},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/vue-cli-plugin-quasar/lib/loader.auto-import.js","mtime":1758930412679},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/cache-loader/dist/cjs.js","mtime":1758930418112},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/vue-loader/lib/index.js","mtime":1758930412640}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgppbXBvcnQgVU1VTSBmcm9tICIuLi8uLi9saWJyYXJ5L3VtdW0uanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIFVNVU06IFVNVU0sCiAgICAgIGJ0bl9hZGQ6IGZhbHNlLAogICAgICBzdGF0dXM6IDQsCiAgICAgIG1kbF9hZGQ6IGZhbHNlLAogICAgICBtZGxfZWRpdDogZmFsc2UsCiAgICAgIG1kbF9kZWxldGU6IGZhbHNlLAogICAgICBhbGVydDogZmFsc2UsCiAgICAgIHNpbXBhbjE6IGZhbHNlLAogICAgICBtZGxfbGloYXQ6IGZhbHNlLAogICAgICBzZWxlY3RlZEl0ZW06IHt9LAogICAgICBjYXJpX3ZhbHVlOiAiIiwKICAgICAgcGFnZV9maXJzdDogMSwKICAgICAgcGFnZV9sYXN0OiAxLAogICAgICBwYWdlX2xpbWl0OiA5LAogICAgICB0b3RhbDogMCwKICAgICAgbWRsQW1iaWw6IGZhbHNlLAogICAgICBzZWxlY3RlZFByb2dyYW06IHt9LAogICAgICBqdW1sYWhBbWJpbDogMCwKICAgICAgbWl0cmE6IHt9LAogICAgICBhbWJpbFNlbXVhOiBmYWxzZSwKICAgICAgY2F0YXRhbkFtYmlsOiAnJywKCiAgICAgIHRpcGU6IG51bGwsIC8vIHNpbXBhbiB0aXBlIHVzZXIKCgogICAgICBmb3JtOiB7CiAgICAgICAgYmlkYW5nX2Nzcl9pZDogbnVsbCwKICAgICAgICBiaWRhbmdfc3ViX2Nzcl9pZDogbnVsbCwKICAgICAgICBuYW1hX2NzcjogIiIsCiAgICAgICAgZGVza3JpcHNpOiAiIiwKICAgICAgICBqdW1sYWg6IG51bGwsCiAgICAgICAgc2F0dWFuOiAiIiwKICAgICAgICBuaWxhaTogbnVsbCwKICAgICAgICB0YW5nZ2FsX211bGFpOiAiIiwKICAgICAgICB0YW5nZ2FsX3NlbGVzYWk6ICIiLAogICAgICAgIGtlY2FtYXRhbl9pZDogbnVsbCwKICAgICAgICBkZXNhX2lkOiBudWxsLAogICAgICAgIGFsYW1hdDogIiIsCiAgICAgICAgZmlsZV9uYW1lOiBudWxsICAvLyDwn5S5IHVudHVrIGZpbGUgdXBsb2FkCiAgICAgIH0sCgogICAgICBtaXRyYTogewogICAgICAgIG5hbWFfcGVydXNhaGFhbjogJycsCiAgICAgICAgZW1haWxfcGVydXNhaGFhbjogJycsCiAgICAgICAgdGVscF9wZXJ1c2FoYWFuOiAnJywKICAgICAgICBhbGFtYXRfcGVydXNhaGFhbjogJycsCiAgICAgICAgbmFtYV9wajogJycsCiAgICAgICAgamFiYXRhbjogJycsCiAgICAgICAgZW1haWxfcGo6ICcnLAogICAgICAgIGhwX3BqOiAnJwogICAgICB9LAogICAgICBsaXN0X2JpZGFuZzogW10sCiAgICAgIGxpc3Rfc3ViX2JpZGFuZzogW10sCiAgICAgIGxpc3Rfa2VjYW1hdGFuOiBbXSwKICAgICAgbGlzdF9rZWNhbWF0YW5fbWFzdGVyOiBbXSwgLy8gc2ltcGFuIGRhdGEgYXNsaQogICAgICBsaXN0X2Rlc2E6IFtdLAogICAgICBsaXN0X2Rlc2FfbWFzdGVyOiBbXSwKICAgICAgbGlzdENTUjogW10sCiAgICAgIGZpbGVfcGF0aDogdGhpcy4kc3RvcmUuc3RhdGUudXJsLlVSTF9BUFAgKyAidXBsb2Fkcy8iLAoKCiAgICAgIGZpbHRlcmt1OiB7CiAgICAgICAga2VjYW1hdGFuX2lkOiAiIiwKICAgICAgICBkZXNhX2lkOiAiIiwKICAgICAgICBiaWRhbmdfY3NyX2lkOiAiIiwKICAgICAgICBiaWRhbmdfc3ViX2Nzcl9pZDogIiIsCiAgICAgICAgc3RhdHVzOiAiIgogICAgICB9LAoKCiAgICAgIGxpc3RfYmlkYW5nX2ZpbHRlcjogW10sCiAgICAgIGxpc3Rfc3ViX2JpZGFuZ19maWx0ZXI6IFtdLAoKICAgICAgLy8gaGFzaWwgZGF0YSB5YW5nIGRpZmlsdGVyCiAgICAgIGRhdGFWaWV3OiBbXSwKCiAgICAgIGxpc3Rfa2VjYW1hdGFuX2ZpbHRlcjogW10sCiAgICAgIGxpc3RfZGVzYV9maWx0ZXI6IFtdLAoKICAgICAgc3RhdHVzT3B0aW9uczogWwogICAgICAgIHsgbGFiZWw6ICdTZW11YSBTdGF0dXMnLCB2YWx1ZTogJycgfSwKICAgICAgICB7IGxhYmVsOiAnUHJvZ3JhbSBDU1IgQmFydScsIHZhbHVlOiAxIH0sCiAgICAgICAgeyBsYWJlbDogJ0RhbGFtIFBlbmdlcmphYW4nLCB2YWx1ZTogMiB9LAogICAgICAgIHsgbGFiZWw6ICdQZW5nZXJqYWFuIFNlYmFnaWFuJywgdmFsdWU6IDMgfSwKICAgICAgICB7IGxhYmVsOiAnU2VsZXNhaScsIHZhbHVlOiA0IH0KICAgICAgXSwKCiAgICAgIGtlY2FtYXRhbk9wdGlvbnM6IFtdLAogICAgICBiaWRhbmdPcHRpb25zOiBbXSAvLyA8LSB1YmFoIGRhcmkgY29tcHV0ZWQga2UgZGF0YQoKICAgIH0KCgogIH0sCgoKICBtZXRob2RzOiB7CgogICAgYW1iaWxQcm9ncmFtKGl0ZW0pIHsKICAgICAgdGhpcy5zZWxlY3RlZFByb2dyYW0gPSBpdGVtCiAgICAgIHRoaXMuYW1iaWxTZW11YSA9IGZhbHNlCiAgICAgIHRoaXMuanVtbGFoQW1iaWwgPSBpdGVtLmp1bWxhaF9zaXNhCiAgICAgIHRoaXMuY2F0YXRhbkFtYmlsID0gYEthbWkgYWthbiBtZW5nYW1iaWwgcHJvZ3JhbSBDU1IgJHtpdGVtLm5hbWFfY3NyfSwgbW9ob24gdW50dWsgc2VnZXJhIGRpdGluZGFrbGFuanV0aS4gVGVyaW1hIGthc2loLmAKICAgICAgdGhpcy5tZGxBbWJpbCA9IHRydWUKCiAgICAgIC8vIGFtYmlsIHVzZXJJZCBkYXJpIGxvY2FsU3RvcmFnZQogICAgICBjb25zdCBwcm9maWxlID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UucHJvZmlsZSkKICAgICAgY29uc3QgdXNlcklkID0gcHJvZmlsZS5faWQKCiAgICAgIC8vIHBhbmdnaWwgZnVuZ3NpIGdldE1pdHJhCiAgICAgIHRoaXMuZ2V0TWl0cmEodXNlcklkKQogICAgfSwKICAgIG9uVG9nZ2xlU2VtdWEodmFsKSB7CiAgICAgIGlmICh2YWwpIHsKICAgICAgICAvLyB0b2dnbGUgT04g4oaSIHBha2FpIHNlbXVhIGp1bWxhaCBzaXNhCiAgICAgICAgdGhpcy5qdW1sYWhBbWJpbCA9IHRoaXMuc2VsZWN0ZWRQcm9ncmFtLmp1bWxhaF9zaXNhCiAgICAgIH0KICAgICAgLy8ga2FsYXUgdG9nZ2xlIE9GRiDihpIgYmlhcmthbiBqdW1sYWhBbWJpbCB0ZXRhcCBhZGEgbmlsYWlueWEsCiAgICAgIC8vIHVzZXIgYmlzYSBtZW5nZWRpdCBtYW51YWwgZGkgaW5wdXQKICAgIH0sCgogICAgb25DaGFuZ2VEZXNhKHZhbCkgewogICAgICB0aGlzLmZpbHRlcmt1LmRlc2FfaWQgPSB2YWw7CiAgICAgIHRoaXMuZ2V0VmlldygpOyAvLyByZWZyZXNoIGRhdGEgc2VzdWFpIGZpbHRlcgogICAgfSwKCiAgICBvblN0YXR1c0NoYW5nZSh2YWwpIHsKICAgICAgdGhpcy5nZXRWaWV3KCkKICAgIH0sCgoKICAgIG9uQ2hhbmdlQmlkYW5nKHZhbCkgewogICAgICB0aGlzLmZpbHRlcmt1LmJpZGFuZ19zdWJfY3NyX2lkID0gIiI7IC8vIHJlc2V0IHN1Yi1iaWRhbmcKICAgICAgdGhpcy5nZXRTdWJCaWRhbmdGaWx0ZXIodmFsKTsKICAgICAgdGhpcy5nZXRWaWV3KCk7IC8vIHJlZnJlc2ggZGF0YQogICAgfSwKCiAgICBmb3JtYXRSdXBpYWgodmFsdWUpIHsKICAgICAgaWYgKHZhbHVlID09IG51bGwpIHJldHVybiAiLSI7CiAgICAgIHJldHVybiBuZXcgSW50bC5OdW1iZXJGb3JtYXQoJ2lkLUlEJywgewogICAgICAgIHN0eWxlOiAnY3VycmVuY3knLAogICAgICAgIGN1cnJlbmN5OiAnSURSJywKICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDAsCiAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiAwCiAgICAgIH0pLmZvcm1hdCh2YWx1ZSk7CiAgICB9LAoKICAgIG9uSXRlbUNsaWNrKGl0ZW0sIGFjdGlvbikgewogICAgICB0aGlzLnNlbGVjdGVkSXRlbSA9IGl0ZW07CgogICAgICBpZiAoYWN0aW9uID09PSAiZWRpdCIpIHsKICAgICAgICB0aGlzLm9wZW5FZGl0TW9kYWwoaXRlbSk7IC8vIGJ1a2EgbW9kYWwgZWRpdCBkYW4gaXNpIGZvcm0KICAgICAgfSBlbHNlIGlmIChhY3Rpb24gPT09ICJsaWhhdCIpIHsKICAgICAgICB0aGlzLm1kbF9saWhhdCA9IHRydWU7IC8vIGJ1a2EgbW9kYWwgbGloYXQgZGV0YWlsCiAgICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSAiZGVsZXRlIikgewogICAgICAgIHRoaXMuZm9ybS5pZCA9IGl0ZW0uaWQ7ICAvLyA8LS0tIGluaSBwZW50aW5nCiAgICAgICAgdGhpcy5tZGxfZGVsZXRlID0gdHJ1ZTsgLy8gYnVrYSBtb2RhbCBkZWxldGUKICAgICAgfQoKICAgIH0sCiAgICBkb3dubG9hZEZpbGUoZmlsZU5hbWUpIHsKICAgICAgaWYgKGZpbGVOYW1lKSB7CiAgICAgICAgd2luZG93Lm9wZW4odGhpcy5maWxlX3BhdGggKyBmaWxlTmFtZSwgIl9ibGFuayIpOwogICAgICB9CiAgICB9LAoKICAgIGdldEJpZGFuZygpIHsKICAgICAgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLlVSTF9ETV9CSUQgKyAiYmlkYW5nIiwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgIH0KICAgICAgfSkKICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAudGhlbihyZXNfZGF0YSA9PiB7CiAgICAgICAgICB0aGlzLmxpc3RfYmlkYW5nID0gcmVzX2RhdGEKICAgICAgICB9KQogICAgfSwKICAgIGdldE1pdHJhKHVzZXJJZCkgewogICAgICBmZXRjaCh0aGlzLiRzdG9yZS5zdGF0ZS51cmwuS0VHSUFUQU5fQ1NSICsgIm1pdHJhLyIgKyB1c2VySWQsIHsKICAgICAgICBtZXRob2Q6ICJHRVQiLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgIH0KICAgICAgfSkKICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAudGhlbihyZXNfZGF0YSA9PiB7CiAgICAgICAgICBpZiAocmVzX2RhdGEuc3VjY2VzcykgewogICAgICAgICAgICB0aGlzLm1pdHJhID0gcmVzX2RhdGEuZGF0YQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5Ob3RpZnkoIkdhZ2FsIG1lbmdhbWJpbCBkYXRhIG1pdHJhIiwgIm5lZ2F0aXZlIiwgImVycm9yX291dGxpbmUiKQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJyb3I6IiwgZXJyKQogICAgICAgICAgdGhpcy5Ob3RpZnkoIlRlcmphZGkga2VzYWxhaGFuIHNlcnZlciIsICJuZWdhdGl2ZSIsICJlcnJvcl9vdXRsaW5lIikKICAgICAgICB9KQogICAgfSwKCiAgICBzdWJtaXRBbWJpbCgpIHsKICAgICAgaWYgKCF0aGlzLmp1bWxhaEFtYmlsIHx8IHRoaXMuanVtbGFoQW1iaWwgPD0gMCkgewogICAgICAgIHRoaXMuTm90aWZ5KCJKdW1sYWggeWFuZyBkaWFtYmlsIGhhcnVzIGxlYmloIGRhcmkgMCIsICJuZWdhdGl2ZSIsICJlcnJvcl9vdXRsaW5lIik7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBwcm9maWxlID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UucHJvZmlsZSk7CgogICAgICBjb25zdCBwYXlsb2FkID0gewogICAgICAgIGtlZ2lhdGFuX2lkOiB0aGlzLnNlbGVjdGVkUHJvZ3JhbS5pZCwKICAgICAgICBwZXJ1c2FoYWFuX2lkOiBwcm9maWxlLl9pZCwgLy8gYW1iaWwgdXNlciBsb2dpbgogICAgICAgIGp1bWxhaF9hbWJpbDogdGhpcy5qdW1sYWhBbWJpbCwKICAgICAgICBjYXRhdGFuX21pdHJhOiB0aGlzLmNhdGF0YW5BbWJpbAogICAgICB9OwoKICAgICAgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLktFR0lBVEFOX0NTUiArICJhZGRQZW5nYWp1YW4iLCB7CiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgIH0sCiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCkKICAgICAgfSkKICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAudGhlbihyZXNfZGF0YSA9PiB7CiAgICAgICAgICBpZiAocmVzX2RhdGEuc3VjY2VzcykgewogICAgICAgICAgICB0aGlzLk5vdGlmeSgiUGVuZ2FqdWFuIGJlcmhhc2lsIGRpa2lyaW0iLCAicHJpbWFyeSIsICJjaGVja19jaXJjbGVfb3V0bGluZSIpOwogICAgICAgICAgICB0aGlzLm1kbEFtYmlsID0gZmFsc2U7CiAgICAgICAgICAgIHRoaXMuZ2V0VmlldygpOyAvLyByZWZyZXNoIGxpc3QKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuTm90aWZ5KCJHYWdhbCBtZW5naXJpbSBwZW5nYWp1YW4iLCAibmVnYXRpdmUiLCAiZXJyb3Jfb3V0bGluZSIpOwogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJyb3I6IiwgZXJyKTsKICAgICAgICAgIHRoaXMuTm90aWZ5KCJUZXJqYWRpIGtlc2FsYWhhbiBzZXJ2ZXIiLCAibmVnYXRpdmUiLCAiZXJyb3Jfb3V0bGluZSIpOwogICAgICAgIH0pOwogICAgfSwKCiAgICBnZXRTdWJCaWRhbmcoKSB7CiAgICAgIC8vIHJlc2V0IHN1YiBiaWRhbmcgZHVsdSBiaWFyIHRpZGFrIG5lbXBlbAogICAgICB0aGlzLmZvcm0uYmlkYW5nX3N1Yl9jc3JfaWQgPSBudWxsCiAgICAgIHRoaXMubGlzdF9zdWJfYmlkYW5nID0gW10KCiAgICAgIGlmICghdGhpcy5mb3JtLmJpZGFuZ19jc3JfaWQpIHsKICAgICAgICByZXR1cm4KICAgICAgfQoKICAgICAgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLlVSTF9ETV9CSUQgKyAic3ViX2JpZGFuZyIsIHsKICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgYXV0aG9yaXphdGlvbjogImtpa2Vuc2JhdGFyYSAiICsgbG9jYWxTdG9yYWdlLnRva2VuCiAgICAgICAgfSwKICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICBiaWRhbmdfY3NyX2lkOiB0aGlzLmZvcm0uYmlkYW5nX2Nzcl9pZAogICAgICAgIH0pCiAgICAgIH0pCiAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpCiAgICAgICAgLnRoZW4ocmVzX2RhdGEgPT4gewogICAgICAgICAgdGhpcy5saXN0X3N1Yl9iaWRhbmcgPSByZXNfZGF0YQogICAgICAgIH0pCiAgICB9LAoKICAgIGdldEtlY2FtYXRhbigpIHsKICAgICAgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLktFR0lBVEFOX0NTUiArICJrZWNhbWF0YW4iLCB7CiAgICAgICAgbWV0aG9kOiAiR0VUIiwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgYXV0aG9yaXphdGlvbjogImtpa2Vuc2JhdGFyYSAiICsgbG9jYWxTdG9yYWdlLnRva2VuCiAgICAgICAgfQogICAgICB9KQogICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKQogICAgICAgIC50aGVuKHJlc19kYXRhID0+IHsKICAgICAgICAgIHRoaXMubGlzdF9rZWNhbWF0YW4gPSByZXNfZGF0YQogICAgICAgICAgdGhpcy5saXN0X2tlY2FtYXRhbl9tYXN0ZXIgPSByZXNfZGF0YSAvLyBzaW1wYW4gdW50dWsgZmlsdGVyCiAgICAgICAgfSkKICAgIH0sCgogICAgZmlsdGVyS2VjYW1hdGFuKHZhbCwgdXBkYXRlKSB7CiAgICAgIGlmICh2YWwgPT09ICcnKSB7CiAgICAgICAgdXBkYXRlKCgpID0+IHsKICAgICAgICAgIHRoaXMubGlzdF9rZWNhbWF0YW4gPSB0aGlzLmxpc3Rfa2VjYW1hdGFuX21hc3RlcgogICAgICAgIH0pCiAgICAgICAgcmV0dXJuCiAgICAgIH0KCiAgICAgIHVwZGF0ZSgoKSA9PiB7CiAgICAgICAgY29uc3QgbmVlZGxlID0gdmFsLnRvTG93ZXJDYXNlKCkKICAgICAgICB0aGlzLmxpc3Rfa2VjYW1hdGFuID0gdGhpcy5saXN0X2tlY2FtYXRhbl9tYXN0ZXIuZmlsdGVyKHYgPT4KICAgICAgICAgIHYubmFtYV9rZWNhbWF0YW4udG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhuZWVkbGUpCiAgICAgICAgKQogICAgICB9KQogICAgfSwKCiAgICBnZXREZXNhKCkgewogICAgICB0aGlzLmZvcm0uZGVzYV9pZCA9IG51bGwKICAgICAgdGhpcy5saXN0X2Rlc2EgPSBbXQogICAgICB0aGlzLmxpc3RfZGVzYV9tYXN0ZXIgPSBbXQoKICAgICAgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLktFR0lBVEFOX0NTUiArICJkZXNhIiwgewogICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICBhdXRob3JpemF0aW9uOiAia2lrZW5zYmF0YXJhICIgKyBsb2NhbFN0b3JhZ2UudG9rZW4KICAgICAgICB9LAogICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgIGtlY2FtYXRhbl9pZDogdGhpcy5mb3JtLmtlY2FtYXRhbl9pZCAgIC8vIPCflKUgaW5pIHlhbmcgYmVuYXIKICAgICAgICB9KQogICAgICB9KQogICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKQogICAgICAgIC50aGVuKHJlc19kYXRhID0+IHsKICAgICAgICAgIHRoaXMubGlzdF9kZXNhID0gcmVzX2RhdGE7CiAgICAgICAgICB0aGlzLmxpc3RfZGVzYV9tYXN0ZXIgPSByZXNfZGF0YQogICAgICAgIH0pOwogICAgfSwKCiAgICBmaWx0ZXJEZXNhKHZhbCwgdXBkYXRlKSB7CiAgICAgIGlmICh2YWwgPT09ICcnKSB7CiAgICAgICAgdXBkYXRlKCgpID0+IHsKICAgICAgICAgIHRoaXMubGlzdF9kZXNhID0gdGhpcy5saXN0X2Rlc2FfbWFzdGVyCiAgICAgICAgfSkKICAgICAgICByZXR1cm4KICAgICAgfQoKICAgICAgdXBkYXRlKCgpID0+IHsKICAgICAgICBjb25zdCBuZWVkbGUgPSB2YWwudG9Mb3dlckNhc2UoKQogICAgICAgIHRoaXMubGlzdF9kZXNhID0gdGhpcy5saXN0X2Rlc2FfbWFzdGVyLmZpbHRlcih2ID0+CiAgICAgICAgICB2Lm5hbWFfZGVzX2tlbC50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKG5lZWRsZSkKICAgICAgICApCiAgICAgIH0pCiAgICB9LAoKCiAgICBhZGREYXRhKCkgewogICAgICB0aGlzLmJ0bl9hZGQgPSB0cnVlOwoKICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgZm9yIChsZXQga2V5IGluIHRoaXMuZm9ybSkgewogICAgICAgIGlmIChrZXkgPT09ICJmaWxlIiAmJiB0aGlzLmZvcm0uZmlsZSkgewogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJmaWxlIiwgdGhpcy5mb3JtLmZpbGUpOyAvLyBmaWVsZCAnZmlsZScgc2VzdWFpIGJhY2tlbmQKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKGtleSwgdGhpcy5mb3JtW2tleV0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLktFR0lBVEFOX0NTUiArICJhZGREYXRhIiwgewogICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgIH0sCiAgICAgICAgYm9keTogZm9ybURhdGEKICAgICAgfSkKICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAudGhlbihyZXNfZGF0YSA9PiB7CiAgICAgICAgICB0aGlzLmJ0bl9hZGQgPSBmYWxzZTsKICAgICAgICAgIGlmIChyZXNfZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICAgIHRoaXMuTm90aWZ5KCJTdWtzZXMgTWVuYW1iYWggRGF0YSIsICJwcmltYXJ5IiwgImNoZWNrX2NpcmNsZV9vdXRsaW5lIik7CiAgICAgICAgICAgIHRoaXMuZ2V0VmlldygpOwogICAgICAgICAgICB0aGlzLm1kbF9hZGQgPSBmYWxzZTsKICAgICAgICAgICAgdGhpcy5yZXNldEZvcm0oKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuTm90aWZ5KCJHYWdhbCBNZW5hbWJhaCBEYXRhIiwgIm5lZ2F0aXZlIiwgImVycm9yX291dGxpbmUiKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaChlcnIgPT4gewogICAgICAgICAgdGhpcy5idG5fYWRkID0gZmFsc2U7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJyb3I6IiwgZXJyKTsKICAgICAgICAgIHRoaXMuTm90aWZ5KCJUZXJqYWRpIGtlc2FsYWhhbiBzZXJ2ZXIiLCAibmVnYXRpdmUiLCAiZXJyb3Jfb3V0bGluZSIpOwogICAgICAgIH0pOwogICAgfSwKICAgIHJlc2V0Rm9ybSgpIHsKICAgICAgdGhpcy5mb3JtID0gewogICAgICAgIGJpZGFuZ19jc3JfaWQ6IG51bGwsCiAgICAgICAgYmlkYW5nX3N1Yl9jc3JfaWQ6IG51bGwsCiAgICAgICAgbmFtYV9jc3I6ICIiLAogICAgICAgIGRlc2tyaXBzaTogIiIsCiAgICAgICAganVtbGFoOiBudWxsLAogICAgICAgIHNhdHVhbjogIiIsCiAgICAgICAgbmlsYWk6IG51bGwsCiAgICAgICAgdGFuZ2dhbF9tdWxhaTogIiIsCiAgICAgICAgdGFuZ2dhbF9zZWxlc2FpOiAiIiwKICAgICAgICBrZWNhbWF0YW5faWQ6IG51bGwsCiAgICAgICAgZGVzYV9pZDogbnVsbCwKICAgICAgICBhbGFtYXQ6ICIiCiAgICAgIH0KICAgIH0sCgogICAgLy8gYW1iaWwgZGF0YSB1dGFtYQogICAgZ2V0VmlldygpIHsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzaG9XTG9hZGluZyIpCiAgICAgIGZldGNoKHRoaXMuJHN0b3JlLnN0YXRlLnVybC5LRUdJQVRBTl9DU1IgKyAidmlld0RhdGEiLCB7CiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgIH0sCiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgLi4udGhpcy5maWx0ZXJrdSwgICAgICAgLy8ga2lyaW0gc2VtdWEgZmlsdGVyCiAgICAgICAgICBkYXRhX2tlOiB0aGlzLnBhZ2VfZmlyc3QsCiAgICAgICAgICBjYXJpX3ZhbHVlOiB0aGlzLmNhcmlfdmFsdWUsCiAgICAgICAgICBwYWdlX2xpbWl0OiB0aGlzLnBhZ2VfbGltaXQKICAgICAgICB9KQogICAgICB9KQogICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKQogICAgICAgIC50aGVuKHJlc19kYXRhID0+IHsKICAgICAgICAgIHRoaXMuZGF0YVZpZXcgPSByZXNfZGF0YS5kYXRhCiAgICAgICAgICB0aGlzLnRvdGFsID0gcmVzX2RhdGEudG90YWw7CiAgICAgICAgICB0aGlzLnBhZ2VfbGFzdCA9IE1hdGguY2VpbCh0aGlzLnRvdGFsIC8gdGhpcy5wYWdlX2xpbWl0KTsKICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiaGlkZUxvYWRpbmciKQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJyb3IgZ2V0VmlldzoiLCBlcnIpCiAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoImhpZGVMb2FkaW5nIikKICAgICAgICB9KQogICAgfSwKCiAgICByZW1vdmVEYXRhOiBmdW5jdGlvbiAoKSB7CiAgICAgIGZldGNoKHRoaXMuJHN0b3JlLnN0YXRlLnVybC5LRUdJQVRBTl9DU1IgKyAicmVtb3ZlRGF0YSIsIHsKICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgYXV0aG9yaXphdGlvbjogImtpa2Vuc2JhdGFyYSAiICsgbG9jYWxTdG9yYWdlLnRva2VuCiAgICAgICAgfSwKICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGlkOiB0aGlzLmZvcm0uaWQgfSkKICAgICAgfSkKICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAudGhlbihyZXNfZGF0YSA9PiB7CiAgICAgICAgICBpZiAocmVzX2RhdGEuc3VjY2VzcykgewogICAgICAgICAgICB0aGlzLk5vdGlmeSgnU3Vrc2VzIE1lbmdoYXB1cyBEYXRhJywgJ25lZ2F0aXZlJywgJ2NoZWNrX2NpcmNsZV9vdXRsaW5lJyk7CiAgICAgICAgICAgIHRoaXMuZ2V0VmlldygpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5Ob3RpZnkoJ0dhZ2FsIE1lbmdoYXB1cyBEYXRhJywgJ3dhcm5pbmcnLCAnZXJyb3InKTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5jYXRjaChlcnIgPT4gewogICAgICAgICAgdGhpcy5Ob3RpZnkoJ0Vycm9yOiAnICsgZXJyLm1lc3NhZ2UsICd3YXJuaW5nJywgJ2Vycm9yJyk7CiAgICAgICAgfSk7CiAgICB9LAoKCiAgICBnZXRCaWRhbmdGaWx0ZXIoKSB7CiAgICAgIGZldGNoKHRoaXMuJHN0b3JlLnN0YXRlLnVybC5VUkxfRE1fQklEICsgImJpZGFuZyIsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBhdXRob3JpemF0aW9uOiAia2lrZW5zYmF0YXJhICIgKyBsb2NhbFN0b3JhZ2UudG9rZW4KICAgICAgICB9CiAgICAgIH0pCiAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpCiAgICAgICAgLnRoZW4ocmVzX2RhdGEgPT4gewogICAgICAgICAgdGhpcy5iaWRhbmdPcHRpb25zID0gWwogICAgICAgICAgICB7IGlkOiAiIiwgdXJhaWFuOiAiLS0gU0VNVUEgQklEQU5HIC0tIiB9LAogICAgICAgICAgICAuLi5yZXNfZGF0YS5tYXAoYiA9PiAoewogICAgICAgICAgICAgIC4uLmIsCiAgICAgICAgICAgICAgaWQ6IGIuaWQudG9TdHJpbmcoKSAgLy8gcGFzdGlrYW4gdGlwZSBzYW1hIGRlbmdhbiB2LW1vZGVsCiAgICAgICAgICAgIH0pKQogICAgICAgICAgXTsKICAgICAgICB9KQogICAgfSwKCiAgICBnZXRTdWJCaWRhbmdGaWx0ZXIoKSB7CiAgICAgIHRoaXMuZmlsdGVya3UuYmlkYW5nX3N1Yl9jc3JfaWQgPSBudWxsCiAgICAgIHRoaXMubGlzdF9zdWJfYmlkYW5nX2ZpbHRlciA9IFtdCgogICAgICBpZiAoIXRoaXMuZmlsdGVya3UuYmlkYW5nX2Nzcl9pZCkgcmV0dXJuCgogICAgICBmZXRjaCh0aGlzLiRzdG9yZS5zdGF0ZS51cmwuVVJMX0RNX0JJRCArICJzdWJfYmlkYW5nIiwgewogICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICBhdXRob3JpemF0aW9uOiAia2lrZW5zYmF0YXJhICIgKyBsb2NhbFN0b3JhZ2UudG9rZW4KICAgICAgICB9LAogICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgIGJpZGFuZ19jc3JfaWQ6IHRoaXMuZmlsdGVya3UuYmlkYW5nX2Nzcl9pZAogICAgICAgIH0pCiAgICAgIH0pCiAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpCiAgICAgICAgLnRoZW4ocmVzX2RhdGEgPT4gewogICAgICAgICAgdGhpcy5saXN0X3N1Yl9iaWRhbmdfZmlsdGVyID0gcmVzX2RhdGEKICAgICAgICB9KQogICAgfSwKCiAgICBnZXRLZWNhbWF0YW5GaWx0ZXIoKSB7CiAgICAgIGZldGNoKHRoaXMuJHN0b3JlLnN0YXRlLnVybC5LRUdJQVRBTl9DU1IgKyAia2VjYW1hdGFuIiwgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgIH0KICAgICAgfSkKICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAudGhlbihyZXNfZGF0YSA9PiB7CiAgICAgICAgICB0aGlzLmtlY2FtYXRhbk9wdGlvbnMgPSBbCiAgICAgICAgICAgIHsga2VjYW1hdGFuX2lkOiAiIiwgbmFtYV9rZWNhbWF0YW46ICItLSBTRU1VQSBLRUNBTUFUQU4gLS0iIH0sCiAgICAgICAgICAgIC4uLnJlc19kYXRhLm1hcChrID0+ICh7CiAgICAgICAgICAgICAgLi4uaywKICAgICAgICAgICAgICBrZWNhbWF0YW5faWQ6IGsua2VjYW1hdGFuX2lkLnRvU3RyaW5nKCkKICAgICAgICAgICAgfSkpCiAgICAgICAgICBdOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmVycm9yKCLinYwgRXJyb3IgZmV0Y2gga2VjYW1hdGFuOiIsIGVycikpOwogICAgfSwKCgogICAgLy8gU2FhdCBwaWxpaCBrZWNhbWF0YW4KICAgIG9uQ2hhbmdlS2VjYW1hdGFuRmlsdGVyKHZhbCkgewogICAgICB0aGlzLmZpbHRlcmt1LmtlY2FtYXRhbl9pZCA9IHZhbDsgLy8gcGFzdGlrYW4gdi1tb2RlbCB0ZXJzaW5rcm9uaXNhc2kKICAgICAgdGhpcy5maWx0ZXJrdS5kZXNhX2lkID0gIiI7CiAgICAgIHRoaXMuZ2V0RGVzYUZpbHRlcigpOwogICAgICB0aGlzLmdldFZpZXcoKTsgLy8gamlrYSBpbmdpbiBvdG9tYXRpcyByZWxvYWQgZGF0YQogICAgfSwKCiAgICAvLyBBbWJpbCBkZXNhIHNlc3VhaSBrZWNhbWF0YW4KICAgIGdldERlc2FGaWx0ZXIoKSB7CiAgICAgIGlmICghdGhpcy5maWx0ZXJrdS5rZWNhbWF0YW5faWQpIHsKICAgICAgICB0aGlzLmxpc3RfZGVzYV9maWx0ZXIgPSBbXQogICAgICAgIHJldHVybgogICAgICB9CgogICAgICBmZXRjaCh0aGlzLiRzdG9yZS5zdGF0ZS51cmwuS0VHSUFUQU5fQ1NSICsgImRlc2EiLCB7CiAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgIH0sCiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAga2VjYW1hdGFuX2lkOiB0aGlzLmZpbHRlcmt1LmtlY2FtYXRhbl9pZAogICAgICAgIH0pCiAgICAgIH0pCiAgICAgICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpCiAgICAgICAgLnRoZW4ocmVzX2RhdGEgPT4gewogICAgICAgICAgdGhpcy5saXN0X2Rlc2FfZmlsdGVyID0gcmVzX2RhdGEKICAgICAgICB9KQogICAgICAgIC5jYXRjaChlcnIgPT4gewogICAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgZmV0Y2ggZGVzYToiLCBlcnIpIC8vIPCflKUgbG9nIGVycm9yCiAgICAgICAgfSkKICAgIH0sCgoKCgoKICAgIHNpbXVsYXRlUHJvZ3Jlc3MobnVtYmVyKSB7CiAgICAgIC8vIHdlIHNldCBsb2FkaW5nIHN0YXRlCiAgICAgIHRoaXNbYHNpbXBhbiR7bnVtYmVyfWBdID0gdHJ1ZQogICAgICAvLyBzaW11bGF0ZSBhIGRlbGF5CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIC8vIHdlJ3JlIGRvbmUsIHdlIHJlc2V0IGxvYWRpbmcgc3RhdGUKICAgICAgICB0aGlzW2BzaW1wYW4ke251bWJlcn1gXSA9IGZhbHNlCiAgICAgIH0sIDMwMDApCiAgICB9LAoKICAgIE5vdGlmeTogZnVuY3Rpb24gKG1lc3NhZ2UsIHBvc2l0aXZlLCBpY29uKSB7CiAgICAgIHRoaXMuJHEubm90aWZ5KHsKICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLAogICAgICAgIGNvbG9yOiBwb3NpdGl2ZSwKICAgICAgICBpY29uOiBpY29uLAogICAgICAgIHBvc2l0aW9uOiAndG9wJywKICAgICAgICB0aW1lb3V0OiA1MDAsCiAgICAgIH0pCiAgICB9LAoKICAgIC8vIGNhcmlfZGF0YSgpIHsKCiAgICAvLyAgICAgdGhpcy5nZXRWaWV3KCk7IC8vIHJlZnJlc2ggZGF0YSBzZXN1YWkgaW5wdXQgcGVuY2FyaWFuCiAgICAvLyAgIH0sCiAgICBidG5fcHJldigpIHsKICAgICAgaWYgKHRoaXMucGFnZV9maXJzdCA+IDEpIHRoaXMucGFnZV9maXJzdC0tOwogICAgICB0aGlzLmdldFZpZXcoKTsKICAgIH0sCgogICAgYnRuX25leHQoKSB7CiAgICAgIGlmICh0aGlzLnBhZ2VfZmlyc3QgPCB0aGlzLnBhZ2VfbGFzdCkgdGhpcy5wYWdlX2ZpcnN0Kys7CiAgICAgIHRoaXMuZ2V0VmlldygpOwogICAgfSwKCiAgICBjYXJpX2RhdGEoKSB7CiAgICAgIHRoaXMucGFnZV9maXJzdCA9IDE7CiAgICAgIHRoaXMuZ2V0VmlldygpOwogICAgfSwKCiAgICBpbmRleGluZyhpbmRleCkgewogICAgICByZXR1cm4gKCh0aGlzLnBhZ2VfZmlyc3QgLSAxKSAqIHRoaXMucGFnZV9saW1pdCkgKyBpbmRleDsKICAgIH0sCgogICAgb3BlbkVkaXRNb2RhbChpdGVtKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gaXRlbTsKCiAgICAgIC8vIHNldCBmb3JtCiAgICAgIHRoaXMuZm9ybSA9IHsgLi4uaXRlbSB9OwoKICAgICAgLy8gaXNpIHN1Yi1iaWRhbmcgc2VzdWFpIGJpZGFuZwogICAgICBpZiAodGhpcy5mb3JtLmJpZGFuZ19jc3JfaWQpIHsKICAgICAgICB0aGlzLmdldFN1YkJpZGFuZyh0aGlzLmZvcm0uYmlkYW5nX2Nzcl9pZCk7CiAgICAgIH0KCiAgICAgIC8vIGJ1a2EgbW9kYWwKICAgICAgdGhpcy5tZGxfZWRpdCA9IHRydWU7CiAgICB9CgoKCiAgfSwKICBtb3VudGVkKCkgewoKICAgIGNvbnN0IGdldF9wcm9maWxlID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UucHJvZmlsZSk7CiAgICB0aGlzLnRpcGUgPSBOdW1iZXIoZ2V0X3Byb2ZpbGUucHJvZmlsZS5kYl9jc3Jrb25zZWwpOyAvLyBhbWJpbCBkYl9jc3Jrb25zZWwKCgogICAgLy8gc2ltcGFuIGRhdGEgbWl0cmEgKGthbGF1IHlhbmcgbG9naW4gbWVtYW5nIG1pdHJhKQogICAgdGhpcy5taXRyYSA9IHsKICAgICAgaWQ6IGdldF9wcm9maWxlLl9pZCwKICAgICAgbmFtYTogZ2V0X3Byb2ZpbGUucHJvZmlsZS5uYW1hLAogICAgICB1c2VybmFtZTogZ2V0X3Byb2ZpbGUudXNlcm5hbWUKICAgIH0KCgogICAgLy8gamFsYW5rYW4ga2V0aWthIGhhbGFtYW4gcGVydGFtYSBrYWxpIGRpYnVrYQogICAgdGhpcy5nZXRWaWV3KCk7CiAgICB0aGlzLmdldEtlY2FtYXRhbigpOwogICAgdGhpcy5nZXREZXNhKCk7CiAgICB0aGlzLmdldEtlY2FtYXRhbkZpbHRlcigpOwogICAgLy8gdGhpcy5nZXREZXNhRmlsdGVyKCk7CiAgICB0aGlzLmdldEJpZGFuZygpOwogICAgdGhpcy5nZXRTdWJCaWRhbmcoKTsKICAgIHRoaXMuZ2V0QmlkYW5nRmlsdGVyKCk7CiAgICAvLyB0aGlzLmdldFN1YkJpZGFuZ0ZpbHRlcigpOwogIH0KfQo="},{"version":3,"sources":["kegiatan_csr.vue"],"names":[],"mappings":";;AA6qBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;;AAGA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;AAIA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"kegiatan_csr.vue","sourceRoot":"src/views/1kegiatancsr","sourcesContent":["<template>\n  <div class=\"about \" style=\"padding:15px\">\n    <q-card bordered class=\"my-card\">\n      <q-card-section class=\"main2 text-white\">\n        <div class=\"row items-center q-col-gutter-md\">\n          <div class=\"col-12 col-md-6\">\n            <div class=\"text-h6 h_titleHead\">Kegiatan CSR</div>\n          </div>\n\n          <!-- Filter Status -->\n          <div class=\"col-12 col-md-2\">\n            <q-select v-model=\"filterku.status\" :options=\"statusOptions\" outlined dense square emit-value map-options\n              class=\"bg-white\" @input=\"onStatusChange\" />\n          </div>\n\n          <!-- Cari + Tombol Add -->\n          <div class=\"col-12 col-md-4\">\n            <div class=\"row\">\n              <q-input v-model=\"cari_value\" @keyup=\"cari_data()\" outlined square dense class=\"bg-white col q-mr-sm\" />\n              <q-btn v-if=\"tipe == 1 || tipe  == 5\" glossy class=\"col-auto\" color=\"amber\" @click=\"mdl_add = true\" dense icon=\"add\">\n                <q-tooltip content-class=\"bg-amber-7\" content-style=\"font-size: 13px\">\n                  Click untuk menambah data\n                </q-tooltip>\n              </q-btn>\n            </div>\n          </div>\n        </div>\n\n      </q-card-section>\n\n    </q-card>\n\n\n    <hr class=\"hrpagin2\">\n\n\n\n\n\n    <div class=\"row q-col-gutter-md\">\n      <!-- Filter Kecamatan -->\n      <!-- Filter Kecamatan -->\n      <div class=\"col-12 col-md-6\">\n        <span class=\"h_lable\">Kecamatan</span>\n        <q-select v-model=\"filterku.kecamatan_id\" :options=\"kecamatanOptions\" option-label=\"nama_kecamatan\"\n          option-value=\"kecamatan_id\" emit-value map-options outlined dense class=\"bg-white\"\n          @input=\"onChangeKecamatanFilter\" />\n\n      </div>\n\n      <!-- Filter Desa -->\n      <div class=\"col-12 col-md-6\">\n        <span class=\"h_lable\">Desa</span>\n        <q-select v-model=\"filterku.desa_id\" :options=\"list_desa_filter\" option-label=\"nama_des_kel\"\n          option-value=\"des_kel_id\" label=\"-- SEMUA DESA --\" emit-value map-options outlined dense class=\"bg-white\"\n          @input=\"onChangeDesa\" />\n\n      </div>\n\n\n      <!-- Filter Bidang -->\n      <div class=\"col-12 col-md-6\">\n        <span class=\"h_lable\">Bidang CSR</span>\n        <q-select v-model=\"filterku.bidang_csr_id\" :options=\"bidangOptions\" option-label=\"uraian\" option-value=\"id\"\n          emit-value map-options outlined dense class=\"bg-white\" @input=\"onChangeBidang\" />\n      </div>\n\n      <!-- Filter Sub-Bidang -->\n      <div class=\"col-12 col-md-6\">\n        <span class=\"h_lable\">Sub-Bidang CSR</span>\n        <q-select v-model=\"filterku.bidang_sub_csr_id\" :options=\"list_sub_bidang_filter\" option-label=\"uraian\"\n          option-value=\"id\" label=\"-- SEMUA SUB-BIDANG --\" emit-value map-options outlined dense class=\"bg-white\"\n          @input=\"getView\" />\n      </div>\n\n\n    </div>\n    <hr class=\"hrpagin2\">\n\n    <div class=\"row q-mt-md\" style=\"display: flex; flex-wrap: wrap;\">\n      <div v-for=\"item in dataView\" :key=\"item.id\" style=\"flex: 0 0 33.33%; padding: 8px;\">\n        <q-card bordered style=\"height: 500px; display: flex; flex-direction: column;\">\n\n          <!-- Gambar dengan Status -->\n          <div class=\"img-wrapper\"\n            style=\"height: 250px; position: relative; overflow: hidden; border-bottom: 1px solid #e0e0e0;\">\n            <q-img :src=\"item.file_name ? file_path + item.file_name : 'https://cdn.quasar.dev/img/chicken-salad.jpg'\"\n              spinner-color=\"primary\" style=\"width: 100%; height: 100%;\" :contain=\"true\" />\n\n            <!-- Status Chip (Overlay) -->\n            <div style=\"position: absolute; top: 10px; left: 10px;\">\n              <q-chip v-if=\"item.status == 1\" color=\"orange-5\" text-color=\"white\" icon=\"new_releases\" dense>\n                Program CSR Baru\n              </q-chip>\n              <q-chip v-else-if=\"item.status == 2\" color=\"blue-6\" text-color=\"white\" icon=\"autorenew\" dense>\n                Dalam Pengerjaan\n              </q-chip>\n              <q-chip v-else-if=\"item.status == 3\" color=\"deep-purple-5\" text-color=\"white\" icon=\"hourglass_bottom\"\n                dense>\n                Pengerjaan Sebagian\n              </q-chip>\n              <q-chip v-else-if=\"item.status == 4\" color=\"green-6\" text-color=\"white\" icon=\"check_circle\" dense>\n                Selesai\n              </q-chip>\n            </div>\n          </div>\n\n          <!-- Nama CSR & Bidang -->\n          <q-card-section style=\"flex-grow: 1; display: flex; flex-direction: column; justify-content: space-between;\">\n            <div>\n              <div class=\"text-h8 q-mb-xs\" style=\"font-weight: 500;\">{{ item.nama_csr }}</div>\n              <div class=\"text-subtitle2 text-grey q-mb-sm\">\n                <b>{{ item.uraian_bidang_csr }}</b>\n                <span v-if=\"item.uraian_bidang_sub_csr\"> | {{ item.uraian_bidang_sub_csr }}</span>\n              </div>\n            </div>\n            <!-- Kebutuhan & Nilai -->\n            <div class=\"column q-gutter-xs text-subtitle2 text-dark\">\n              <div>\n                Jumlah Kebutuhan Program: <b>{{ item.jumlah }}</b> {{ item.satuan }}\n              </div>\n              <div>\n                Nilai : <b>Rp {{ Number(item.nilai).toLocaleString('id-ID') }} / {{ item.satuan }}</b>\n              </div>\n            </div>\n          </q-card-section>\n\n          <q-separator />\n\n          <!-- Footer Action -->\n          <q-card-actions align=\"right\" class=\"q-pt-sm\">\n            <q-btn v-if=\"tipe == 4 && (item.status == 1 || item.status == 3)\" color=\"amber\" text-color=\"white\"\n              label=\"Ambil Program\" glossy rounded dense icon=\"gavel\" @click=\"ambilProgram(item)\">\n              <q-tooltip content-class=\"bg-amber-7\" content-style=\"font-size: 13px\">\n                Ambil program CSR ini\n              </q-tooltip>\n            </q-btn>\n\n            <q-btn round dense color=\"primary\" icon=\"visibility\" @click=\"onItemClick(item, 'lihat')\" >\n              <q-tooltip content-class=\"bg-blue-4\">Lihat Detil</q-tooltip>\n            </q-btn>\n\n            <q-btn v-if=\"tipe == 1 || tipe  == 5\" round dense color=\"amber\" icon=\"edit\" @click=\"onItemClick(item, 'edit')\" :disable=\"item.status !== 1\">\n              <q-tooltip content-class=\"bg-amber-6\">Edit Program</q-tooltip>\n            </q-btn>\n\n            <q-btn v-if=\"tipe == 1 || tipe  == 5\" round dense color=\"negative\" icon=\"delete\" @click=\"onItemClick(item, 'delete')\" :disable=\"item.status !== 1\">\n              <q-tooltip content-class=\"bg-red-6\">Hapus Program</q-tooltip>\n            </q-btn>\n          </q-card-actions>\n        </q-card>\n\n\n\n      </div>\n\n\n    </div>\n\n    <hr class=\"hrpagin\">\n    <br>\n    <div class=\"flex flex-center\">\n      <q-pagination v-model=\"page_first\" :max=\"page_last\" :max-pages=\"4\" color=\"grey-6\" :direction-links=\"true\"\n        :boundary-links=\"true\" icon-first=\"skip_previous\" icon-last=\"skip_next\" icon-prev=\"fast_rewind\"\n        icon-next=\"fast_forward\" @input=\"getView\" />\n    </div>\n\n\n    <!-- ===================== MODAL ADD KEGIATAN CSR ===================== -->\n    <q-dialog v-model=\"mdl_add\" persistent>\n      <q-card class=\"mdl-md\">\n        <q-card-section class=\"main2 text-white\">\n          <div class=\"text-h6 h_modalhead\">Tambah Kegiatan CSR</div>\n        </q-card-section>\n\n        <form @submit.prevent=\"addData()\">\n\n          <q-card-section class=\"q-pt-none\">\n\n            <hr class=\"hrpagin2\">\n\n            <!-- BIDANG CSR -->\n            <span class=\"h_lable\">Bidang CSR</span>\n            <q-select v-model=\"form.bidang_csr_id\" :options=\"list_bidang\" option-value=\"id\" option-label=\"uraian\"\n              emit-value map-options outlined square dense class=\"bg-white margin_btn\" @input=\"getSubBidang\" />\n\n            <!-- SUB BIDANG CSR -->\n            <span class=\"h_lable\">Sub Bidang CSR</span>\n            <q-select v-model=\"form.bidang_sub_csr_id\" :options=\"list_sub_bidang\" option-value=\"id\"\n              option-label=\"uraian\" emit-value map-options outlined square dense class=\"bg-white margin_btn\" />\n\n            <!-- NAMA CSR -->\n            <span class=\"h_lable\">Nama CSR</span>\n            <q-input v-model=\"form.nama_csr\" outlined square :dense=\"true\" class=\"bg-white margin_btn\" />\n\n            <!-- DESKRIPSI CSR -->\n            <span class=\"h_lable\">Deskripsi / Keterangan CSR</span>\n            <q-input v-model=\"form.deskripsi\" type=\"textarea\" outlined square :dense=\"true\"\n              class=\"bg-white margin_btn\" />\n\n            <!-- JUMLAH KEBUTUHAN -->\n            <div class=\"row q-col-gutter-md\">\n              <div class=\"col-4\">\n                <span class=\"h_lable\">Jumlah</span>\n                <q-input v-model=\"form.jumlah\" type=\"number\" outlined square :dense=\"true\"\n                  class=\"bg-white margin_btn\" />\n              </div>\n              <div class=\"col-4\">\n                <span class=\"h_lable\">Satuan</span>\n                <q-input v-model=\"form.satuan\" outlined square :dense=\"true\" class=\"bg-white margin_btn\" />\n              </div>\n              <div class=\"col-4\">\n                <span class=\"h_lable\">Nilai Perkiraan</span>\n                <q-input v-model=\"form.nilai\" type=\"number\" outlined square :dense=\"true\" class=\"bg-white margin_btn\" />\n              </div>\n            </div>\n\n            <!-- TANGGAL MULAI & SELESAI -->\n            <div class=\"row q-col-gutter-md\">\n              <div class=\"col-6\">\n                <span class=\"h_lable\">Tanggal Mulai</span>\n                <q-input v-model=\"form.tanggal_mulai\" type=\"date\" outlined square :dense=\"true\"\n                  class=\"bg-white margin_btn\" />\n              </div>\n              <div class=\"col-6\">\n                <span class=\"h_lable\">Tanggal Selesai</span>\n                <q-input v-model=\"form.tanggal_selesai\" type=\"date\" outlined square :dense=\"true\"\n                  class=\"bg-white margin_btn\" />\n              </div>\n            </div>\n\n            <!-- KECAMATAN -->\n            <span class=\"h_lable\">Kecamatan</span>\n            <q-select v-model=\"form.kecamatan_id\" :options=\"list_kecamatan\" option-value=\"kecamatan_id\"\n              option-label=\"nama_kecamatan\" emit-value map-options outlined square dense use-input fill-input\n              hide-selected input-debounce=\"0\" @filter=\"filterKecamatan\" class=\"bg-white margin_btn\" @input=\"getDesa\" />\n\n            <!-- DESA -->\n            <span class=\"h_lable\">Desa</span>\n            <q-select v-model=\"form.desa_id\" :options=\"list_desa\" option-value=\"des_kel_id\" option-label=\"nama_des_kel\"\n              emit-value map-options outlined square dense use-input fill-input hide-selected input-debounce=\"0\"\n              @filter=\"filterDesa\" class=\"bg-white margin_btn\" />\n\n\n            <!-- ALAMAT -->\n            <span class=\"h_lable\">Alamat Lengkap</span>\n            <q-input v-model=\"form.alamat\" type=\"textarea\" outlined square :dense=\"true\" class=\"bg-white margin_btn\" />\n\n            <!-- FILE UPLOAD -->\n            <span class=\"h_lable\">Lampiran File</span>\n            <q-file v-model=\"form.file\" label=\"Pilih File\" outlined square dense class=\"bg-white margin_btn\" />\n\n\n            <hr class=\"hrpagin2\">\n\n          </q-card-section>\n\n          <q-card-actions class=\"bg-grey-4 mdl-footer\" align=\"right\">\n            <q-btn :loading=\"btn_add\" color=\"primary\" type=\"submit\" label=\"Simpan\" />\n            <q-btn label=\"Batal\" color=\"negative\" v-close-popup />\n          </q-card-actions>\n        </form>\n      </q-card>\n    </q-dialog>\n    <!-- ===================== MODAL ADD KEGIATAN CSR ===================== -->\n\n    <!-- ===================== MODAL EDIT KEGIATAN CSR ===================== -->\n    <q-dialog v-model=\"mdl_edit\" persistent>\n      <q-card class=\"mdl-md\">\n        <q-card-section class=\"main2 text-white\">\n          <div class=\"text-h6 h_modalhead\">Edit Kegiatan CSR</div>\n        </q-card-section>\n\n        <form @submit.prevent=\"editData()\">\n\n          <q-card-section class=\"q-pt-none\">\n\n            <hr class=\"hrpagin2\">\n\n            <!-- BIDANG CSR -->\n            <span class=\"h_lable\">Bidang CSR</span>\n            <q-select v-model=\"form.bidang_csr_id\" :options=\"list_bidang\" option-value=\"id\" option-label=\"uraian\"\n              emit-value map-options outlined square dense class=\"bg-white margin_btn\" @input=\"getSubBidang\" />\n\n            <!-- SUB BIDANG CSR -->\n            <span class=\"h_lable\">Sub Bidang CSR</span>\n            <q-select v-model=\"form.bidang_sub_csr_id\" :options=\"list_sub_bidang\" option-value=\"id\"\n              option-label=\"uraian\" emit-value map-options outlined square dense class=\"bg-white margin_btn\" />\n\n            <!-- NAMA CSR -->\n            <span class=\"h_lable\">Nama CSR</span>\n            <q-input v-model=\"form.nama_csr\" outlined square :dense=\"true\" class=\"bg-white margin_btn\" />\n\n            <!-- DESKRIPSI CSR -->\n            <span class=\"h_lable\">Deskripsi / Keterangan CSR</span>\n            <q-input v-model=\"form.deskripsi\" type=\"textarea\" outlined square :dense=\"true\"\n              class=\"bg-white margin_btn\" />\n\n            <!-- JUMLAH KEBUTUHAN -->\n            <div class=\"row q-col-gutter-md\">\n              <div class=\"col-4\">\n                <span class=\"h_lable\">Jumlah</span>\n                <q-input v-model=\"form.jumlah\" type=\"number\" outlined square :dense=\"true\"\n                  class=\"bg-white margin_btn\" />\n              </div>\n              <div class=\"col-4\">\n                <span class=\"h_lable\">Satuan</span>\n                <q-input v-model=\"form.satuan\" outlined square :dense=\"true\" class=\"bg-white margin_btn\" />\n              </div>\n              <div class=\"col-4\">\n                <span class=\"h_lable\">Nilai Perkiraan</span>\n                <q-input v-model=\"form.nilai\" type=\"number\" outlined square :dense=\"true\" class=\"bg-white margin_btn\" />\n              </div>\n            </div>\n\n            <!-- TANGGAL MULAI & SELESAI -->\n            <div class=\"row q-col-gutter-md\">\n              <div class=\"col-6\">\n                <span class=\"h_lable\">Tanggal Mulai</span>\n                <q-input v-model=\"form.tanggal_mulai\" type=\"date\" outlined square :dense=\"true\"\n                  class=\"bg-white margin_btn\" />\n              </div>\n              <div class=\"col-6\">\n                <span class=\"h_lable\">Tanggal Selesai</span>\n                <q-input v-model=\"form.tanggal_selesai\" type=\"date\" outlined square :dense=\"true\"\n                  class=\"bg-white margin_btn\" />\n              </div>\n            </div>\n\n            <!-- KECAMATAN -->\n            <span class=\"h_lable\">Kecamatan</span>\n            <q-select v-model=\"form.kecamatan_id\" :options=\"list_kecamatan\" option-value=\"kecamatan_id\"\n              option-label=\"nama_kecamatan\" emit-value map-options outlined square dense use-input fill-input\n              hide-selected input-debounce=\"0\" @filter=\"filterKecamatan\" class=\"bg-white margin_btn\" @input=\"getDesa\" />\n\n            <!-- DESA -->\n            <span class=\"h_lable\">Desa</span>\n            <q-select v-model=\"form.desa_id\" :options=\"list_desa\" option-value=\"des_kel_id\" option-label=\"nama_des_kel\"\n              emit-value map-options outlined square dense use-input fill-input hide-selected input-debounce=\"0\"\n              class=\"bg-white margin_btn\" />\n\n            <!-- ALAMAT -->\n            <span class=\"h_lable\">Alamat Lengkap</span>\n            <q-input v-model=\"form.alamat\" type=\"textarea\" outlined square :dense=\"true\" class=\"bg-white margin_btn\" />\n\n            <!-- FILE UPLOAD -->\n            <span class=\"h_lable\">Lampiran File</span>\n            <q-file v-model=\"form.file\" label=\"Pilih File\" outlined square dense class=\"bg-white margin_btn\" />\n\n            <hr class=\"hrpagin2\">\n          </q-card-section>\n\n          <q-card-actions class=\"bg-grey-4 mdl-footer\" align=\"right\">\n            <q-btn color=\"primary\" type=\"submit\" label=\"Simpan Perubahan\" />\n            <q-btn label=\"Batal\" color=\"negative\" v-close-popup />\n          </q-card-actions>\n        </form>\n      </q-card>\n    </q-dialog>\n    <!-- ===================== MODAL EDIT KEGIATAN CSR ===================== -->\n\n\n    <!-- ===================== MODAL LIHAT DETIL KEGIATAN CSR ===================== -->\n    <q-dialog v-model=\"mdl_lihat\" persistent>\n      <q-card class=\"mdl-md\">\n\n        <!-- Header -->\n        <q-card-section class=\"main2 text-white flex items-center\">\n          <q-icon name=\"visibility\" size=\"md\" class=\"q-mr-sm\" />\n          <div class=\"text-h6\">Detil Kegiatan CSR</div>\n        </q-card-section>\n\n        <q-separator />\n\n        <!-- Body -->\n        <q-card-section class=\"q-gutter-md\">\n\n          <!-- Lampiran File -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">📂 Lampiran File</div>\n            <div v-if=\"selectedItem.file_name\">\n              <q-img :src=\"file_path + selectedItem.file_name\" spinner-color=\"primary\"\n                style=\"max-height: 400px; cursor: pointer; border: 1px solid #ddd; border-radius: 6px;\"\n                @click=\"downloadFile(selectedItem.file_name)\" />\n            </div>\n            <div v-else>\n              <span class=\"text-grey\">Tidak ada file</span>\n            </div>\n          </div>\n\n          <!-- Informasi Program -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">📌 Informasi Program</div>\n            <q-list dense bordered separator class=\"rounded-borders\">\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Bidang</b></q-item-section>\n                <q-item-section>{{ selectedItem.uraian_bidang_csr }}</q-item-section>\n              </q-item>\n              <q-item v-if=\"selectedItem.uraian_bidang_sub_csr\">\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Sub Bidang</b></q-item-section>\n                <q-item-section>{{ selectedItem.uraian_bidang_sub_csr }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Nama CSR</b></q-item-section>\n                <q-item-section>{{ selectedItem.nama_csr }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Jumlah Kebutuhan / Nilai</b></q-item-section>\n                <q-item-section>\n                  {{ selectedItem.jumlah }} {{ selectedItem.satuan }} -\n                  Rp {{ Number(selectedItem.nilai).toLocaleString('id-ID') }} / {{ selectedItem.satuan }}\n                </q-item-section>\n              </q-item>\n            </q-list>\n          </div>\n\n          <!-- Pelaksanaan Program -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">🗓️ Pelaksanaan Program</div>\n            <q-list dense bordered separator class=\"rounded-borders\">\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Tanggal Mulai</b></q-item-section>\n                <q-item-section>{{ UMUM.tglConvert(selectedItem.tanggal_mulai) }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Tanggal Selesai</b></q-item-section>\n                <q-item-section>{{ UMUM.tglConvert(selectedItem.tanggal_selesai) }}</q-item-section>\n              </q-item>\n            </q-list>\n          </div>\n\n          <!-- Status Program -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">📊 Status Program</div>\n            <q-list dense bordered separator class=\"rounded-borders\">\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Status</b></q-item-section>\n                <q-item-section>\n                  <q-badge v-if=\"selectedItem.status == 1\" color=\"orange\" label=\"Program CSR Baru\" />\n                  <q-badge v-else-if=\"selectedItem.status == 2\" color=\"yellow\" text-color=\"black\"\n                    label=\"Dalam Pengerjaan\" />\n                  <q-badge v-else-if=\"selectedItem.status == 3\" color=\"blue-grey-8\" text-color=\"white\"\n                    label=\"Pengerjaan Sebagian\" />\n                  <q-badge v-else-if=\"selectedItem.status == 4\" color=\"light-blue-9\" text-color=\"white\"\n                    label=\"Selesai\" />\n                </q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Total</b></q-item-section>\n                <q-item-section>{{ selectedItem.jumlah }} {{ selectedItem.satuan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Terambil</b></q-item-section>\n                <q-item-section>{{ (selectedItem.jumlah - selectedItem.jumlah_sisa) }} {{ selectedItem.satuan\n                  }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Tersedia</b></q-item-section>\n                <q-item-section>\n                  {{ selectedItem.jumlah_sisa }} {{ selectedItem.satuan }}\n                </q-item-section>\n              </q-item>\n            </q-list>\n          </div>\n\n\n          <!-- Deskripsi -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">📝 Deskripsi Program</div>\n            <q-card flat bordered class=\"q-pa-sm text-grey-9\">\n              {{ selectedItem.deskripsi || 'Tidak ada deskripsi' }}\n            </q-card>\n          </div>\n\n          <!-- Alamat -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">📍 Lokasi Program</div>\n            <q-list dense bordered separator class=\"rounded-borders\">\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Kecamatan</b></q-item-section>\n                <q-item-section>{{ selectedItem.nama_kecamatan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Desa</b></q-item-section>\n                <q-item-section>{{ selectedItem.nama_desa }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Alamat</b></q-item-section>\n                <q-item-section>{{ selectedItem.alamat }}</q-item-section>\n              </q-item>\n            </q-list>\n          </div>\n\n        </q-card-section>\n\n        <!-- Footer -->\n        <q-separator />\n        <q-card-actions class=\"bg-grey-3\" align=\"right\">\n          <q-btn label=\"Tutup\" color=\"negative\" v-close-popup />\n        </q-card-actions>\n      </q-card>\n    </q-dialog>\n    <!-- ===================== MODAL LIHAT DETIL KEGIATAN CSR ===================== -->\n\n\n\n\n    <q-dialog v-model=\"mdlAmbil\" persistent>\n      <q-card class=\"mdl-md\">\n\n        <!-- Header -->\n        <q-card-section class=\"bg-amber text-white flex items-center\">\n          <q-icon name=\"gavel\" size=\"md\" class=\"q-mr-sm\" />\n          <div class=\"text-h6\">Ambil Program CSR</div>\n        </q-card-section>\n\n        <q-separator />\n\n        <!-- Konten -->\n        <q-card-section class=\"q-gutter-md\">\n\n          <!-- Info Program -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">📌 Informasi Program</div>\n            <q-list dense bordered separator class=\"rounded-borders\">\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"> <b>Nama</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ selectedProgram.nama_csr }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Bidang</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ selectedProgram.uraian_bidang_csr }}</q-item-section>\n              </q-item>\n              <q-item v-if=\"selectedProgram.uraian_bidang_sub_csr\">\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Sub Bidang</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ selectedProgram.uraian_bidang_sub_csr }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Jumlah Tersedia</b></q-item-section>\n                <q-item-section>\n                  <q-badge color=\"amber\" text-color=\"black\"\n                    :label=\"selectedProgram.jumlah_sisa + ' ' + selectedProgram.satuan\" />\n                </q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Jumlah Total</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ selectedProgram.jumlah }} {{ selectedProgram.satuan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Nilai Program</b></q-item-section>\n                <q-item-section class=\"col-9\">Rp {{ Number(selectedProgram.nilai).toLocaleString('id-ID') }} / {{\n              selectedProgram.satuan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Tanggal Mulai</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ UMUM.tglConvert(selectedProgram.tanggal_mulai) }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Tanggal Selesai</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ UMUM.tglConvert(selectedProgram.tanggal_selesai) }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Alamat</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ selectedProgram.alamat }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Kecamatan</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ selectedProgram.nama_kecamatan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Desa</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ selectedProgram.nama_desa }}</q-item-section>\n              </q-item>\n            </q-list>\n          </div>\n\n\n          <!-- Info Mitra -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">🏢 Informasi Perusahaan</div>\n            <q-list dense bordered separator class=\"rounded-borders\">\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Nama Perusahaan</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ mitra.nama_perusahaan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Email Perusahaan</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ mitra.email_perusahaan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Telp Perusahaan</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ mitra.telp_perusahaan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Alamat Perusahaan</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ mitra.alamat_perusahaan }}</q-item-section>\n              </q-item>\n            </q-list>\n\n            <q-separator spaced />\n\n            <div class=\"text-subtitle2 text-bold q-mb-sm\">👤 Penanggung Jawab</div>\n            <q-list dense bordered separator class=\"rounded-borders\">\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Nama</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ mitra.nama_pj }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Jabatan</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ mitra.jabatan }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>Email</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ mitra.email_pj }}</q-item-section>\n              </q-item>\n              <q-item>\n                <q-item-section class=\"col-3 text-weight-medium\"><b>No Hp</b></q-item-section>\n                <q-item-section class=\"col-9\">{{ mitra.hp_pj }}</q-item-section>\n              </q-item>\n            </q-list>\n          </div>\n\n          <!-- Ambil Program -->\n          <div>\n            <div class=\"text-subtitle1 text-bold q-mb-sm\">⚖️ Jumlah Pnegambilan CSR</div>\n            <q-toggle v-model=\"ambilSemua\" label=\"Mengambil Seluruh Jumlah Kebutuhan CSR\" color=\"amber\"\n              @update:model-value=\"onToggleSemua\" />\n            <q-input v-model.number=\"jumlahAmbil\" type=\"number\" outlined dense class=\"q-mt-sm\"\n              label=\"Jumlah yang ingin diambil\" :disable=\"ambilSemua\" :max=\"selectedProgram.jumlah_sisa\" :rules=\"[\n              val => val > 0 || 'Minimal 1',\n              val => val <= selectedProgram.jumlah_sisa || 'Tidak boleh lebih dari sisa'\n            ]\" />\n\n            <!-- Catatan -->\n            <q-input v-model=\"catatanAmbil\" type=\"textarea\" outlined autogrow class=\"q-mt-md\"\n              label=\"Catatan (opsional)\" />\n          </div>\n\n        </q-card-section>\n\n        <q-separator />\n\n        <!-- Actions -->\n        <q-card-actions align=\"right\" class=\"q-pa-md\">\n          <q-btn label=\"Batal\" color=\"negative\" v-close-popup />\n          <q-btn label=\"Kirim Pengajuan\" color=\"amber\" text-color=\"white\" @click=\"submitAmbil\" glossy />\n        </q-card-actions>\n      </q-card>\n    </q-dialog>\n\n\n    <!-- ================================================ MODAL HAPUS ================================================ -->\n    <q-dialog v-model=\"mdl_delete\" persistent>\n      <q-card class=\"mdl-sm \">\n        <q-card-section class=\"q-pt-none text-center orageGrad\">\n          <form @submit.prevent=\"removeData\">\n            <br>\n            <img src=\"img/alert.png\" alt=\"\" width=\"75\"> <br>\n            <span class=\"h_notifikasi\">APAKAH ANDA YAKIN INGIN MENGHAPUS DATA INI??</span>\n            <input type=\"submit\" style=\"position: absolute; left: -9999px\" />\n            <br>\n            <br>\n\n            <q-btn label=\"Batal\" size=\"sm\" color=\"negative\" v-close-popup />\n            &nbsp;\n            <q-btn type=\"submit\" label=\"Hapus\" size=\"sm\" color=\"primary\" v-close-popup />\n\n          </form>\n        </q-card-section>\n      </q-card>\n    </q-dialog>\n\n    <!-- ================================================ MODAL HAPUS ================================================ -->\n\n\n\n\n\n\n  </div>\n</template>\n\n\n<script>\n\nimport UMUM from \"../../library/umum.js\";\nexport default {\n  data() {\n    return {\n      UMUM: UMUM,\n      btn_add: false,\n      status: 4,\n      mdl_add: false,\n      mdl_edit: false,\n      mdl_delete: false,\n      alert: false,\n      simpan1: false,\n      mdl_lihat: false,\n      selectedItem: {},\n      cari_value: \"\",\n      page_first: 1,\n      page_last: 1,\n      page_limit: 9,\n      total: 0,\n      mdlAmbil: false,\n      selectedProgram: {},\n      jumlahAmbil: 0,\n      mitra: {},\n      ambilSemua: false,\n      catatanAmbil: '',\n\n      tipe: null, // simpan tipe user\n\n\n      form: {\n        bidang_csr_id: null,\n        bidang_sub_csr_id: null,\n        nama_csr: \"\",\n        deskripsi: \"\",\n        jumlah: null,\n        satuan: \"\",\n        nilai: null,\n        tanggal_mulai: \"\",\n        tanggal_selesai: \"\",\n        kecamatan_id: null,\n        desa_id: null,\n        alamat: \"\",\n        file_name: null  // 🔹 untuk file upload\n      },\n\n      mitra: {\n        nama_perusahaan: '',\n        email_perusahaan: '',\n        telp_perusahaan: '',\n        alamat_perusahaan: '',\n        nama_pj: '',\n        jabatan: '',\n        email_pj: '',\n        hp_pj: ''\n      },\n      list_bidang: [],\n      list_sub_bidang: [],\n      list_kecamatan: [],\n      list_kecamatan_master: [], // simpan data asli\n      list_desa: [],\n      list_desa_master: [],\n      listCSR: [],\n      file_path: this.$store.state.url.URL_APP + \"uploads/\",\n\n\n      filterku: {\n        kecamatan_id: \"\",\n        desa_id: \"\",\n        bidang_csr_id: \"\",\n        bidang_sub_csr_id: \"\",\n        status: \"\"\n      },\n\n\n      list_bidang_filter: [],\n      list_sub_bidang_filter: [],\n\n      // hasil data yang difilter\n      dataView: [],\n\n      list_kecamatan_filter: [],\n      list_desa_filter: [],\n\n      statusOptions: [\n        { label: 'Semua Status', value: '' },\n        { label: 'Program CSR Baru', value: 1 },\n        { label: 'Dalam Pengerjaan', value: 2 },\n        { label: 'Pengerjaan Sebagian', value: 3 },\n        { label: 'Selesai', value: 4 }\n      ],\n\n      kecamatanOptions: [],\n      bidangOptions: [] // <- ubah dari computed ke data\n\n    }\n\n\n  },\n\n\n  methods: {\n\n    ambilProgram(item) {\n      this.selectedProgram = item\n      this.ambilSemua = false\n      this.jumlahAmbil = item.jumlah_sisa\n      this.catatanAmbil = `Kami akan mengambil program CSR ${item.nama_csr}, mohon untuk segera ditindaklanjuti. Terima kasih.`\n      this.mdlAmbil = true\n\n      // ambil userId dari localStorage\n      const profile = JSON.parse(localStorage.profile)\n      const userId = profile._id\n\n      // panggil fungsi getMitra\n      this.getMitra(userId)\n    },\n    onToggleSemua(val) {\n      if (val) {\n        // toggle ON → pakai semua jumlah sisa\n        this.jumlahAmbil = this.selectedProgram.jumlah_sisa\n      }\n      // kalau toggle OFF → biarkan jumlahAmbil tetap ada nilainya,\n      // user bisa mengedit manual di input\n    },\n\n    onChangeDesa(val) {\n      this.filterku.desa_id = val;\n      this.getView(); // refresh data sesuai filter\n    },\n\n    onStatusChange(val) {\n      this.getView()\n    },\n\n\n    onChangeBidang(val) {\n      this.filterku.bidang_sub_csr_id = \"\"; // reset sub-bidang\n      this.getSubBidangFilter(val);\n      this.getView(); // refresh data\n    },\n\n    formatRupiah(value) {\n      if (value == null) return \"-\";\n      return new Intl.NumberFormat('id-ID', {\n        style: 'currency',\n        currency: 'IDR',\n        minimumFractionDigits: 0,\n        maximumFractionDigits: 0\n      }).format(value);\n    },\n\n    onItemClick(item, action) {\n      this.selectedItem = item;\n\n      if (action === \"edit\") {\n        this.openEditModal(item); // buka modal edit dan isi form\n      } else if (action === \"lihat\") {\n        this.mdl_lihat = true; // buka modal lihat detail\n      } else if (action === \"delete\") {\n        this.form.id = item.id;  // <--- ini penting\n        this.mdl_delete = true; // buka modal delete\n      }\n\n    },\n    downloadFile(fileName) {\n      if (fileName) {\n        window.open(this.file_path + fileName, \"_blank\");\n      }\n    },\n\n    getBidang() {\n      fetch(this.$store.state.url.URL_DM_BID + \"bidang\", {\n        headers: {\n          authorization: \"kikensbatara \" + localStorage.token\n        }\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.list_bidang = res_data\n        })\n    },\n    getMitra(userId) {\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"mitra/\" + userId, {\n        method: \"GET\",\n        headers: {\n          authorization: \"kikensbatara \" + localStorage.token\n        }\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          if (res_data.success) {\n            this.mitra = res_data.data\n          } else {\n            this.Notify(\"Gagal mengambil data mitra\", \"negative\", \"error_outline\")\n          }\n        })\n        .catch(err => {\n          console.error(\"❌ Error:\", err)\n          this.Notify(\"Terjadi kesalahan server\", \"negative\", \"error_outline\")\n        })\n    },\n\n    submitAmbil() {\n      if (!this.jumlahAmbil || this.jumlahAmbil <= 0) {\n        this.Notify(\"Jumlah yang diambil harus lebih dari 0\", \"negative\", \"error_outline\");\n        return;\n      }\n\n      const profile = JSON.parse(localStorage.profile);\n\n      const payload = {\n        kegiatan_id: this.selectedProgram.id,\n        perusahaan_id: profile._id, // ambil user login\n        jumlah_ambil: this.jumlahAmbil,\n        catatan_mitra: this.catatanAmbil\n      };\n\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"addPengajuan\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          authorization: \"kikensbatara \" + localStorage.token\n        },\n        body: JSON.stringify(payload)\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          if (res_data.success) {\n            this.Notify(\"Pengajuan berhasil dikirim\", \"primary\", \"check_circle_outline\");\n            this.mdlAmbil = false;\n            this.getView(); // refresh list\n          } else {\n            this.Notify(\"Gagal mengirim pengajuan\", \"negative\", \"error_outline\");\n          }\n        })\n        .catch(err => {\n          console.error(\"❌ Error:\", err);\n          this.Notify(\"Terjadi kesalahan server\", \"negative\", \"error_outline\");\n        });\n    },\n\n    getSubBidang() {\n      // reset sub bidang dulu biar tidak nempel\n      this.form.bidang_sub_csr_id = null\n      this.list_sub_bidang = []\n\n      if (!this.form.bidang_csr_id) {\n        return\n      }\n\n      fetch(this.$store.state.url.URL_DM_BID + \"sub_bidang\", {\n        method: \"POST\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"kikensbatara \" + localStorage.token\n        },\n        body: JSON.stringify({\n          bidang_csr_id: this.form.bidang_csr_id\n        })\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.list_sub_bidang = res_data\n        })\n    },\n\n    getKecamatan() {\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"kecamatan\", {\n        method: \"GET\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"kikensbatara \" + localStorage.token\n        }\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.list_kecamatan = res_data\n          this.list_kecamatan_master = res_data // simpan untuk filter\n        })\n    },\n\n    filterKecamatan(val, update) {\n      if (val === '') {\n        update(() => {\n          this.list_kecamatan = this.list_kecamatan_master\n        })\n        return\n      }\n\n      update(() => {\n        const needle = val.toLowerCase()\n        this.list_kecamatan = this.list_kecamatan_master.filter(v =>\n          v.nama_kecamatan.toLowerCase().includes(needle)\n        )\n      })\n    },\n\n    getDesa() {\n      this.form.desa_id = null\n      this.list_desa = []\n      this.list_desa_master = []\n\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"desa\", {\n        method: \"POST\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"kikensbatara \" + localStorage.token\n        },\n        body: JSON.stringify({\n          kecamatan_id: this.form.kecamatan_id   // 🔥 ini yang benar\n        })\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.list_desa = res_data;\n          this.list_desa_master = res_data\n        });\n    },\n\n    filterDesa(val, update) {\n      if (val === '') {\n        update(() => {\n          this.list_desa = this.list_desa_master\n        })\n        return\n      }\n\n      update(() => {\n        const needle = val.toLowerCase()\n        this.list_desa = this.list_desa_master.filter(v =>\n          v.nama_des_kel.toLowerCase().includes(needle)\n        )\n      })\n    },\n\n\n    addData() {\n      this.btn_add = true;\n\n      const formData = new FormData();\n      for (let key in this.form) {\n        if (key === \"file\" && this.form.file) {\n          formData.append(\"file\", this.form.file); // field 'file' sesuai backend\n        } else {\n          formData.append(key, this.form[key]);\n        }\n      }\n\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"addData\", {\n        method: \"POST\",\n        headers: {\n          authorization: \"kikensbatara \" + localStorage.token\n        },\n        body: formData\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.btn_add = false;\n          if (res_data.success) {\n            this.Notify(\"Sukses Menambah Data\", \"primary\", \"check_circle_outline\");\n            this.getView();\n            this.mdl_add = false;\n            this.resetForm();\n          } else {\n            this.Notify(\"Gagal Menambah Data\", \"negative\", \"error_outline\");\n          }\n        })\n        .catch(err => {\n          this.btn_add = false;\n          console.error(\"❌ Error:\", err);\n          this.Notify(\"Terjadi kesalahan server\", \"negative\", \"error_outline\");\n        });\n    },\n    resetForm() {\n      this.form = {\n        bidang_csr_id: null,\n        bidang_sub_csr_id: null,\n        nama_csr: \"\",\n        deskripsi: \"\",\n        jumlah: null,\n        satuan: \"\",\n        nilai: null,\n        tanggal_mulai: \"\",\n        tanggal_selesai: \"\",\n        kecamatan_id: null,\n        desa_id: null,\n        alamat: \"\"\n      }\n    },\n\n    // ambil data utama\n    getView() {\n      this.$store.commit(\"shoWLoading\")\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"viewData\", {\n        method: \"POST\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"kikensbatara \" + localStorage.token\n        },\n        body: JSON.stringify({\n          ...this.filterku,       // kirim semua filter\n          data_ke: this.page_first,\n          cari_value: this.cari_value,\n          page_limit: this.page_limit\n        })\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.dataView = res_data.data\n          this.total = res_data.total;\n          this.page_last = Math.ceil(this.total / this.page_limit);\n          this.$store.commit(\"hideLoading\")\n        })\n        .catch(err => {\n          console.error(\"❌ Error getView:\", err)\n          this.$store.commit(\"hideLoading\")\n        })\n    },\n\n    removeData: function () {\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"removeData\", {\n        method: \"POST\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"kikensbatara \" + localStorage.token\n        },\n        body: JSON.stringify({ id: this.form.id })\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          if (res_data.success) {\n            this.Notify('Sukses Menghapus Data', 'negative', 'check_circle_outline');\n            this.getView();\n          } else {\n            this.Notify('Gagal Menghapus Data', 'warning', 'error');\n          }\n        })\n        .catch(err => {\n          this.Notify('Error: ' + err.message, 'warning', 'error');\n        });\n    },\n\n\n    getBidangFilter() {\n      fetch(this.$store.state.url.URL_DM_BID + \"bidang\", {\n        headers: {\n          authorization: \"kikensbatara \" + localStorage.token\n        }\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.bidangOptions = [\n            { id: \"\", uraian: \"-- SEMUA BIDANG --\" },\n            ...res_data.map(b => ({\n              ...b,\n              id: b.id.toString()  // pastikan tipe sama dengan v-model\n            }))\n          ];\n        })\n    },\n\n    getSubBidangFilter() {\n      this.filterku.bidang_sub_csr_id = null\n      this.list_sub_bidang_filter = []\n\n      if (!this.filterku.bidang_csr_id) return\n\n      fetch(this.$store.state.url.URL_DM_BID + \"sub_bidang\", {\n        method: \"POST\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"kikensbatara \" + localStorage.token\n        },\n        body: JSON.stringify({\n          bidang_csr_id: this.filterku.bidang_csr_id\n        })\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.list_sub_bidang_filter = res_data\n        })\n    },\n\n    getKecamatanFilter() {\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"kecamatan\", {\n        headers: {\n          authorization: \"kikensbatara \" + localStorage.token\n        }\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.kecamatanOptions = [\n            { kecamatan_id: \"\", nama_kecamatan: \"-- SEMUA KECAMATAN --\" },\n            ...res_data.map(k => ({\n              ...k,\n              kecamatan_id: k.kecamatan_id.toString()\n            }))\n          ];\n        })\n        .catch(err => console.error(\"❌ Error fetch kecamatan:\", err));\n    },\n\n\n    // Saat pilih kecamatan\n    onChangeKecamatanFilter(val) {\n      this.filterku.kecamatan_id = val; // pastikan v-model tersinkronisasi\n      this.filterku.desa_id = \"\";\n      this.getDesaFilter();\n      this.getView(); // jika ingin otomatis reload data\n    },\n\n    // Ambil desa sesuai kecamatan\n    getDesaFilter() {\n      if (!this.filterku.kecamatan_id) {\n        this.list_desa_filter = []\n        return\n      }\n\n      fetch(this.$store.state.url.KEGIATAN_CSR + \"desa\", {\n        method: \"POST\",\n        headers: {\n          \"content-type\": \"application/json\",\n          authorization: \"kikensbatara \" + localStorage.token\n        },\n        body: JSON.stringify({\n          kecamatan_id: this.filterku.kecamatan_id\n        })\n      })\n        .then(res => res.json())\n        .then(res_data => {\n          this.list_desa_filter = res_data\n        })\n        .catch(err => {\n          console.error(\"Error fetch desa:\", err) // 🔥 log error\n        })\n    },\n\n\n\n\n\n    simulateProgress(number) {\n      // we set loading state\n      this[`simpan${number}`] = true\n      // simulate a delay\n      setTimeout(() => {\n        // we're done, we reset loading state\n        this[`simpan${number}`] = false\n      }, 3000)\n    },\n\n    Notify: function (message, positive, icon) {\n      this.$q.notify({\n        message: message,\n        color: positive,\n        icon: icon,\n        position: 'top',\n        timeout: 500,\n      })\n    },\n\n    // cari_data() {\n\n    //     this.getView(); // refresh data sesuai input pencarian\n    //   },\n    btn_prev() {\n      if (this.page_first > 1) this.page_first--;\n      this.getView();\n    },\n\n    btn_next() {\n      if (this.page_first < this.page_last) this.page_first++;\n      this.getView();\n    },\n\n    cari_data() {\n      this.page_first = 1;\n      this.getView();\n    },\n\n    indexing(index) {\n      return ((this.page_first - 1) * this.page_limit) + index;\n    },\n\n    openEditModal(item) {\n      this.selectedItem = item;\n\n      // set form\n      this.form = { ...item };\n\n      // isi sub-bidang sesuai bidang\n      if (this.form.bidang_csr_id) {\n        this.getSubBidang(this.form.bidang_csr_id);\n      }\n\n      // buka modal\n      this.mdl_edit = true;\n    }\n\n\n\n  },\n  mounted() {\n\n    const get_profile = JSON.parse(localStorage.profile);\n    this.tipe = Number(get_profile.profile.db_csrkonsel); // ambil db_csrkonsel\n\n\n    // simpan data mitra (kalau yang login memang mitra)\n    this.mitra = {\n      id: get_profile._id,\n      nama: get_profile.profile.nama,\n      username: get_profile.username\n    }\n\n\n    // jalankan ketika halaman pertama kali dibuka\n    this.getView();\n    this.getKecamatan();\n    this.getDesa();\n    this.getKecamatanFilter();\n    // this.getDesaFilter();\n    this.getBidang();\n    this.getSubBidang();\n    this.getBidangFilter();\n    // this.getSubBidangFilter();\n  }\n}\n</script>\n"]}]}