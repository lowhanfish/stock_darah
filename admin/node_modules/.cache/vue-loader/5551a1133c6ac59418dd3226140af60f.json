{"remainingRequest":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/simplephi/Documents/riswan/stock_darah/admin/src/views/informasi/jadwal_donor.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/src/views/informasi/jadwal_donor.vue","mtime":1761487773259},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/cache-loader/dist/cjs.js","mtime":1758930418112},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/babel-loader/lib/index.js","mtime":1758930419036},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/vue-cli-plugin-quasar/lib/loader.auto-import.js","mtime":1758930412679},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/cache-loader/dist/cjs.js","mtime":1758930418112},{"path":"/Users/simplephi/Documents/riswan/stock_darah/admin/node_modules/vue-loader/lib/index.js","mtime":1758930412640}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBVTVVNIGZyb20gIi4uLy4uL2xpYnJhcnkvdW11bS5qcyI7CgpleHBvcnQgZGVmYXVsdCB7CiAgICBkYXRhKCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIGxpc3RfZGF0YTogW10sCiAgICAgICAgICAgIGZvcm06IHsKICAgICAgICAgICAgICAgIG5hbWFfa2VnaWF0YW46ICcnLAogICAgICAgICAgICAgICAgdGFuZ2dhbF9tdWxhaTogJycsCiAgICAgICAgICAgICAgICB0YW5nZ2FsX3NlbGVzYWk6ICcnLAogICAgICAgICAgICAgICAgamFtOiAnJywKICAgICAgICAgICAgICAgIGxva2FzaTogJycsCiAgICAgICAgICAgICAgICBtYXBfbGluazogJycsCiAgICAgICAgICAgICAgICBrZXRlcmFuZ2FuOiAnJywKICAgICAgICAgICAgICAgIGZpbGVfbmFtZTogbnVsbCwKICAgICAgICAgICAgICAgIGp1bWxhaF90ZXJkYWZ0YXI6IG51bGwsCiAgICAgICAgICAgICAgICBzdGF0dXM6IDEgLy8gZGVmYXVsdCBha3RpZgogICAgICAgICAgICB9LAogICAgICAgICAgICBmaWxlQmFydTogbnVsbCwKICAgICAgICAgICAgVU1VTTogVU1VTSwKICAgICAgICAgICAgYnRuX2FkZDogZmFsc2UsCiAgICAgICAgICAgIGJ0bl9lZGl0OiBmYWxzZSwKICAgICAgICAgICAgbWRsX2FkZDogZmFsc2UsCiAgICAgICAgICAgIG1kbF9lZGl0OiBmYWxzZSwKICAgICAgICAgICAgbWRsX2RlbGV0ZTogZmFsc2UsCiAgICAgICAgICAgIG1kbF9saWhhdDogZmFsc2UsCiAgICAgICAgICAgIG1kbF9pbWFnZTogZmFsc2UsCiAgICAgICAgICAgIG1kbF9wZXNlcnRhOiBmYWxzZSwKICAgICAgICAgICAgc2VsZWN0ZWRJbWFnZTogbnVsbCwKICAgICAgICAgICAgY2FyaV92YWx1ZTogIiIsCiAgICAgICAgICAgIHBhZ2VfZmlyc3Q6IDEsCiAgICAgICAgICAgIHBhZ2VfbGFzdDogMSwKICAgICAgICAgICAgcGFnZV9saW1pdDogOSwKICAgICAgICAgICAgdG90YWw6IDAsCiAgICAgICAgICAgIHRpcGU6IG51bGwsCiAgICAgICAgICAgIGZpbGVfcGF0aDogdGhpcy4kc3RvcmUuc3RhdGUudXJsLlVSTF9BUFAgKyAidXBsb2Fkcy8iLAogICAgICAgICAgICBzdGF0dXNPcHRpb25zOiBbCiAgICAgICAgICAgICAgICB7IGxhYmVsOiAnMSAtIEFrdGlmJywgdmFsdWU6IDEgfSwKICAgICAgICAgICAgICAgIHsgbGFiZWw6ICcyIC0gU2VsZXNhaScsIHZhbHVlOiAyIH0sCiAgICAgICAgICAgICAgICB7IGxhYmVsOiAnMyAtIERpYmF0YWxrYW4nLCB2YWx1ZTogMyB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIGN1cnJlbnRKYWR3YWw6IHt9LAogICAgICAgICAgICBwYXJ0aWNpcGFudHM6IFtdLAogICAgICAgICAgICBwYXJ0aWNpcGFudHNDb3VudDoge30sCiAgICAgICAgICAgIHBlbmRvbm9yRGFyYWhPcHRpb25zOiBbXSwKICAgICAgICAgICAgc2VsZWN0ZWRQZW5kb25vcjogbnVsbCwKICAgICAgICAgICAgYnRuX2FkZF9wZXNlcnRhOiBmYWxzZSwKICAgICAgICAgICAgc2VhcmNoSW5wdXQ6ICcnLAogICAgICAgIH0KICAgIH0sCgoKICAgIGNvbXB1dGVkOiB7CiAgICAgICAgYXZhaWxhYmxlT3B0aW9ucygpIHsKICAgICAgICAgICAgLy8gYnVhdCBzZXQgaWQgcGVzZXJ0YSAoc3RyaW5nKSB1bnR1ayBwZXJiYW5kaW5nYW4KICAgICAgICAgICAgY29uc3QgcGFydElkcyA9IG5ldyBTZXQoCiAgICAgICAgICAgICAgICAodGhpcy5wYXJ0aWNpcGFudHMgfHwgW10pCiAgICAgICAgICAgICAgICAgICAgLm1hcChwID0+IFN0cmluZyhwLnBlbmRvbm9yX2lkID8/IHAuaWQgPz8gcC51c2VyX2lkID8/IHAuaWRfcGVuZG9ub3IgPz8gJycpKQogICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoQm9vbGVhbikKICAgICAgICAgICAgKTsKCiAgICAgICAgICAgIC8vIG5vcm1hbGlzYXNpIHBlbmRvbm9yRGFyYWhPcHRpb25zIC0+IHBhc3Rpa2FuIGlkIHNlYmFnYWkgc3RyaW5nIGRhbiBhZGEgbGFiZWwKICAgICAgICAgICAgY29uc3Qgbm9ybWFsaXplZCA9ICh0aGlzLnBlbmRvbm9yRGFyYWhPcHRpb25zIHx8IFtdKS5tYXAob3B0ID0+IHsKICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgLi4ub3B0LAogICAgICAgICAgICAgICAgICAgIGlkOiBTdHJpbmcob3B0LmlkKSwKICAgICAgICAgICAgICAgICAgICBsYWJlbDogKG9wdC5sYWJlbCB8fCBgJHtvcHQubmFtYV9sZW5na2FwIHx8IG9wdC5uYW1hIHx8ICctJ30gLyAke29wdC5nb2xvbmdhbl9kYXJhaCB8fCAnJ30gJHtvcHQucmhlc3VzID8gb3B0LnJoZXN1cyA6ICcnfSAvICR7b3B0Lm5vX2hwIHx8ICctJ31gKS50cmltKCkKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy8gaGlsYW5na2FuIHlhbmcgc3VkYWggdGVyZGFmdGFyCiAgICAgICAgICAgIGxldCBhdmFpbGFibGUgPSBub3JtYWxpemVkLmZpbHRlcihvID0+ICFwYXJ0SWRzLmhhcyhTdHJpbmcoby5pZCkpKTsKCiAgICAgICAgICAgIC8vIGhhcHVzIGR1cGxpa2F0IGJlcmRhc2Fya2FuIGlkIChrZWFtYW5hbikKICAgICAgICAgICAgYXZhaWxhYmxlID0gYXZhaWxhYmxlLmZpbHRlcigoaXRlbSwgaWR4LCBhcnIpID0+IGFyci5maW5kSW5kZXgoeCA9PiB4LmlkID09PSBpdGVtLmlkKSA9PT0gaWR4KTsKCiAgICAgICAgICAgIC8vIHN1cHBvcnQgc2VhcmNoSW5wdXQgc2VwZXJ0aSBzZWJlbHVtbnlhCiAgICAgICAgICAgIGNvbnN0IGlucHV0ID0gU3RyaW5nKHRoaXMuc2VhcmNoSW5wdXQgfHwgJycpLnRvTG93ZXJDYXNlKCkudHJpbSgpOwogICAgICAgICAgICBpZiAoIWlucHV0KSB7CiAgICAgICAgICAgICAgICByZXR1cm4gYXZhaWxhYmxlLnNsaWNlKDAsIDgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiBhdmFpbGFibGUuZmlsdGVyKG9wdCA9PiAob3B0LmxhYmVsIHx8ICcnKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKGlucHV0KSk7CiAgICAgICAgfQogICAgfSwKCiAgICBtZXRob2RzOiB7CgogICAgICAgIHN0YXR1c0xhYmVsKHZhbCkgewogICAgICAgICAgICBpZiAodmFsID09IDEpIHJldHVybiAnQWt0aWYnCiAgICAgICAgICAgIGlmICh2YWwgPT0gMikgcmV0dXJuICdTZWxlc2FpJwogICAgICAgICAgICBpZiAodmFsID09IDMpIHJldHVybiAnRGliYXRhbGthbicKICAgICAgICAgICAgcmV0dXJuICctJwogICAgICAgIH0sCgogICAgICAgIHN0YXR1c0NvbG9yKHZhbCkgewogICAgICAgICAgICBpZiAodmFsID09IDEpIHJldHVybiAncG9zaXRpdmUnCiAgICAgICAgICAgIGlmICh2YWwgPT0gMikgcmV0dXJuICd3YXJuaW5nJwogICAgICAgICAgICBpZiAodmFsID09IDMpIHJldHVybiAnbmVnYXRpdmUnCiAgICAgICAgICAgIHJldHVybiAnZ3JleScKICAgICAgICB9LAoKICAgICAgICBvcGVuRWRpdChkYXRhKSB7CiAgICAgICAgICAgIHRoaXMuZm9ybSA9IHsKICAgICAgICAgICAgICAgIGlkOiBkYXRhLmlkIHx8IG51bGwsCiAgICAgICAgICAgICAgICBuYW1hX2tlZ2lhdGFuOiBkYXRhLm5hbWFfa2VnaWF0YW4gfHwgJycsCiAgICAgICAgICAgICAgICB0YW5nZ2FsX211bGFpOiBkYXRhLnRhbmdnYWxfbXVsYWkgfHwgJycsCiAgICAgICAgICAgICAgICB0YW5nZ2FsX3NlbGVzYWk6IGRhdGEudGFuZ2dhbF9zZWxlc2FpIHx8ICcnLAogICAgICAgICAgICAgICAgamFtOiBkYXRhLmphbSB8fCAnJywKICAgICAgICAgICAgICAgIGxva2FzaTogZGF0YS5sb2thc2kgfHwgJycsCiAgICAgICAgICAgICAgICBtYXBfbGluazogZGF0YS5tYXBfbGluayB8fCAnJywKICAgICAgICAgICAgICAgIGtldGVyYW5nYW46IGRhdGEua2V0ZXJhbmdhbiB8fCAnJywKICAgICAgICAgICAgICAgIGZpbGVfbmFtZTogZGF0YS5maWxlX25hbWUgfHwgbnVsbCwKICAgICAgICAgICAgICAgIGp1bWxhaF90ZXJkYWZ0YXI6IGRhdGEuanVtbGFoX3RlcmRhZnRhciA/PyBudWxsLAogICAgICAgICAgICAgICAgc3RhdHVzOiBkYXRhLnN0YXR1cyAhPSBudWxsID8gZGF0YS5zdGF0dXMgOiAxCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5maWxlQmFydSA9IG51bGwKICAgICAgICAgICAgdGhpcy5tZGxfZWRpdCA9IHRydWUKICAgICAgICB9LAoKCiAgICAgICAgb3BlbkRlbGV0ZShkYXRhKSB7CiAgICAgICAgICAgIHRoaXMuZm9ybSA9IHsgaWQ6IGRhdGEuaWQgfQogICAgICAgICAgICB0aGlzLm1kbF9kZWxldGUgPSB0cnVlCiAgICAgICAgfSwKCiAgICAgICAgb3BlbkxpaGF0KGRhdGEpIHsKICAgICAgICAgICAgdGhpcy5mb3JtID0gewogICAgICAgICAgICAgICAgaWQ6IGRhdGEuaWQgfHwgbnVsbCwKICAgICAgICAgICAgICAgIG5hbWFfa2VnaWF0YW46IGRhdGEubmFtYV9rZWdpYXRhbiB8fCAnJywKICAgICAgICAgICAgICAgIHRhbmdnYWxfbXVsYWk6IGRhdGEudGFuZ2dhbF9tdWxhaSB8fCAnJywKICAgICAgICAgICAgICAgIHRhbmdnYWxfc2VsZXNhaTogZGF0YS50YW5nZ2FsX3NlbGVzYWkgfHwgJycsCiAgICAgICAgICAgICAgICBqYW06IGRhdGEuamFtIHx8ICcnLAogICAgICAgICAgICAgICAgbG9rYXNpOiBkYXRhLmxva2FzaSB8fCAnJywKICAgICAgICAgICAgICAgIG1hcF9saW5rOiBkYXRhLm1hcF9saW5rIHx8ICcnLAogICAgICAgICAgICAgICAga2V0ZXJhbmdhbjogZGF0YS5rZXRlcmFuZ2FuIHx8ICcnLAogICAgICAgICAgICAgICAgZmlsZV9uYW1lOiBkYXRhLmZpbGVfbmFtZSB8fCBudWxsLAogICAgICAgICAgICAgICAganVtbGFoX3RlcmRhZnRhcjogZGF0YS5qdW1sYWhfdGVyZGFmdGFyID8/IG51bGwsCiAgICAgICAgICAgICAgICBzdGF0dXM6IGRhdGEuc3RhdHVzICE9IG51bGwgPyBOdW1iZXIoZGF0YS5zdGF0dXMpIDogMQogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMubWRsX2xpaGF0ID0gdHJ1ZQogICAgICAgIH0sCgogICAgICAgIG9wZW5JbWFnZShzcmMpIHsKICAgICAgICAgICAgdGhpcy5zZWxlY3RlZEltYWdlID0gc3JjCiAgICAgICAgICAgIHRoaXMubWRsX2ltYWdlID0gdHJ1ZQogICAgICAgIH0sCgogICAgICAgIHJlc2V0Rm9ybSgpIHsKICAgICAgICAgICAgdGhpcy5mb3JtID0gewogICAgICAgICAgICAgICAgaWQ6IG51bGwsCiAgICAgICAgICAgICAgICBuYW1hX2tlZ2lhdGFuOiAnJywKICAgICAgICAgICAgICAgIHRhbmdnYWxfbXVsYWk6ICcnLAogICAgICAgICAgICAgICAgdGFuZ2dhbF9zZWxlc2FpOiAnJywKICAgICAgICAgICAgICAgIGphbTogJycsCiAgICAgICAgICAgICAgICBsb2thc2k6ICcnLAogICAgICAgICAgICAgICAgbWFwX2xpbms6ICcnLAogICAgICAgICAgICAgICAga2V0ZXJhbmdhbjogJycsCiAgICAgICAgICAgICAgICBmaWxlX25hbWU6IG51bGwsCiAgICAgICAgICAgICAgICBqdW1sYWhfdGVyZGFmdGFyOiBudWxsLAogICAgICAgICAgICAgICAgc3RhdHVzOiAxCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5maWxlQmFydSA9IG51bGwKICAgICAgICB9LAoKICAgICAgICBhc3luYyBnZXRWaWV3KCkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzaG9XTG9hZGluZyIpOwoKICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKHRoaXMuJHN0b3JlLnN0YXRlLnVybC5KQURXQUxfRE9OT1IgKyAiZ2V0dmlldyIsIHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgICAgICAgICAgICAgICBkYXRhX2tlOiB0aGlzLnBhZ2VfZmlyc3QsCiAgICAgICAgICAgICAgICAgICAgICAgIGNhcmlfdmFsdWU6IHRoaXMuY2FyaV92YWx1ZSwKICAgICAgICAgICAgICAgICAgICAgICAgcGFnZV9saW1pdDogdGhpcy5wYWdlX2xpbWl0CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGNvbnN0IHJlc19kYXRhID0gYXdhaXQgcmVzLmpzb24oKTsKCiAgICAgICAgICAgICAgICB0aGlzLmxpc3RfZGF0YSA9IHJlc19kYXRhLmRhdGEgfHwgW107CiAgICAgICAgICAgICAgICB0aGlzLnRvdGFsID0gcmVzX2RhdGEudG90YWwgfHwgMDsKICAgICAgICAgICAgICAgIHRoaXMucGFnZV9sYXN0ID0gTWF0aC5jZWlsKHRoaXMudG90YWwgLyB0aGlzLnBhZ2VfbGltaXQpIHx8IDE7CgogICAgICAgICAgICAgICAgLy8gdXBkYXRlIGNvdW50cyB1bnR1ayBzZW11YSBqYWR3YWwgeWFuZyB0ZXItbG9hZCAocGFyYWxlbCkKICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMubGlzdF9kYXRhKSAmJiB0aGlzLmxpc3RfZGF0YS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBjb25zdCBwcm9taXNlcyA9IHRoaXMubGlzdF9kYXRhLm1hcChpdGVtID0+IHRoaXMuZmV0Y2hQYXJ0aWNpcGFudHNDb3VudChpdGVtLmlkKSk7CiAgICAgICAgICAgICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwocHJvbWlzZXMpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiaGlkZUxvYWRpbmciKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJyb3IgZ2V0VmlldyBKYWR3YWwgRG9ub3I6IiwgZXJyKTsKICAgICAgICAgICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgiaGlkZUxvYWRpbmciKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIGFkZERhdGEoKSB7CiAgICAgICAgICAgIHRoaXMuYnRuX2FkZCA9IHRydWU7CiAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CgogICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoIm5hbWFfa2VnaWF0YW4iLCB0aGlzLmZvcm0ubmFtYV9rZWdpYXRhbik7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgidGFuZ2dhbF9tdWxhaSIsIHRoaXMuZm9ybS50YW5nZ2FsX211bGFpKTsKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJ0YW5nZ2FsX3NlbGVzYWkiLCB0aGlzLmZvcm0udGFuZ2dhbF9zZWxlc2FpKTsKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJqYW0iLCB0aGlzLmZvcm0uamFtKTsKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJsb2thc2kiLCB0aGlzLmZvcm0ubG9rYXNpKTsKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJtYXBfbGluayIsIHRoaXMuZm9ybS5tYXBfbGluayB8fCAnJyk7CiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgia2V0ZXJhbmdhbiIsIHRoaXMuZm9ybS5rZXRlcmFuZ2FuIHx8ICcnKTsKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJqdW1sYWhfdGVyZGFmdGFyIiwgdGhpcy5mb3JtLmp1bWxhaF90ZXJkYWZ0YXIgIT0gbnVsbCA/IHRoaXMuZm9ybS5qdW1sYWhfdGVyZGFmdGFyIDogJycpOwogICAgICAgICAgICAvLyBzZXQgc3RhdHVzIGRlZmF1bHQgPSAxIChBa3RpZikKICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJzdGF0dXMiLCAxKTsKCiAgICAgICAgICAgIC8vIHEtZmlsZSB2LW1vZGVsIHN1ZGFoIGRpLWJpbmQga2UgZm9ybS5maWxlX25hbWUgcGFkYSB0ZW1wbGF0ZSBBbmRhCiAgICAgICAgICAgIC8vIGppa2EgdXNlciBtZW1pbGloIGZpbGUgZGkgYWRkIC0+IGZvcm0uZmlsZV9uYW1lIGFrYW4gbWVuamFkaSBGaWxlIG9iamVjdAogICAgICAgICAgICBpZiAodGhpcy5mb3JtLmZpbGVfbmFtZSkgewogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJmaWxlX25hbWUiLCB0aGlzLmZvcm0uZmlsZV9uYW1lKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLkpBRFdBTF9ET05PUiArICJhZGREYXRhIiwgewogICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogImtpa2Vuc2JhdGFyYSAiICsgbG9jYWxTdG9yYWdlLnRva2VuCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYm9keTogZm9ybURhdGEKICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKQogICAgICAgICAgICAgICAgLnRoZW4ocmVzX2RhdGEgPT4gewogICAgICAgICAgICAgICAgICAgIHRoaXMuYnRuX2FkZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIGlmIChyZXNfZGF0YS5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHEubm90aWZ5KHsgdHlwZTogInBvc2l0aXZlIiwgbWVzc2FnZTogcmVzX2RhdGEubWVzc2FnZSB8fCAiU3Vrc2VzIG1lbmFtYmFoIGphZHdhbCIgfSkKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRWaWV3KCk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWRsX2FkZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc2V0Rm9ybSgpOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHEubm90aWZ5KHsgdHlwZTogIm5lZ2F0aXZlIiwgbWVzc2FnZTogcmVzX2RhdGEubWVzc2FnZSB8fCAiR2FnYWwgbWVuYW1iYWggamFkd2FsIiB9KQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmJ0bl9hZGQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJyb3IgYWRkRGF0YSBKYWR3YWwgRG9ub3I6IiwgZXJyKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRxLm5vdGlmeSh7IHR5cGU6ICJuZWdhdGl2ZSIsIG1lc3NhZ2U6ICJUZXJqYWRpIGtlc2FsYWhhbiBzZXJ2ZXIiIH0pCiAgICAgICAgICAgICAgICB9KQogICAgICAgIH0sCgogICAgICAgIGFzeW5jIHVwZGF0ZURhdGEoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICB0aGlzLmJ0bl9lZGl0ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImlkIiwgdGhpcy5mb3JtLmlkKTsKICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgibmFtYV9rZWdpYXRhbiIsIHRoaXMuZm9ybS5uYW1hX2tlZ2lhdGFuKTsKICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgidGFuZ2dhbF9tdWxhaSIsIHRoaXMuZm9ybS50YW5nZ2FsX211bGFpKTsKICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgidGFuZ2dhbF9zZWxlc2FpIiwgdGhpcy5mb3JtLnRhbmdnYWxfc2VsZXNhaSk7CiAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImphbSIsIHRoaXMuZm9ybS5qYW0pOwogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJsb2thc2kiLCB0aGlzLmZvcm0ubG9rYXNpKTsKICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgibWFwX2xpbmsiLCB0aGlzLmZvcm0ubWFwX2xpbmsgfHwgJycpOwogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJrZXRlcmFuZ2FuIiwgdGhpcy5mb3JtLmtldGVyYW5nYW4gfHwgJycpOwogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJqdW1sYWhfdGVyZGFmdGFyIiwgdGhpcy5mb3JtLmp1bWxhaF90ZXJkYWZ0YXIgIT0gbnVsbCA/IHRoaXMuZm9ybS5qdW1sYWhfdGVyZGFmdGFyIDogJycpOwogICAgICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICJzdGF0dXMiLAogICAgICAgICAgICAgICAgICAgIHR5cGVvZiB0aGlzLmZvcm0uc3RhdHVzID09PSAib2JqZWN0IgogICAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuZm9ybS5zdGF0dXMudmFsdWUKICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLmZvcm0uc3RhdHVzCiAgICAgICAgICAgICAgICApOwoKCiAgICAgICAgICAgICAgICBpZiAodGhpcy5maWxlQmFydSkgewogICAgICAgICAgICAgICAgICAgIC8vIHVzZXIgdXBsb2FkIGZpbGUgYmFydSBwYWRhIGVkaXQKICAgICAgICAgICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImZpbGVfbmFtZSIsIHRoaXMuZmlsZUJhcnUpOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAvLyB0aWRhayB1cGxvYWQgYmFydSAtPiBraXJpbSBuYW1hIGZpbGUgbGFtYSBhZ2FyIGJhY2tlbmQgdGFodSB0ZXRhcCBtZW1ha2FpIGZpbGUgbGFtYQogICAgICAgICAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgiZmlsZV9uYW1lIiwgdGhpcy5mb3JtLmZpbGVfbmFtZSB8fCAnJyk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLkpBRFdBTF9ET05PUiArICJlZGl0RGF0YSIsIHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgYm9keTogZm9ybURhdGEKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlcy5qc29uKCk7CiAgICAgICAgICAgICAgICB0aGlzLmJ0bl9lZGl0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRxLm5vdGlmeSh7IHR5cGU6ICJwb3NpdGl2ZSIsIG1lc3NhZ2U6IHJlc3VsdC5tZXNzYWdlIHx8ICJTdWtzZXMgdXBkYXRlIGphZHdhbCIgfSkKICAgICAgICAgICAgICAgICAgICB0aGlzLm1kbF9lZGl0ID0gZmFsc2U7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5nZXRWaWV3KCk7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJHEubm90aWZ5KHsgdHlwZTogIm5lZ2F0aXZlIiwgbWVzc2FnZTogcmVzdWx0Lm1lc3NhZ2UgfHwgIkdhZ2FsIHVwZGF0ZSBqYWR3YWwiIH0pCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgICAgICAgdGhpcy5idG5fZWRpdCA9IGZhbHNlOwogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigi4p2MIEVycm9yIHVwZGF0ZURhdGEgSmFkd2FsIERvbm9yOiIsIGVycik7CiAgICAgICAgICAgICAgICB0aGlzLiRxLm5vdGlmeSh7IHR5cGU6ICJuZWdhdGl2ZSIsIG1lc3NhZ2U6ICJHYWdhbCB1cGRhdGUgZGF0YSIgfSkKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIHJlbW92ZURhdGEoKSB7CiAgICAgICAgICAgIGZldGNoKHRoaXMuJHN0b3JlLnN0YXRlLnVybC5KQURXQUxfRE9OT1IgKyAicmVtb3ZlRGF0YSIsIHsKICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogImtpa2Vuc2JhdGFyYSAiICsgbG9jYWxTdG9yYWdlLnRva2VuCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpZDogdGhpcy5mb3JtLmlkIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAgICAgICAgIC50aGVuKHJlc19kYXRhID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzX2RhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRxLm5vdGlmeSh7IHR5cGU6ICJwb3NpdGl2ZSIsIG1lc3NhZ2U6IHJlc19kYXRhLm1lc3NhZ2UgfHwgJ1N1a3NlcyBtZW5naGFwdXMgamFkd2FsJyB9KQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldFZpZXcoKQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJHEubm90aWZ5KHsgdHlwZTogIm5lZ2F0aXZlIiwgbWVzc2FnZTogcmVzX2RhdGEubWVzc2FnZSB8fCAnRGF0YSB0aWRhayBkaXRlbXVrYW4nIH0pCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgIC5jYXRjaChlcnIgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIuKdjCBFcnJvciByZW1vdmVEYXRhIEphZHdhbCBEb25vcjoiLCBlcnIpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJHEubm90aWZ5KHsgdHlwZTogIm5lZ2F0aXZlIiwgbWVzc2FnZTogJ1RlcmphZGkga2VzYWxhaGFuIHNlcnZlcicgfSkKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgfSwKCiAgICAgICAgY2FyaV9kYXRhKCkgewogICAgICAgICAgICB0aGlzLnBhZ2VfZmlyc3QgPSAxOwogICAgICAgICAgICB0aGlzLmdldFZpZXcoKTsKICAgICAgICB9LAoKICAgICAgICBpbmRleGluZyhpbmRleCkgewogICAgICAgICAgICByZXR1cm4gKCh0aGlzLnBhZ2VfZmlyc3QgLSAxKSAqIHRoaXMucGFnZV9saW1pdCkgKyBpbmRleDsKICAgICAgICB9LAoKICAgICAgICBhc3luYyBvcGVuUGVzZXJ0YShqYWR3YWwpIHsKICAgICAgICAgICAgdGhpcy5jdXJyZW50SmFkd2FsID0gamFkd2FsIHx8IHt9OwogICAgICAgICAgICB0aGlzLm1kbF9wZXNlcnRhID0gdHJ1ZTsKICAgICAgICAgICAgdGhpcy5wYXJ0aWNpcGFudHMgPSBbXTsKICAgICAgICAgICAgdGhpcy5wZW5kb25vckRhcmFoT3B0aW9ucyA9IFtdOwogICAgICAgICAgICB0aGlzLnNlbGVjdGVkUGVuZG9ub3IgPSBudWxsOwogICAgICAgICAgICB0aGlzLmJ0bl9hZGRfcGVzZXJ0YSA9IGZhbHNlOwogICAgICAgICAgICB0aGlzLnNlYXJjaElucHV0ID0gJyc7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJzaG9XTG9hZGluZyIpOwoKICAgICAgICAgICAgICAgIC8vIDEpIGFtYmlsIHBlc2VydGEgKHBlbmRvbm9yIHlhbmcgc3VkYWggZGl0YXV0a2FuIGtlIGphZHdhbCkgZGFyaSBiYWNrZW5kCiAgICAgICAgICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCh0aGlzLiRzdG9yZS5zdGF0ZS51cmwuSkFEV0FMX0RPTk9SICsgImdldFBhcnRpY2lwYW50cyIsIHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBqYWR3YWxfaWQ6IHRoaXMuY3VycmVudEphZHdhbC5pZCB9KQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTsKICAgICAgICAgICAgICAgIHRoaXMucGFydGljaXBhbnRzID0ganNvbi5kYXRhIHx8IFtdOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1BhcnRpY2lwYW50cyB1cGRhdGVkOicsIHRoaXMucGFydGljaXBhbnRzKTsKCiAgICAgICAgICAgICAgICB0aGlzLiRzZXQodGhpcy5wYXJ0aWNpcGFudHNDb3VudCwgdGhpcy5jdXJyZW50SmFkd2FsLmlkLCAodGhpcy5wYXJ0aWNpcGFudHMgfHwgW10pLmxlbmd0aCk7CgoKICAgICAgICAgICAgICAgIC8vIDIpIGFtYmlsIHNlbHVydWggcGVuZG9ub3IgZGFyaSB0YWJlbCBwZW5kb25vcl9kYXJhaCB1bnR1ayBvcHNpIHNlbGVjdAogICAgICAgICAgICAgICAgLy8gR0FOVEkgZW5kcG9pbnQgZGkgYmF3YWggamlrYSBuYW1hIGVuZHBvaW50IEFuZGEgYmVyYmVkYQogICAgICAgICAgICAgICAgLy8gY29udG9oIGFzdW1zaTogdGhpcy4kc3RvcmUuc3RhdGUudXJsLlBFTkRPTk9SX0RBUkFIICsgImxpc3QiCiAgICAgICAgICAgICAgICBjb25zdCBwZW5kUmVzID0gYXdhaXQgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLlJFR0lTX0RPTk9SICsgImxpc3QiLCB7CiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAiR0VUIiwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgY29uc3QgcGVuZEpzb24gPSBhd2FpdCBwZW5kUmVzLmpzb24oKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSYXcgYmFja2VuZCBkYXRhOicsIHBlbmRKc29uLmRhdGEpOwogICAgICAgICAgICAgICAgLy8gQ2VrIGR1cGxpa2FzaSBsYWJlbAogICAgICAgICAgICAgICAgY29uc3QgbGFiZWxzID0gcGVuZEpzb24uZGF0YS5tYXAoZCA9PiBkLmxhYmVsKTsKICAgICAgICAgICAgICAgIGNvbnN0IHVuaXF1ZUxhYmVscyA9IFsuLi5uZXcgU2V0KGxhYmVscyldOwogICAgICAgICAgICAgICAgaWYgKGxhYmVscy5sZW5ndGggIT09IHVuaXF1ZUxhYmVscy5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ0R1cGxpa2FzaSBsYWJlbCBkYXJpIGJhY2tlbmQ6JywgbGFiZWxzLmZpbHRlcigobCwgaSkgPT4gbGFiZWxzLmluZGV4T2YobCkgIT09IGkpKTsKICAgICAgICAgICAgICAgIH0KCgogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3BlbmRvbm9yIGxpc3QgcmVzcG9uc2U6JywgcGVuZEpzb24pOwogICAgICAgICAgICAgICAgLy8gcGVuZEpzb24uZGF0YSBkaWhhcmFwa2FuIGFycmF5IG9iamVrOiB7IGlkLCBuYW1hLCBqZW5pc19rZWxhbWluLCBnb2xvbmdhbl9kYXJhaCwgcmhlc3VzLCBub19ocCB9CiAgICAgICAgICAgICAgICAvLyBEaSBkYWxhbSBvcGVuUGVzZXJ0YSgpLCBnYW50aSBtYXBwaW5nIGluaToKICAgICAgICAgICAgICAgIC8vIHRoaXMucGVuZG9ub3JEYXJhaE9wdGlvbnMgPSAocGVuZEpzb24uZGF0YSB8fCBbXSkubWFwKHAgPT4gewogICAgICAgICAgICAgICAgLy8gICAgIGNvbnN0IG5hbWEgPSBwLm5hbWFfbGVuZ2thcCB8fCAnJzsgIC8vIDwtLSBJTkkgU0FMQUg6IHAubmFtYV9sZW5na2FwIHRpZGFrIGFkYQogICAgICAgICAgICAgICAgLy8gICAgIGNvbnN0IGdvbCA9IHAuZ29sb25nYW5fZGFyYWggfHwgJyc7CiAgICAgICAgICAgICAgICAvLyAgICAgY29uc3Qgcmhlc3VzID0gcC5yaGVzdXMgfHwgJyc7CiAgICAgICAgICAgICAgICAvLyAgICAgY29uc3Qgbm9faHAgPSBwLm5vX2hwIHx8ICcnOwogICAgICAgICAgICAgICAgLy8gICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGlkOiBTdHJpbmcocC5pZCksCiAgICAgICAgICAgICAgICAvLyAgICAgICAgIGxhYmVsOiBgJHtuYW1hIHx8ICctJ30g4oCUICR7Z29sIHx8ICctJ30ke3JoZXN1cyA/IHJoZXN1cyA6ICcnfSDigJQgJHtub19ocCB8fCAnLSd9YCwKICAgICAgICAgICAgICAgIC8vICAgICAgICAgcmF3OiBwCiAgICAgICAgICAgICAgICAvLyAgICAgfTsKICAgICAgICAgICAgICAgIC8vIH0pOwogICAgICAgICAgICAgICAgLy8gTUVOSkFESTogR3VuYWthbiBkYXRhIGxhbmdzdW5nIGRhcmkgYmFja2VuZCAoc3VkYWggYWRhIGxhYmVsIGRhbiByYXcpCiAgICAgICAgICAgICAgICAvLyB0aGlzLnBlbmRvbm9yRGFyYWhPcHRpb25zID0gcGVuZEpzb24uZGF0YSB8fCBbXTsKICAgICAgICAgICAgICAgIHRoaXMucGVuZG9ub3JEYXJhaE9wdGlvbnMgPSAocGVuZEpzb24uZGF0YSB8fCBbXSkubWFwKHAgPT4gewogICAgICAgICAgICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgICAgICAgICAgICAgIC4uLnAsCiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBTdHJpbmcocC5pZCksIC8vIHdhamliIHN0cmluZyBhZ2FyIGtvbnNpc3RlbgogICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogcC5sYWJlbCA/IFN0cmluZyhwLmxhYmVsKSA6IGAke3AubmFtYV9sZW5na2FwIHx8IHAubmFtYSB8fCAnLSd9IOKAlCAke3AuZ29sb25nYW5fZGFyYWggfHwgJy0nfSAke3Aucmhlc3VzID8gcC5yaGVzdXMgOiAnJ30g4oCUICR7cC5ub19ocCB8fCAnLSd9YC50cmltKCkKICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJoaWRlTG9hZGluZyIpOwogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIuKdjCBFcnJvciBvcGVuUGVzZXJ0YToiLCBlcnIpOwogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCJoaWRlTG9hZGluZyIpOwogICAgICAgICAgICAgICAgdGhpcy4kcS5ub3RpZnkoeyB0eXBlOiAibmVnYXRpdmUiLCBtZXNzYWdlOiAiR2FnYWwgbWVtdWF0IHBlc2VydGEgLyBkYWZ0YXIgcGVuZG9ub3IiIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfSwKCiAgICAgICAgb25TZWxlY3RQZW5kb25vcih2YWwpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbGVjdGVkUGVuZG9ub3IgKG9iamVrIHBlbnVoKTonLCB2YWwpOwogICAgICAgICAgICB0aGlzLnNlbGVjdGVkUGVuZG9ub3IgPSB2YWw7ICAvLyB2YWwgYWRhbGFoIG9iamVrIHBlbnVoCgogICAgICAgIH0sCgoKICAgICAgICByZXNldFBlc2VydGFGb3JtKCkgewogICAgICAgICAgICB0aGlzLnNlbGVjdGVkUGVuZG9ub3IgPSBudWxsOwogICAgICAgICAgICB0aGlzLnNlYXJjaElucHV0ID0gJyc7CiAgICAgICAgICAgIHRoaXMuYnRuX2FkZF9wZXNlcnRhID0gZmFsc2U7CiAgICAgICAgfSwKCiAgICAgICAgYXN5bmMgYWRkUGVzZXJ0YSgpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLmN1cnJlbnRKYWR3YWwuaWQpIHsKICAgICAgICAgICAgICAgIHRoaXMuJHEubm90aWZ5KHsgdHlwZTogIm5lZ2F0aXZlIiwgbWVzc2FnZTogIkRhdGEgamFkd2FsIHRpZGFrIGRpdGVtdWthbiIgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCF0aGlzLnNlbGVjdGVkUGVuZG9ub3IpIHsKICAgICAgICAgICAgICAgIHRoaXMuJHEubm90aWZ5KHsgdHlwZTogIm5lZ2F0aXZlIiwgbWVzc2FnZTogIlBpbGloIHBlbmRvbm9yIGRhcmkgZGFmdGFyIHRlcmxlYmloIGRhaHVsdSIgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHRoaXMuYnRuX2FkZF9wZXNlcnRhID0gdHJ1ZTsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGNvbnN0IGJvZHkgPSB7CiAgICAgICAgICAgICAgICAgICAgamFkd2FsX2lkOiB0aGlzLmN1cnJlbnRKYWR3YWwuaWQsCiAgICAgICAgICAgICAgICAgICAgcGVuZG9ub3JfaWQ6IHRoaXMuc2VsZWN0ZWRQZW5kb25vciA/IHRoaXMuc2VsZWN0ZWRQZW5kb25vci5pZCA6IG51bGwgIC8vIEFrc2VzIGlkIGRhcmkgb2JqZWsKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLkpBRFdBTF9ET05PUiArICJhZGRQYXJ0aWNpcGFudCIsIHsKICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICJQT1NUIiwKICAgICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgICAgIGF1dGhvcml6YXRpb246ICJraWtlbnNiYXRhcmEgIiArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGNvbnN0IGpzb24gPSBhd2FpdCByZXMuanNvbigpOwogICAgICAgICAgICAgICAgdGhpcy5idG5fYWRkX3Blc2VydGEgPSBmYWxzZTsKCiAgICAgICAgICAgICAgICBpZiAoanNvbi5zdWNjZXNzKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcS5ub3RpZnkoeyB0eXBlOiAicG9zaXRpdmUiLCBtZXNzYWdlOiBqc29uLm1lc3NhZ2UgfHwgIlBlc2VydGEgYmVyaGFzaWwgZGl0YW1iYWhrYW4iIH0pOwogICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub3BlblBlc2VydGEodGhpcy5jdXJyZW50SmFkd2FsKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkUGVuZG9ub3IgPSBudWxsOyAgLy8gUmVzZXQKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kcS5ub3RpZnkoeyB0eXBlOiAibmVnYXRpdmUiLCBtZXNzYWdlOiBqc29uLm1lc3NhZ2UgfHwgIkdhZ2FsIG1lbmFtYmFoa2FuIHBlc2VydGEiIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgIHRoaXMuYnRuX2FkZF9wZXNlcnRhID0gZmFsc2U7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJyb3IgYWRkUGVzZXJ0YToiLCBlcnIpOwogICAgICAgICAgICAgICAgdGhpcy4kcS5ub3RpZnkoeyB0eXBlOiAibmVnYXRpdmUiLCBtZXNzYWdlOiAiVGVyamFkaSBrZXNhbGFoYW4gc2VydmVyIiB9KTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgogICAgICAgIHJlbW92ZVBlc2VydGEocGVzZXJ0YUlkKSB7CiAgICAgICAgICAgIGlmICghcGVzZXJ0YUlkKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRxLm5vdGlmeSh7IHR5cGU6ICduZWdhdGl2ZScsIG1lc3NhZ2U6ICdJRCBwZXNlcnRhIHRpZGFrIGRpdGVtdWthbicgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGNvbnN0IG9rID0gd2luZG93LmNvbmZpcm0oJ0FwYWthaCBBbmRhIHlha2luIGluZ2luIG1lbmdoYXB1cyBwZXNlcnRhIGluaT8nKTsKICAgICAgICAgICAgaWYgKCFvaykgcmV0dXJuOwoKICAgICAgICAgICAgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLkpBRFdBTF9ET05PUiArICJyZW1vdmVQYXJ0aWNpcGFudCIsIHsKICAgICAgICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogImtpa2Vuc2JhdGFyYSAiICsgbG9jYWxTdG9yYWdlLnRva2VuCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBpZDogcGVzZXJ0YUlkIH0pCiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAgICAgICAgICAgICAgIC50aGVuKHJlc19kYXRhID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzX2RhdGEuc3VjY2VzcykgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRxLm5vdGlmeSh7IHR5cGU6ICJwb3NpdGl2ZSIsIG1lc3NhZ2U6IHJlc19kYXRhLm1lc3NhZ2UgfHwgJ1Blc2VydGEgYmVyaGFzaWwgZGloYXB1cycgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3BlblBlc2VydGEodGhpcy5jdXJyZW50SmFkd2FsKTsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRxLm5vdGlmeSh7IHR5cGU6ICJuZWdhdGl2ZSIsIG1lc3NhZ2U6IHJlc19kYXRhLm1lc3NhZ2UgfHwgJ1Blc2VydGEgdGlkYWsgZGl0ZW11a2FuJyB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcigi4p2MIEVycm9yIHJlbW92ZVBlc2VydGE6IiwgZXJyKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRxLm5vdGlmeSh7IHR5cGU6ICJuZWdhdGl2ZSIsIG1lc3NhZ2U6ICdUZXJqYWRpIGtlc2FsYWhhbiBzZXJ2ZXInIH0pOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgfSwKICAgICAgICBvbkZpbHRlcih2YWwsIHVwZGF0ZUZuKSB7CiAgICAgICAgICAgIHRoaXMuc2VhcmNoSW5wdXQgPSB2YWw7ICAvLyBUcmFjayBpbnB1dAogICAgICAgICAgICB1cGRhdGVGbigpOyAgLy8gVXBkYXRlIG9wc2kKICAgICAgICB9LAogICAgICAgIGFzeW5jIGZldGNoUGFydGljaXBhbnRzQ291bnQoamFkd2FsSWQpIHsKICAgICAgICAgICAgaWYgKCFqYWR3YWxJZCkgcmV0dXJuOwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2godGhpcy4kc3RvcmUuc3RhdGUudXJsLkpBRFdBTF9ET05PUiArICJnZXRQYXJ0aWNpcGFudHMiLCB7CiAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAiUE9TVCIsCiAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICAgICAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgICAgICAgICAgICAgICAgICBhdXRob3JpemF0aW9uOiAia2lrZW5zYmF0YXJhICIgKyBsb2NhbFN0b3JhZ2UudG9rZW4KICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgamFkd2FsX2lkOiBqYWR3YWxJZCB9KQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBjb25zdCBqc29uID0gYXdhaXQgcmVzLmpzb24oKTsKICAgICAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gQXJyYXkuaXNBcnJheShqc29uLmRhdGEpID8ganNvbi5kYXRhLmxlbmd0aCA6IDA7CiAgICAgICAgICAgICAgICAvLyBzaW1wYW4ga2UgbWFwCiAgICAgICAgICAgICAgICB0aGlzLiRzZXQodGhpcy5wYXJ0aWNpcGFudHNDb3VudCwgamFkd2FsSWQsIGNvdW50KTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCLinYwgRXJyb3IgZmV0Y2hQYXJ0aWNpcGFudHNDb3VudDoiLCBlcnIpOwogICAgICAgICAgICAgICAgdGhpcy4kc2V0KHRoaXMucGFydGljaXBhbnRzQ291bnQsIGphZHdhbElkLCAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0sCgoKICAgIH0sCgogICAgbW91bnRlZCgpIHsKICAgICAgICB0aGlzLmdldFZpZXcoKTsKICAgIH0KfQo="},{"version":3,"sources":["jadwal_donor.vue"],"names":[],"mappings":";AAyaA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA","file":"jadwal_donor.vue","sourceRoot":"src/views/informasi","sourcesContent":["<template>\n    <div class=\"about \" style=\"padding:15px\">\n        <q-card bordered class=\"my-card\">\n            <q-card-section class=\"main2 text-white\">\n                <div class=\"row items-center q-col-gutter-md\">\n                    <div class=\"col-12 col-md-6\">\n                        <div class=\"text-h6 h_titleHead\">Jadwal Donor</div>\n                    </div>\n\n                    <!-- Cari + Tombol Add -->\n                    <div class=\"col-12 col-md-6\">\n                        <div class=\"row\">\n                            <q-input v-model=\"cari_value\" @keyup=\"cari_data()\" outlined square dense\n                                class=\"bg-white col q-mr-sm\" placeholder=\"Cari lokasi / keterangan...\" />\n                            <q-btn glossy class=\"col-auto\" color=\"green\" @click=\"mdl_add = true\" dense icon=\"add\">\n                                <q-tooltip content-class=\"bg-green-7\" content-style=\"font-size: 13px\">\n                                    Tambah Jadwal Donor\n                                </q-tooltip>\n                            </q-btn>\n                        </div>\n                    </div>\n                </div>\n\n            </q-card-section>\n\n        </q-card>\n\n        <hr class=\"hrpagin2\">\n\n        <div class=\"tbl_responsive\">\n            <table width=\"100%\">\n                <tr class=\"h_table_head main1 text-white \">\n                    <th width=\"5%\" class=\"text-center\">No</th>\n                    <th width=\"25%\">Nama Kegiatan</th>\n                    <th width=\"15%\">Tanggal</th>\n                    <th width=\"20%\">Lokasi</th>\n                    <th width=\"10%\">Jam</th>\n                    <th width=\"10%\">Poster</th>\n                    <th width=\"15%\" class=\"text-center\">Act</th>\n                </tr>\n\n                <tr class=\"h_table_body\" v-for=\"(data, index) in list_data\" :key=\"data.id\">\n                    <td class=\"text-center\">{{ indexing(index + 1) }}.</td>\n\n                    <td>\n                        <div class=\"text-bold\">{{ data.nama_kegiatan }}</div>\n                        <div class=\"q-mt-sm\">\n                            <q-btn dense small color=\"positive\" @click=\"openPeserta(data)\" class=\"row items-center\">\n                                <q-icon name=\"people\" class=\"q-mr-xs\" />\n                                <span style=\"font-size:13px\">\n                                    {{ participantsCount[data.id] != null ? participantsCount[data.id] + ' peserta' :\n                                'Peserta' }}\n                                </span>\n                            </q-btn>\n\n                        </div>\n                    </td>\n                    <td>\n                        <div class=\"text-bold\">{{ UMUM.tglConvert(data.tanggal_mulai) }} - {{\n                                UMUM.tglConvert(data.tanggal_selesai) }}</div>\n                        <div style=\"font-size:12px;\">\n                            <span>\n                                <q-badge :color=\"statusColor(data.status)\">\n                                    {{ statusLabel(data.status) }}\n                                </q-badge>\n                            </span>\n\n                        </div>\n                    </td>\n\n                    <td>\n                        <div class=\"text-bold\">{{ data.lokasi }}</div>\n                        <div style=\"font-size:12px;\">\n                            <span class=\"text-blue\">{{ data.map_link ? 'Map tersedia' : 'Map: -' }}</span>\n\n                        </div>\n                    </td>\n\n                    <td class=\"text-center\">{{ data.jam || '-' }}</td>\n\n                    <td class=\"text-center\">\n                        <img v-if=\"data.file_name\" :src=\"file_path + data.file_name\" alt=\"poster\"\n                            style=\"max-width: 80px; border-radius: 6px; cursor: pointer;\"\n                            @click=\"openImage(file_path + data.file_name)\" />\n                        <q-icon v-else name=\"image_not_supported\" size=\"sm\" color=\"grey\" />\n                    </td>\n\n                    <td class=\"text-center q-gutter-sm\">\n                        <q-btn dense round color=\"warning\" icon=\"edit\" @click=\"openEdit(data)\">\n                            <q-tooltip content-class=\"bg-amber-7\">Edit</q-tooltip>\n                        </q-btn>\n                        <q-btn dense round color=\"negative\" icon=\"delete\" @click=\"openDelete(data)\">\n                            <q-tooltip content-class=\"bg-red-7\">Hapus</q-tooltip>\n                        </q-btn>\n                        <q-btn dense round color=\"primary\" icon=\"visibility\" @click=\"openLihat(data)\">\n                            <q-tooltip content-class=\"bg-blue-7\">Lihat</q-tooltip>\n                        </q-btn>\n                    </td>\n                </tr>\n\n            </table>\n        </div>\n\n        <hr class=\"hrpagin\">\n        <br>\n        <div class=\"flex flex-center\">\n            <q-pagination v-model=\"page_first\" :max=\"page_last\" :max-pages=\"4\" color=\"grey-6\" :direction-links=\"true\"\n                :boundary-links=\"true\" icon-first=\"skip_previous\" icon-last=\"skip_next\" icon-prev=\"fast_rewind\"\n                icon-next=\"fast_forward\" @input=\"getView\" />\n        </div>\n\n        <!-- MODAL ADD -->\n        <q-dialog v-model=\"mdl_add\" persistent>\n            <q-card class=\"mdl-md\">\n                <q-card-section class=\"main2 text-white\">\n                    <div class=\"text-h6 h_modalhead\">Tambah Jadwal Donor</div>\n                </q-card-section>\n\n                <form @submit.prevent=\"addData()\">\n                    <q-card-section class=\"q-pt-none\">\n                        <hr class=\"hrpagin2\">\n\n                        <span class=\"h_lable\">Nama Kegiatan</span>\n                        <q-input v-model=\"form.nama_kegiatan\" outlined square dense class=\"bg-white margin_btn\" />\n\n                        <div class=\"row q-col-gutter-md\">\n                            <div class=\"col-12 col-md-6\">\n                                <span class=\"h_lable\">Tanggal Mulai</span>\n                                <q-input v-model=\"form.tanggal_mulai\" type=\"date\" outlined square dense\n                                    class=\"bg-white margin_btn\" />\n                            </div>\n\n                            <div class=\"col-12 col-md-6\">\n                                <span class=\"h_lable\">Tanggal Selesai</span>\n                                <q-input v-model=\"form.tanggal_selesai\" type=\"date\" outlined square dense\n                                    class=\"bg-white margin_btn\" />\n                            </div>\n                        </div>\n\n\n                        <span class=\"h_lable\">Jam Mulai - Selesai</span>\n                        <q-input v-model=\"form.jam\" placeholder=\"08:00 - 24:00\" outlined square dense\n                            class=\"bg-white margin_btn\" />\n\n                        <div class=\"row q-col-gutter-md\">\n                            <div class=\"col-12 col-md-6\">\n                                <span class=\"h_lable\">Lokasi</span>\n                                <q-input v-model=\"form.lokasi\" outlined square dense class=\"bg-white margin_btn\" />\n                            </div>\n\n                            <div class=\"col-12 col-md-6\">\n                                <span class=\"h_lable\">Map Link (opsional)</span>\n                                <q-input v-model=\"form.map_link\" outlined square dense class=\"bg-white margin_btn\" />\n                            </div>\n                        </div>\n\n\n                        <span class=\"h_lable\">Keterangan (opsional)</span>\n                        <q-input v-model=\"form.keterangan\" type=\"textarea\" outlined square dense\n                            class=\"bg-white margin_btn\" />\n\n                        <span class=\"h_lable\">Jumlah Terdaftar (opsional)</span>\n                        <q-input v-model=\"form.jumlah_terdaftar\" type=\"number\" outlined square dense\n                            class=\"bg-white margin_btn\" />\n\n                        <span class=\"h_lable\">Poster (opsional)</span>\n                        <q-file v-model=\"form.file_name\" label=\"Pilih Poster\" outlined square dense\n                            class=\"bg-white margin_btn\" />\n\n                        <hr class=\"hrpagin2\">\n                    </q-card-section>\n\n                    <q-card-actions class=\"bg-grey-4 mdl-footer\" align=\"right\">\n                        <q-btn :loading=\"btn_add\" color=\"primary\" type=\"submit\" label=\"Simpan\" />\n                        <q-btn label=\"Batal\" color=\"negative\" v-close-popup />\n                    </q-card-actions>\n                </form>\n            </q-card>\n        </q-dialog>\n\n        <!-- MODAL EDIT -->\n        <q-dialog v-model=\"mdl_edit\" persistent>\n            <q-card class=\"mdl-md\">\n                <q-card-section class=\"main2 text-white\">\n                    <div class=\"text-h6 h_modalhead\">Edit Jadwal Donor</div>\n                </q-card-section>\n\n                <form @submit.prevent=\"updateData()\">\n                    <q-card-section class=\"q-pt-none\">\n                        <hr class=\"hrpagin2\">\n\n                        <span class=\"h_lable\">Status</span>\n                        <q-select v-model=\"form.status\" :options=\"statusOptions\" option-label=\"label\"\n                            option-value=\"value\" outlined dense class=\"bg-white margin_btn\" />\n\n                        <span class=\"h_lable\">Nama Kegiatan</span>\n                        <q-input v-model=\"form.nama_kegiatan\" outlined square dense class=\"bg-white margin_btn\" />\n\n                        <div class=\"row q-col-gutter-md\">\n                            <div class=\"col-12 col-md-6\">\n                                <span class=\"h_lable\">Tanggal Mulai</span>\n                                <q-input v-model=\"form.tanggal_mulai\" type=\"date\" outlined square dense\n                                    class=\"bg-white margin_btn\" />\n                            </div>\n\n                            <div class=\"col-12 col-md-6\">\n                                <span class=\"h_lable\">Tanggal Selesai</span>\n                                <q-input v-model=\"form.tanggal_selesai\" type=\"date\" outlined square dense\n                                    class=\"bg-white margin_btn\" />\n                            </div>\n                        </div>\n\n                        <span class=\"h_lable\">Jam Mulai - Selesai</span>\n                        <q-input v-model=\"form.jam\" placeholder=\"08:00 - 24:00\" outlined square dense\n                            class=\"bg-white margin_btn\" />\n\n                        <div class=\"row q-col-gutter-md\">\n                            <div class=\"col-12 col-md-6\">\n                                <span class=\"h_lable\">Lokasi</span>\n                                <q-input v-model=\"form.lokasi\" outlined square dense class=\"bg-white margin_btn\" />\n                            </div>\n\n                            <div class=\"col-12 col-md-6\">\n                                <span class=\"h_lable\">Map Link (opsional)</span>\n                                <q-input v-model=\"form.map_link\" outlined square dense class=\"bg-white margin_btn\" />\n                            </div>\n                        </div>\n\n                        <span class=\"h_lable\">Keterangan (opsional)</span>\n                        <q-input v-model=\"form.keterangan\" type=\"textarea\" outlined square dense\n                            class=\"bg-white margin_btn\" />\n\n                        <span class=\"h_lable\">Jumlah Terdaftar (opsional)</span>\n                        <q-input v-model=\"form.jumlah_terdaftar\" type=\"number\" outlined square dense\n                            class=\"bg-white margin_btn\" />\n\n\n\n                        <span class=\"h_lable\">Poster Baru (opsional)</span>\n                        <q-file v-model=\"fileBaru\" label=\"Pilih Poster Baru\" outlined square dense\n                            class=\"bg-white margin_btn\" />\n\n                        <!-- preview menggunakan file_name -->\n                        <div v-if=\"form.file_name && !fileBaru\" class=\"q-mt-sm\">\n                            <q-img :src=\"file_path + form.file_name\" style=\"max-width: 150px; border-radius: 6px;\" />\n                            <div class=\"text-caption text-grey\">Poster lama</div>\n                        </div>\n\n                        <hr class=\"hrpagin2\">\n                    </q-card-section>\n\n                    <q-card-actions class=\"bg-grey-4 mdl-footer\" align=\"right\">\n                        <q-btn :loading=\"btn_edit\" color=\"primary\" type=\"submit\" label=\"Update\" />\n                        <q-btn label=\"Batal\" color=\"negative\" v-close-popup />\n                    </q-card-actions>\n                </form>\n            </q-card>\n        </q-dialog>\n\n        <q-dialog v-model=\"mdl_lihat\" persistent>\n            <q-card class=\"mdl-lg q-pa-none\" style=\"max-width: 900px; border-radius: 16px; overflow: hidden;\">\n                <q-card-section class=\"main2 text-white\">\n                    <div class=\"text-h6 h_modalhead\">Detail Jadwal Donor</div>\n                </q-card-section>\n\n                <q-card-section class=\"q-pa-lg scroll\" style=\"max-height: 70vh; overflow-y: auto;\">\n                    <div class=\"text-h5 q-mb-md\">{{ form.lokasi }}</div>\n\n                    <div class=\"text-grey-7 q-mb-md\" style=\"font-size: 14px;\">\n                        <q-icon name=\"event\" size=\"16px\" class=\"q-mr-xs\" />\n                        <span class=\"q-mr-md\">Tanggal: <span class=\"text-blue\">{{ UMUM.tglConvert(form.tanggal_mulai)\n                                }}</span></span>\n                        <q-icon name=\"schedule\" size=\"16px\" class=\"q-mr-xs\" />\n                        <span>{{ form.jam }}</span>\n                        <div style=\"margin-top:6px;\">\n                            <q-badge :color=\"statusColor(form.status)\" class=\"q-mt-sm\">{{ statusLabel(form.status)\n                                }}</q-badge>\n                        </div>\n                    </div>\n\n                    <div class=\"q-mb-md\">\n                        <div class=\"text-subtitle2 text-bold\">Keterangan</div>\n                        <div class=\"text-body2 text-grey-8\">{{ form.keterangan || '-' }}</div>\n                    </div>\n\n                    <div v-if=\"form.map_link\" class=\"q-mb-md\">\n                        <div class=\"text-subtitle2 text-bold\">Map Link</div>\n                        <div class=\"text-body2 q-mt-sm\"><a :href=\"form.map_link\" target=\"_blank\">{{ form.map_link }}</a>\n                        </div>\n                    </div>\n\n                    <div v-if=\"form.file_name\" class=\"q-mb-md\">\n                        <div class=\"text-subtitle2 text-bold\">Poster</div>\n                        <q-img :src=\"file_path + form.file_name\" style=\"max-width: 100%; border-radius: 6px;\" />\n                    </div>\n\n\n                    <div class=\"q-mb-md\">\n                        <div class=\"text-subtitle2 text-bold\">Jumlah Terdaftar</div>\n                        <div class=\"text-body2 text-grey-8\">{{ form.jumlah_terdaftar != null ? form.jumlah_terdaftar :\n                                '-' }}</div>\n                    </div>\n                </q-card-section>\n\n                <q-separator />\n                <q-card-actions class=\"bg-grey-4 mdl-footer\" align=\"right\">\n                    <q-btn label=\"Tutup\" color=\"negative\" v-close-popup />\n                </q-card-actions>\n            </q-card>\n        </q-dialog>\n\n        <!-- MODAL HAPUS -->\n        <q-dialog v-model=\"mdl_delete\" persistent>\n            <q-card class=\"mdl-sm \">\n                <q-card-section class=\"q-pt-none text-center orageGrad\">\n                    <form @submit.prevent=\"removeData\">\n                        <br>\n                        <img src=\"img/alert.png\" alt=\"\" width=\"75\"> <br>\n                        <span class=\"h_notifikasi\">APAKAH ANDA YAKIN INGIN MENGHAPUS DATA INI??</span>\n                        <input type=\"submit\" style=\"position: absolute; left: -9999px\" />\n                        <br><br>\n                        <q-btn label=\"Batal\" size=\"sm\" color=\"negative\" v-close-popup />\n                        &nbsp;\n                        <q-btn type=\"submit\" label=\"Hapus\" size=\"sm\" color=\"primary\" v-close-popup />\n                    </form>\n                </q-card-section>\n            </q-card>\n        </q-dialog>\n\n        <!-- MODAL IMG -->\n        <q-dialog v-model=\"mdl_image\">\n            <q-card class=\"bg-purple mdl-lg\">\n                <q-card-section class=\"text-center\">\n                    <q-img :src=\"selectedImage\" style=\"max-width: 90vw; max-height: 90vh; border-radius: 10px;\"\n                        fit=\"contain\" />\n                </q-card-section>\n                <q-card-actions align=\"center\">\n                    <q-btn flat label=\"Tutup\" color=\"white\" v-close-popup />\n                </q-card-actions>\n            </q-card>\n        </q-dialog>\n\n\n\n\n        <!-- MODAL PESERTA -->\n        <q-dialog v-model=\"mdl_peserta\">\n            <q-card class=\"mdl-md\">\n                <q-card-section class=\"main2 text-white\">\n                    <div class=\"text-h6 h_modalhead\">Daftar Peserta - {{ currentJadwal.nama_kegiatan || '-' }}</div>\n                </q-card-section>\n\n                <q-card-section class=\"q-pa-lg scroll\" style=\"max-height: 70vh; overflow-y: auto;\">\n                    <!-- Tabel peserta -->\n                    <div class=\"tbl_responsive q-mb-md\">\n                        <table width=\"100%\">\n                            <tr class=\"h_table_head main1 text-white \">\n                                <th class=\"text-center\" width=\"5%\">No</th>\n                                <th>Nama</th>\n                                <th>Jk</th>\n                                <th>Golongan</th>\n                                <th>Rhesus</th>\n                                <th>HP</th>\n                                <th class=\"text-center\">Aksi</th>\n                            </tr>\n\n                            <tr v-for=\"(p, i) in participants\" :key=\"p.id\" class=\"h_table_body\">\n                                <td class=\"text-center\">{{ i + 1 }}</td>\n                                <td>{{ p.nama_lengkap }}</td>\n                                <td>{{ p.jenis_kelamin }}</td>\n                                <td>{{ p.golongan_darah }}</td>\n                                <td class=\"text-center\">{{ p.rhesus }}</td>\n                                <td>{{ p.no_hp }}</td>\n                                <td class=\"text-center\">\n                                    <q-btn dense round color=\"negative\" icon=\"delete\" @click=\"removePeserta(p.id)\">\n                                        <q-tooltip>Hapus</q-tooltip>\n                                    </q-btn>\n                                </td>\n                            </tr>\n\n                            <tr v-if=\"participants.length === 0\">\n                                <td colspan=\"7\" class=\"text-center text-grey\">Belum ada peserta</td>\n                            </tr>\n                        </table>\n                    </div>\n\n                    <q-separator />\n\n                    <!-- Form tambah peserta: hanya pilih dari pendonor_darah -->\n                    <div class=\"q-mt-md\">\n                        <div class=\"text-subtitle2 text-bold\">Tambah Peserta (Pilih dari daftar pendonor)</div>\n\n                        <div class=\"row q-col-gutter-md q-mt-sm\">\n                            <div class=\"col-12 col-md-6\">\n                                <!-- <q-select v-model=\"selectedPendonor\" :options=\"availableOptions\" option-value=\"id\"\n                                    option-label=\"label\" outlined dense class=\"bg-white margin_btn\" use-input fill-input\n                                    input-debounce=\"300\" placeholder=\"Ketik nama pendonor...\" @filter=\"onFilter\"\n                                    @input=\"onSelectPendonor\"\n                                    no-options-label=\"Tidak ada pendonor yang cocok atau belum terdaftar\" /> -->\n                                <q-select v-model=\"selectedPendonor\" :options=\"availableOptions\" option-label=\"label\"\n                                    outlined dense class=\"bg-white margin_btn\" use-input input-debounce=\"300\"\n                                    placeholder=\"Ketik nama pendonor...\" @filter=\"onFilter\" @input=\"onSelectPendonor\"\n                                    no-options-label=\"Tidak ada pendonor yang cocok atau belum terdaftar\" />\n\n                            </div>\n\n                            <div class=\"col-12 col-md-6\">\n                                <q-btn :loading=\"btn_add_peserta\" color=\"positive\" label=\"Tambah Peserta\"\n                                    @click=\"addPeserta()\" />\n                                <q-btn flat label=\"Reset\" @click=\"resetPesertaForm()\" />\n                            </div>\n                        </div>\n                    </div>\n                </q-card-section>\n\n                <q-separator />\n                <q-card-actions class=\"bg-grey-4 mdl-footer\" align=\"right\">\n                    <q-btn label=\"Tutup\" color=\"negative\" v-close-popup @click=\"mdl_peserta = false\" />\n                </q-card-actions>\n            </q-card>\n        </q-dialog>\n    </div>\n</template>\n\n<script>\nimport UMUM from \"../../library/umum.js\";\n\nexport default {\n    data() {\n        return {\n            list_data: [],\n            form: {\n                nama_kegiatan: '',\n                tanggal_mulai: '',\n                tanggal_selesai: '',\n                jam: '',\n                lokasi: '',\n                map_link: '',\n                keterangan: '',\n                file_name: null,\n                jumlah_terdaftar: null,\n                status: 1 // default aktif\n            },\n            fileBaru: null,\n            UMUM: UMUM,\n            btn_add: false,\n            btn_edit: false,\n            mdl_add: false,\n            mdl_edit: false,\n            mdl_delete: false,\n            mdl_lihat: false,\n            mdl_image: false,\n            mdl_peserta: false,\n            selectedImage: null,\n            cari_value: \"\",\n            page_first: 1,\n            page_last: 1,\n            page_limit: 9,\n            total: 0,\n            tipe: null,\n            file_path: this.$store.state.url.URL_APP + \"uploads/\",\n            statusOptions: [\n                { label: '1 - Aktif', value: 1 },\n                { label: '2 - Selesai', value: 2 },\n                { label: '3 - Dibatalkan', value: 3 }\n            ],\n            currentJadwal: {},\n            participants: [],\n            participantsCount: {},\n            pendonorDarahOptions: [],\n            selectedPendonor: null,\n            btn_add_peserta: false,\n            searchInput: '',\n        }\n    },\n\n\n    computed: {\n        availableOptions() {\n            // buat set id peserta (string) untuk perbandingan\n            const partIds = new Set(\n                (this.participants || [])\n                    .map(p => String(p.pendonor_id ?? p.id ?? p.user_id ?? p.id_pendonor ?? ''))\n                    .filter(Boolean)\n            );\n\n            // normalisasi pendonorDarahOptions -> pastikan id sebagai string dan ada label\n            const normalized = (this.pendonorDarahOptions || []).map(opt => {\n                return {\n                    ...opt,\n                    id: String(opt.id),\n                    label: (opt.label || `${opt.nama_lengkap || opt.nama || '-'} / ${opt.golongan_darah || ''} ${opt.rhesus ? opt.rhesus : ''} / ${opt.no_hp || '-'}`).trim()\n                };\n            });\n\n            // hilangkan yang sudah terdaftar\n            let available = normalized.filter(o => !partIds.has(String(o.id)));\n\n            // hapus duplikat berdasarkan id (keamanan)\n            available = available.filter((item, idx, arr) => arr.findIndex(x => x.id === item.id) === idx);\n\n            // support searchInput seperti sebelumnya\n            const input = String(this.searchInput || '').toLowerCase().trim();\n            if (!input) {\n                return available.slice(0, 8);\n            }\n            return available.filter(opt => (opt.label || '').toLowerCase().includes(input));\n        }\n    },\n\n    methods: {\n\n        statusLabel(val) {\n            if (val == 1) return 'Aktif'\n            if (val == 2) return 'Selesai'\n            if (val == 3) return 'Dibatalkan'\n            return '-'\n        },\n\n        statusColor(val) {\n            if (val == 1) return 'positive'\n            if (val == 2) return 'warning'\n            if (val == 3) return 'negative'\n            return 'grey'\n        },\n\n        openEdit(data) {\n            this.form = {\n                id: data.id || null,\n                nama_kegiatan: data.nama_kegiatan || '',\n                tanggal_mulai: data.tanggal_mulai || '',\n                tanggal_selesai: data.tanggal_selesai || '',\n                jam: data.jam || '',\n                lokasi: data.lokasi || '',\n                map_link: data.map_link || '',\n                keterangan: data.keterangan || '',\n                file_name: data.file_name || null,\n                jumlah_terdaftar: data.jumlah_terdaftar ?? null,\n                status: data.status != null ? data.status : 1\n            }\n            this.fileBaru = null\n            this.mdl_edit = true\n        },\n\n\n        openDelete(data) {\n            this.form = { id: data.id }\n            this.mdl_delete = true\n        },\n\n        openLihat(data) {\n            this.form = {\n                id: data.id || null,\n                nama_kegiatan: data.nama_kegiatan || '',\n                tanggal_mulai: data.tanggal_mulai || '',\n                tanggal_selesai: data.tanggal_selesai || '',\n                jam: data.jam || '',\n                lokasi: data.lokasi || '',\n                map_link: data.map_link || '',\n                keterangan: data.keterangan || '',\n                file_name: data.file_name || null,\n                jumlah_terdaftar: data.jumlah_terdaftar ?? null,\n                status: data.status != null ? Number(data.status) : 1\n            }\n            this.mdl_lihat = true\n        },\n\n        openImage(src) {\n            this.selectedImage = src\n            this.mdl_image = true\n        },\n\n        resetForm() {\n            this.form = {\n                id: null,\n                nama_kegiatan: '',\n                tanggal_mulai: '',\n                tanggal_selesai: '',\n                jam: '',\n                lokasi: '',\n                map_link: '',\n                keterangan: '',\n                file_name: null,\n                jumlah_terdaftar: null,\n                status: 1\n            }\n            this.fileBaru = null\n        },\n\n        async getView() {\n            try {\n                this.$store.commit(\"shoWLoading\");\n\n                const res = await fetch(this.$store.state.url.JADWAL_DONOR + \"getview\", {\n                    method: \"POST\",\n                    headers: {\n                        \"content-type\": \"application/json\",\n                        authorization: \"kikensbatara \" + localStorage.token\n                    },\n                    body: JSON.stringify({\n                        data_ke: this.page_first,\n                        cari_value: this.cari_value,\n                        page_limit: this.page_limit\n                    })\n                });\n\n                const res_data = await res.json();\n\n                this.list_data = res_data.data || [];\n                this.total = res_data.total || 0;\n                this.page_last = Math.ceil(this.total / this.page_limit) || 1;\n\n                // update counts untuk semua jadwal yang ter-load (paralel)\n                if (Array.isArray(this.list_data) && this.list_data.length) {\n                    const promises = this.list_data.map(item => this.fetchParticipantsCount(item.id));\n                    await Promise.all(promises);\n                }\n\n                this.$store.commit(\"hideLoading\");\n            } catch (err) {\n                console.error(\" Error getView Jadwal Donor:\", err);\n                this.$store.commit(\"hideLoading\");\n            }\n        },\n\n        addData() {\n            this.btn_add = true;\n            const formData = new FormData();\n\n            formData.append(\"nama_kegiatan\", this.form.nama_kegiatan);\n            formData.append(\"tanggal_mulai\", this.form.tanggal_mulai);\n            formData.append(\"tanggal_selesai\", this.form.tanggal_selesai);\n            formData.append(\"jam\", this.form.jam);\n            formData.append(\"lokasi\", this.form.lokasi);\n            formData.append(\"map_link\", this.form.map_link || '');\n            formData.append(\"keterangan\", this.form.keterangan || '');\n            formData.append(\"jumlah_terdaftar\", this.form.jumlah_terdaftar != null ? this.form.jumlah_terdaftar : '');\n            // set status default = 1 (Aktif)\n            formData.append(\"status\", 1);\n\n            // q-file v-model sudah di-bind ke form.file_name pada template Anda\n            // jika user memilih file di add -> form.file_name akan menjadi File object\n            if (this.form.file_name) {\n                formData.append(\"file_name\", this.form.file_name);\n            }\n\n            fetch(this.$store.state.url.JADWAL_DONOR + \"addData\", {\n                method: \"POST\",\n                headers: {\n                    authorization: \"kikensbatara \" + localStorage.token\n                },\n                body: formData\n            })\n                .then(res => res.json())\n                .then(res_data => {\n                    this.btn_add = false;\n                    if (res_data.success) {\n                        this.$q.notify({ type: \"positive\", message: res_data.message || \"Sukses menambah jadwal\" })\n                        this.getView();\n                        this.mdl_add = false;\n                        this.resetForm();\n                    } else {\n                        this.$q.notify({ type: \"negative\", message: res_data.message || \"Gagal menambah jadwal\" })\n                    }\n                })\n                .catch(err => {\n                    this.btn_add = false;\n                    console.error(\" Error addData Jadwal Donor:\", err);\n                    this.$q.notify({ type: \"negative\", message: \"Terjadi kesalahan server\" })\n                })\n        },\n\n        async updateData() {\n            try {\n                this.btn_edit = true;\n                const formData = new FormData();\n                formData.append(\"id\", this.form.id);\n                formData.append(\"nama_kegiatan\", this.form.nama_kegiatan);\n                formData.append(\"tanggal_mulai\", this.form.tanggal_mulai);\n                formData.append(\"tanggal_selesai\", this.form.tanggal_selesai);\n                formData.append(\"jam\", this.form.jam);\n                formData.append(\"lokasi\", this.form.lokasi);\n                formData.append(\"map_link\", this.form.map_link || '');\n                formData.append(\"keterangan\", this.form.keterangan || '');\n                formData.append(\"jumlah_terdaftar\", this.form.jumlah_terdaftar != null ? this.form.jumlah_terdaftar : '');\n                formData.append(\n                    \"status\",\n                    typeof this.form.status === \"object\"\n                        ? this.form.status.value\n                        : this.form.status\n                );\n\n\n                if (this.fileBaru) {\n                    // user upload file baru pada edit\n                    formData.append(\"file_name\", this.fileBaru);\n                } else {\n                    // tidak upload baru -> kirim nama file lama agar backend tahu tetap memakai file lama\n                    formData.append(\"file_name\", this.form.file_name || '');\n                }\n\n                const res = await fetch(this.$store.state.url.JADWAL_DONOR + \"editData\", {\n                    method: \"POST\",\n                    headers: {\n                        authorization: \"kikensbatara \" + localStorage.token\n                    },\n                    body: formData\n                });\n\n                const result = await res.json();\n                this.btn_edit = false;\n                if (result.success) {\n                    this.$q.notify({ type: \"positive\", message: result.message || \"Sukses update jadwal\" })\n                    this.mdl_edit = false;\n                    this.getView();\n                } else {\n                    this.$q.notify({ type: \"negative\", message: result.message || \"Gagal update jadwal\" })\n                }\n            } catch (err) {\n                this.btn_edit = false;\n                console.error(\" Error updateData Jadwal Donor:\", err);\n                this.$q.notify({ type: \"negative\", message: \"Gagal update data\" })\n            }\n        },\n\n        removeData() {\n            fetch(this.$store.state.url.JADWAL_DONOR + \"removeData\", {\n                method: \"POST\",\n                headers: {\n                    \"content-type\": \"application/json\",\n                    authorization: \"kikensbatara \" + localStorage.token\n                },\n                body: JSON.stringify({ id: this.form.id })\n            })\n                .then(res => res.json())\n                .then(res_data => {\n                    if (res_data.success) {\n                        this.$q.notify({ type: \"positive\", message: res_data.message || 'Sukses menghapus jadwal' })\n                        this.getView()\n                    } else {\n                        this.$q.notify({ type: \"negative\", message: res_data.message || 'Data tidak ditemukan' })\n                    }\n                })\n                .catch(err => {\n                    console.error(\" Error removeData Jadwal Donor:\", err);\n                    this.$q.notify({ type: \"negative\", message: 'Terjadi kesalahan server' })\n                })\n        },\n\n        cari_data() {\n            this.page_first = 1;\n            this.getView();\n        },\n\n        indexing(index) {\n            return ((this.page_first - 1) * this.page_limit) + index;\n        },\n\n        async openPeserta(jadwal) {\n            this.currentJadwal = jadwal || {};\n            this.mdl_peserta = true;\n            this.participants = [];\n            this.pendonorDarahOptions = [];\n            this.selectedPendonor = null;\n            this.btn_add_peserta = false;\n            this.searchInput = '';\n\n            try {\n                this.$store.commit(\"shoWLoading\");\n\n                // 1) ambil peserta (pendonor yang sudah ditautkan ke jadwal) dari backend\n                const res = await fetch(this.$store.state.url.JADWAL_DONOR + \"getParticipants\", {\n                    method: \"POST\",\n                    headers: {\n                        \"content-type\": \"application/json\",\n                        authorization: \"kikensbatara \" + localStorage.token\n                    },\n                    body: JSON.stringify({ jadwal_id: this.currentJadwal.id })\n                });\n                const json = await res.json();\n                this.participants = json.data || [];\n                console.log('Participants updated:', this.participants);\n\n                this.$set(this.participantsCount, this.currentJadwal.id, (this.participants || []).length);\n\n\n                // 2) ambil seluruh pendonor dari tabel pendonor_darah untuk opsi select\n                // GANTI endpoint di bawah jika nama endpoint Anda berbeda\n                // contoh asumsi: this.$store.state.url.PENDONOR_DARAH + \"list\"\n                const pendRes = await fetch(this.$store.state.url.REGIS_DONOR + \"list\", {\n                    method: \"GET\",\n                    headers: {\n                        authorization: \"kikensbatara \" + localStorage.token\n                    }\n                });\n                const pendJson = await pendRes.json();\n                console.log('Raw backend data:', pendJson.data);\n                // Cek duplikasi label\n                const labels = pendJson.data.map(d => d.label);\n                const uniqueLabels = [...new Set(labels)];\n                if (labels.length !== uniqueLabels.length) {\n                    console.warn('Duplikasi label dari backend:', labels.filter((l, i) => labels.indexOf(l) !== i));\n                }\n\n\n                console.log('pendonor list response:', pendJson);\n                // pendJson.data diharapkan array objek: { id, nama, jenis_kelamin, golongan_darah, rhesus, no_hp }\n                // Di dalam openPeserta(), ganti mapping ini:\n                // this.pendonorDarahOptions = (pendJson.data || []).map(p => {\n                //     const nama = p.nama_lengkap || '';  // <-- INI SALAH: p.nama_lengkap tidak ada\n                //     const gol = p.golongan_darah || '';\n                //     const rhesus = p.rhesus || '';\n                //     const no_hp = p.no_hp || '';\n                //     return {\n                //         id: String(p.id),\n                //         label: `${nama || '-'}  ${gol || '-'}${rhesus ? rhesus : ''}  ${no_hp || '-'}`,\n                //         raw: p\n                //     };\n                // });\n                // MENJADI: Gunakan data langsung dari backend (sudah ada label dan raw)\n                // this.pendonorDarahOptions = pendJson.data || [];\n                this.pendonorDarahOptions = (pendJson.data || []).map(p => {\n                    return {\n                        ...p,\n                        id: String(p.id), // wajib string agar konsisten\n                        label: p.label ? String(p.label) : `${p.nama_lengkap || p.nama || '-'}  ${p.golongan_darah || '-'} ${p.rhesus ? p.rhesus : ''}  ${p.no_hp || '-'}`.trim()\n                    };\n                });\n\n                this.$store.commit(\"hideLoading\");\n            } catch (err) {\n                console.error(\" Error openPeserta:\", err);\n                this.$store.commit(\"hideLoading\");\n                this.$q.notify({ type: \"negative\", message: \"Gagal memuat peserta / daftar pendonor\" });\n            }\n        },\n\n        onSelectPendonor(val) {\n            console.log('selectedPendonor (objek penuh):', val);\n            this.selectedPendonor = val;  // val adalah objek penuh\n\n        },\n\n\n        resetPesertaForm() {\n            this.selectedPendonor = null;\n            this.searchInput = '';\n            this.btn_add_peserta = false;\n        },\n\n        async addPeserta() {\n            if (!this.currentJadwal.id) {\n                this.$q.notify({ type: \"negative\", message: \"Data jadwal tidak ditemukan\" });\n                return;\n            }\n            if (!this.selectedPendonor) {\n                this.$q.notify({ type: \"negative\", message: \"Pilih pendonor dari daftar terlebih dahulu\" });\n                return;\n            }\n\n            this.btn_add_peserta = true;\n            try {\n                const body = {\n                    jadwal_id: this.currentJadwal.id,\n                    pendonor_id: this.selectedPendonor ? this.selectedPendonor.id : null  // Akses id dari objek\n                };\n\n                const res = await fetch(this.$store.state.url.JADWAL_DONOR + \"addParticipant\", {\n                    method: \"POST\",\n                    headers: {\n                        \"content-type\": \"application/json\",\n                        authorization: \"kikensbatara \" + localStorage.token\n                    },\n                    body: JSON.stringify(body)\n                });\n\n                const json = await res.json();\n                this.btn_add_peserta = false;\n\n                if (json.success) {\n                    this.$q.notify({ type: \"positive\", message: json.message || \"Peserta berhasil ditambahkan\" });\n                    await this.openPeserta(this.currentJadwal);\n                    this.selectedPendonor = null;  // Reset\n                } else {\n                    this.$q.notify({ type: \"negative\", message: json.message || \"Gagal menambahkan peserta\" });\n                }\n            } catch (err) {\n                this.btn_add_peserta = false;\n                console.error(\" Error addPeserta:\", err);\n                this.$q.notify({ type: \"negative\", message: \"Terjadi kesalahan server\" });\n            }\n        },\n\n        removePeserta(pesertaId) {\n            if (!pesertaId) {\n                this.$q.notify({ type: 'negative', message: 'ID peserta tidak ditemukan' });\n                return;\n            }\n\n            const ok = window.confirm('Apakah Anda yakin ingin menghapus peserta ini?');\n            if (!ok) return;\n\n            fetch(this.$store.state.url.JADWAL_DONOR + \"removeParticipant\", {\n                method: \"POST\",\n                headers: {\n                    \"content-type\": \"application/json\",\n                    authorization: \"kikensbatara \" + localStorage.token\n                },\n                body: JSON.stringify({ id: pesertaId })\n            })\n                .then(res => res.json())\n                .then(res_data => {\n                    if (res_data.success) {\n                        this.$q.notify({ type: \"positive\", message: res_data.message || 'Peserta berhasil dihapus' });\n                        this.openPeserta(this.currentJadwal);\n                    } else {\n                        this.$q.notify({ type: \"negative\", message: res_data.message || 'Peserta tidak ditemukan' });\n                    }\n                })\n                .catch(err => {\n                    console.error(\" Error removePeserta:\", err);\n                    this.$q.notify({ type: \"negative\", message: 'Terjadi kesalahan server' });\n                });\n        },\n        onFilter(val, updateFn) {\n            this.searchInput = val;  // Track input\n            updateFn();  // Update opsi\n        },\n        async fetchParticipantsCount(jadwalId) {\n            if (!jadwalId) return;\n            try {\n                const res = await fetch(this.$store.state.url.JADWAL_DONOR + \"getParticipants\", {\n                    method: \"POST\",\n                    headers: {\n                        \"content-type\": \"application/json\",\n                        authorization: \"kikensbatara \" + localStorage.token\n                    },\n                    body: JSON.stringify({ jadwal_id: jadwalId })\n                });\n                const json = await res.json();\n                const count = Array.isArray(json.data) ? json.data.length : 0;\n                // simpan ke map\n                this.$set(this.participantsCount, jadwalId, count);\n            } catch (err) {\n                console.error(\" Error fetchParticipantsCount:\", err);\n                this.$set(this.participantsCount, jadwalId, 0);\n            }\n        },\n\n\n    },\n\n    mounted() {\n        this.getView();\n    }\n}\n</script>"]}]}